<?php
class __admin extends baseModuleAdmin {public function config() {$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$v21ffce5b8a6cc8cc6a41448dd69623c9 = Array('paging' => array(       'int:blogs_per_page'    => null,       'int:posts_per_page'    => null,       'int:comments_per_page' => null),      'user'  => array(       'string:autocreate_path'   => null,       'int:blogs_per_user'       => null,       'boolean:allow_guest_comments' => null),      'notifications' => array(       'boolean:on_comment_add' => null      ));if(getRequest('param0') == 'do') {try {$v21ffce5b8a6cc8cc6a41448dd69623c9 = $this->expectParams($v21ffce5b8a6cc8cc6a41448dd69623c9);$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/blogs20/paging/blogs',        $v21ffce5b8a6cc8cc6a41448dd69623c9['paging']['int:blogs_per_page']);$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/blogs20/paging/posts',        $v21ffce5b8a6cc8cc6a41448dd69623c9['paging']['int:posts_per_page']);$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/blogs20/paging/comments',     $v21ffce5b8a6cc8cc6a41448dd69623c9['paging']['int:comments_per_page']);$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/blogs20/autocreate_path',      $v21ffce5b8a6cc8cc6a41448dd69623c9['user']['string:autocreate_path']);$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/blogs20/blogs_per_user',      $v21ffce5b8a6cc8cc6a41448dd69623c9['user']['int:blogs_per_user']);$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/blogs20/allow_guest_comments', $v21ffce5b8a6cc8cc6a41448dd69623c9['user']['boolean:allow_guest_comments'] ? 1 : 0);$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/blogs20/notifications/on_comment_add', $v21ffce5b8a6cc8cc6a41448dd69623c9['notifications']['boolean:on_comment_add'] ? 1 : 0);}catch(Exception $ve1671797c52e15f763380b45e841ec32) {}$this->chooseRedirect();}$v21ffce5b8a6cc8cc6a41448dd69623c9['paging']['int:blogs_per_page']     = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/blogs20/paging/blogs");$v21ffce5b8a6cc8cc6a41448dd69623c9['paging']['int:posts_per_page']     = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/blogs20/paging/posts");$v21ffce5b8a6cc8cc6a41448dd69623c9['paging']['int:comments_per_page']  = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/blogs20/paging/comments");$v21ffce5b8a6cc8cc6a41448dd69623c9['user']['string:autocreate_path']   = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/blogs20/autocreate_path");$v21ffce5b8a6cc8cc6a41448dd69623c9['user']['int:blogs_per_user']      = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/blogs20/blogs_per_user");$v21ffce5b8a6cc8cc6a41448dd69623c9['user']['boolean:allow_guest_comments'] = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/blogs20/allow_guest_comments") ? true : false;$v21ffce5b8a6cc8cc6a41448dd69623c9['notifications']['boolean:on_comment_add'] = $vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/blogs20/notifications/on_comment_add") ? true : false;if(!$vb1444fb0c07653567ad325aa25d4e37a->getVal("//modules/blogs20/import/old")) {$v21ffce5b8a6cc8cc6a41448dd69623c9['import'] = array();}$this->setDataType('settings');$this->setActionType('modify');$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v21ffce5b8a6cc8cc6a41448dd69623c9, 'settings');$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function del() {$v6a7f245843454cf4f28ad7c5e2572aa2 = getRequest('element');if(!is_array($v6a7f245843454cf4f28ad7c5e2572aa2)) {$v6a7f245843454cf4f28ad7c5e2572aa2 = Array($v6a7f245843454cf4f28ad7c5e2572aa2);}foreach($v6a7f245843454cf4f28ad7c5e2572aa2 as $v7552cd149af7495ee7d8225974e50f80) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->expectElement($v7552cd149af7495ee7d8225974e50f80, false, true);$v21ffce5b8a6cc8cc6a41448dd69623c9 = Array(    "element" => $v8e2dcfd7e7e24b1ca76c1193f645902b,    "allowed-element-types" => Array('post', 'blog', 'comment')   );$this->deleteElement($v21ffce5b8a6cc8cc6a41448dd69623c9);}$this->setDataType("list");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v6a7f245843454cf4f28ad7c5e2572aa2, "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function edit() {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->expectElement("param0");$v15d61712450a686a7f365adf4fef581f = (String) getRequest('param1');$this->setHeaderLabel('header-blogs20-edit-'.$this->getObjectTypeMethod($v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()));$ve62e4d22f2d8630f6e44e2b7c3f70ddc = Array( "element" => $v8e2dcfd7e7e24b1ca76c1193f645902b,       "allowed-element-types" => Array('post', 'blog', 'comment'));if($v15d61712450a686a7f365adf4fef581f == "do") {$this->saveEditedElementData($ve62e4d22f2d8630f6e44e2b7c3f70ddc);if($v8e2dcfd7e7e24b1ca76c1193f645902b->getTypeId() == umiHierarchyTypesCollection::getInstance()->getTypeByName('blogs20', 'blog')->getId() ) {permissionsCollection::getInstance()->setElementPermissions($v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getOwnerId(), $v8e2dcfd7e7e24b1ca76c1193f645902b->getId(), 2);}$this->chooseRedirect();}$this->setDataType("form");$this->setActionType("modify");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($ve62e4d22f2d8630f6e44e2b7c3f70ddc, "page");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function add() {$vd0e45878043844ffc41aac437e86b602 = $this->expectElement("param0");$v15d61712450a686a7f365adf4fef581f   = (string) getRequest("param2");$v599dcce2998a6b40b1e38e8c6006cb0a   = (string) getRequest("param1");$this->setHeaderLabel('header-blogs20-add-'.$v599dcce2998a6b40b1e38e8c6006cb0a);$ve62e4d22f2d8630f6e44e2b7c3f70ddc = Array( "type"   => $v599dcce2998a6b40b1e38e8c6006cb0a,       "parent" => $vd0e45878043844ffc41aac437e86b602,       "allowed-element-types" => Array('post', 'blog'));if($v15d61712450a686a7f365adf4fef581f == "do") {$v7057e8409c7c531a1a6e9ac3df4ed549 = $this->saveAddedElementData($ve62e4d22f2d8630f6e44e2b7c3f70ddc);$this->chooseRedirect();}$this->setDataType("form");$this->setActionType("create");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($ve62e4d22f2d8630f6e44e2b7c3f70ddc, "page");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function blogs() {return $this->listItems('blog');}public function lists() {return $this->redirect($this->pre_lang . '/admin/blogs20/blogs/');}public function posts() {return $this->listItems('post');}public function comments() {return $this->listItems('comment');}public function activity() {$v6a7f245843454cf4f28ad7c5e2572aa2 = getRequest('element');if(!is_array($v6a7f245843454cf4f28ad7c5e2572aa2)) {$v6a7f245843454cf4f28ad7c5e2572aa2 = array($v6a7f245843454cf4f28ad7c5e2572aa2);}$v4264c638e0098acb172519b0436db099 = getRequest('active');foreach($v6a7f245843454cf4f28ad7c5e2572aa2 as $v7552cd149af7495ee7d8225974e50f80) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->expectElement($v7552cd149af7495ee7d8225974e50f80, false, true);$v21ffce5b8a6cc8cc6a41448dd69623c9 = Array(    "element" => $v8e2dcfd7e7e24b1ca76c1193f645902b,    "allowed-element-types" => Array('post', 'blog', 'comment'),    "activity" => $v4264c638e0098acb172519b0436db099   );$this->switchActivity($v21ffce5b8a6cc8cc6a41448dd69623c9);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();}$this->setDataType("list");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v6a7f245843454cf4f28ad7c5e2572aa2, "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function listItems($v6149843274f2e068b5b7de0061ffa338) {$this->setDataType("list");$this->setActionType("view");if($this->ifNotXmlMode()) {$v8d777f385d3dfec8815d20f7496026dc['nodes:blogs'] = array( array('nodes:blog' => $this->getAllBlogs() ) );$this->setData($v8d777f385d3dfec8815d20f7496026dc, 0);return $this->doData();}$vaa9f73eea60a006820d0f8768bc8a3fc = 20;$ve1ba980ce14a8c0d7e2779f895ab8695 = getRequest('p');$v7a86c157ee9713c34fbd7a1ee40f0c5a = $vaa9f73eea60a006820d0f8768bc8a3fc * $ve1ba980ce14a8c0d7e2779f895ab8695;$v8be74552df93e31bbdd6b36ed74bdb6a = new selector('pages');$v8be74552df93e31bbdd6b36ed74bdb6a->limit($v7a86c157ee9713c34fbd7a1ee40f0c5a, $vaa9f73eea60a006820d0f8768bc8a3fc);switch($v6149843274f2e068b5b7de0061ffa338) {case 'comment':    $v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('blogs20', 'comment');break;case 'post':    if(!is_null(getRequest('rel'))) {$v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('blogs20', 'comment');}$v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('blogs20', 'post');break;default:    $v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('blogs20', 'blog');$v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('blogs20', 'comment');$v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('blogs20', 'post');}selectorHelper::detectFilters($v8be74552df93e31bbdd6b36ed74bdb6a);$this->setDataRange($vaa9f73eea60a006820d0f8768bc8a3fc, $v7a86c157ee9713c34fbd7a1ee40f0c5a);$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v8be74552df93e31bbdd6b36ed74bdb6a->result, "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc, $v8be74552df93e31bbdd6b36ed74bdb6a->length);return $this->doData();}public function getAllBlogs() {$v8be74552df93e31bbdd6b36ed74bdb6a = new selector('pages');$v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('blogs20', 'blog');$result = array();foreach($v8be74552df93e31bbdd6b36ed74bdb6a as $v126ac9f6149081eb0e97c2e939eaad52) {$result[] = array(    'attribute:id' => $v126ac9f6149081eb0e97c2e939eaad52->id,    'node:name' => $v126ac9f6149081eb0e97c2e939eaad52->name   );}return $result;}public function getDatasetConfiguration($veca07335a33c5aeb5e1bc7c98b4b9d80 = '') {switch($veca07335a33c5aeb5e1bc7c98b4b9d80) {case 'comments':     $v89ab96b2cae2569ced36d70f6866f57d = 'comments';break;case 'posts':      $v89ab96b2cae2569ced36d70f6866f57d = 'posts';break;default:      $v89ab96b2cae2569ced36d70f6866f57d = 'blogs';}return array(    'methods' => array(     array('title'=>getLabel('smc-load'), 'forload'=>true, 'module'=>'blogs20', '#__name'=>$v89ab96b2cae2569ced36d70f6866f57d),     array('title'=>getLabel('smc-delete'),       'module'=>'blogs20', '#__name'=>'del', 'aliases' => 'tree_delete_element,delete,del'),     array('title'=>getLabel('smc-activity'),         'module'=>'blogs20', '#__name'=>'activity', 'aliases' => 'tree_set_activity,activity'),     array('title'=>getLabel('smc-copy'), 'module'=>'content', '#__name'=>'tree_copy_element'),     array('title'=>getLabel('smc-move'),       'module'=>'content', '#__name'=>'tree_move_element'),     array('title'=>getLabel('smc-change-template'),        'module'=>'content', '#__name'=>'change_template'),     array('title'=>getLabel('smc-change-lang'),       'module'=>'content', '#__name'=>'move_to_lang')),    'types' => array(     array('common' => 'true', 'id' => umiObjectTypesCollection::getInstance()->getBaseType('blogs20', 'post'))    ),    'stoplist' => array('title', 'h1', 'meta_keywords', 'meta_descriptions', 'menu_pic_ua', 'menu_pic_a', 'header_pic', 'more_params', 'robots_deny', 'is_unindexed', 'store_amounts', 'locktime', 'lockuser', 'content', 'rate_voters', 'rate_sum'),    'default' => 'publish_time[156px]'   );}};?>

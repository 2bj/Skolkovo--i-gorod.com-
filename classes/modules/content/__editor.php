<?php
 abstract class __editor_content {public function editValue() {$this->flushAsXml('editValue');$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();$v15d61712450a686a7f365adf4fef581f = getRequest('param0');$v7552cd149af7495ee7d8225974e50f80 = getRequest('element-id');$v16b2b26000987faccb260b9d39df1269 = getRequest('object-id');$v8e2dcfd7e7e24b1ca76c1193f645902b = null;$va8cfde6331bd59eb2ac96f8911c4b666 = null;if($v7552cd149af7495ee7d8225974e50f80) {$permissions = permissionsCollection::getInstance();list($v4b43b0aee35624cd95b910189b3dc231, $vf1290186a5d0b1ceab27f4e77c0c5d68) = $permissions->isAllowedObject($permissions->getUserId(), $v7552cd149af7495ee7d8225974e50f80);if(!$vf1290186a5d0b1ceab27f4e77c0c5d68)     throw new publicException(getLabel('eip-no-permissions'));$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {$va8cfde6331bd59eb2ac96f8911c4b666 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject();}else throw new publicException(getLabel('eip-no-element') . ": #{$v7552cd149af7495ee7d8225974e50f80}");}else if($v16b2b26000987faccb260b9d39df1269) {$vb3b32a2d422265cd25c3323ed0157f81  = $vb81ca7c0ccaa77e7aa91936ab0070695->getObjectInstances($v16b2b26000987faccb260b9d39df1269);if(!empty($vb3b32a2d422265cd25c3323ed0157f81)) {$permissions = permissionsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $permissions->getUserId();$vb394126a0e52e75f1e3d535d0fb0d33c  = false;foreach($vb3b32a2d422265cd25c3323ed0157f81 as $v7552cd149af7495ee7d8225974e50f80) {list($v4b43b0aee35624cd95b910189b3dc231, $vf1290186a5d0b1ceab27f4e77c0c5d68) = $permissions->isAllowedObject($v8e44f0089b076e18a718eb9ca3d94674, $v7552cd149af7495ee7d8225974e50f80);if($vf1290186a5d0b1ceab27f4e77c0c5d68) {$vb394126a0e52e75f1e3d535d0fb0d33c = true;break;}}if(!$vb394126a0e52e75f1e3d535d0fb0d33c) throw new publicException(getLabel('eip-no-permissions'));}$va8cfde6331bd59eb2ac96f8911c4b666 = $v5891da2d64975cae48d175d1e001f5da->getObject($v16b2b26000987faccb260b9d39df1269);if($va8cfde6331bd59eb2ac96f8911c4b666 instanceof iUmiObject == false) {throw new publicException(getLabel('eip-no-object') . ": #{$v7552cd149af7495ee7d8225974e50f80}");}}else throw new publicException(getLabel('eip-nothing-found'));$v972bf3f05d14ffbdb817bef60638ff00 = getRequest('field-name');if($v865c0c0b4ab0e063e5caa3387c1a8741 = strpos($v972bf3f05d14ffbdb817bef60638ff00, '[')) {if(preg_match_all("/\[([^\[^\]]+)\]/", substr($v972bf3f05d14ffbdb817bef60638ff00, $v865c0c0b4ab0e063e5caa3387c1a8741), $vc68271a63ddbc431c307beb7d2918275)) {$vadddc69f57bd593b8593dc04b73ea9d6 = array(      'filter' => array(),      'field-type' => null     );foreach($vc68271a63ddbc431c307beb7d2918275[1] as $veca07335a33c5aeb5e1bc7c98b4b9d80) {if(strpos($veca07335a33c5aeb5e1bc7c98b4b9d80, ':')) {list($v403a6c6072076794d0802f1e68e932b5, $vcb52369cfb11b8900322399f756fcc0d) = split('\:', $veca07335a33c5aeb5e1bc7c98b4b9d80);$vadddc69f57bd593b8593dc04b73ea9d6['filter'][$v403a6c6072076794d0802f1e68e932b5] = $vcb52369cfb11b8900322399f756fcc0d;}else {$vadddc69f57bd593b8593dc04b73ea9d6['field-type'] = $veca07335a33c5aeb5e1bc7c98b4b9d80;}}}$v972bf3f05d14ffbdb817bef60638ff00 = substr($v972bf3f05d14ffbdb817bef60638ff00, 0, $v865c0c0b4ab0e063e5caa3387c1a8741);}else $vadddc69f57bd593b8593dc04b73ea9d6 = null;if($v972bf3f05d14ffbdb817bef60638ff00 != 'name') {$v1a8db4c996d8ed8289da5f957879ab94 = $va8cfde6331bd59eb2ac96f8911c4b666->getPropByName($v972bf3f05d14ffbdb817bef60638ff00);if($v1a8db4c996d8ed8289da5f957879ab94 instanceof iUmiObjectProperty == false) {throw new publicException(getLabel('eip-no-field') . ": \"{$v972bf3f05d14ffbdb817bef60638ff00}\"");}$v06e3d36fa30cea095545139854ad1fb9 = $v1a8db4c996d8ed8289da5f957879ab94->getField();}if($v972bf3f05d14ffbdb817bef60638ff00 == 'name') {$v833750ac635fcc57dc33ecafe365f9a7 = 'string';}else {$v833750ac635fcc57dc33ecafe365f9a7 = $v06e3d36fa30cea095545139854ad1fb9->getDataType();}$v42aefbae01d2dfd981f7da7d823d689e = $v8e2dcfd7e7e24b1ca76c1193f645902b ? $v8e2dcfd7e7e24b1ca76c1193f645902b : $va8cfde6331bd59eb2ac96f8911c4b666;$v2063c1608d6e0baf80249c42e2be5804 = getRequest('value');$v2063c1608d6e0baf80249c42e2be5804 = __editor_content::filterStringValue($v2063c1608d6e0baf80249c42e2be5804);$v3b8ea8567b667adb398dcc8d96da3690 = null;$v55a31ca9a157d6799bbc5dc865b7fda6 = null;if($v15d61712450a686a7f365adf4fef581f == 'save') {umiObjectProperty::$IGNORE_FILTER_INPUT_STRING = true;if($v972bf3f05d14ffbdb817bef60638ff00 == 'h1' || $v972bf3f05d14ffbdb817bef60638ff00 == 'name') {$v2063c1608d6e0baf80249c42e2be5804 = str_replace("&nbsp;", " ", $v2063c1608d6e0baf80249c42e2be5804);$v42aefbae01d2dfd981f7da7d823d689e->setName($v2063c1608d6e0baf80249c42e2be5804);$v42aefbae01d2dfd981f7da7d823d689e->setValue('h1', $v2063c1608d6e0baf80249c42e2be5804);if($v42aefbae01d2dfd981f7da7d823d689e instanceof iUmiHierarchyElement) {$v3b8ea8567b667adb398dcc8d96da3690 = $vb81ca7c0ccaa77e7aa91936ab0070695->getPathById($v42aefbae01d2dfd981f7da7d823d689e->id);$v0330da281541887f65b0a60066351c91 = $v42aefbae01d2dfd981f7da7d823d689e->getAltName();if(!$v0330da281541887f65b0a60066351c91 || substr($v0330da281541887f65b0a60066351c91, 0, 1) == '_') {$v42aefbae01d2dfd981f7da7d823d689e->setAltName($v2063c1608d6e0baf80249c42e2be5804);$v42aefbae01d2dfd981f7da7d823d689e->commit();}$v55a31ca9a157d6799bbc5dc865b7fda6 = $vb81ca7c0ccaa77e7aa91936ab0070695->getPathById($v42aefbae01d2dfd981f7da7d823d689e->id, false, false, true);}}else {if($v833750ac635fcc57dc33ecafe365f9a7 == 'date') {$v5fc732311905cb27e82d67f4f6511f7f = new umiDate();$v5fc732311905cb27e82d67f4f6511f7f->setDateByString($v2063c1608d6e0baf80249c42e2be5804);$v2063c1608d6e0baf80249c42e2be5804 = $v5fc732311905cb27e82d67f4f6511f7f;unset($v5fc732311905cb27e82d67f4f6511f7f);$v2063c1608d6e0baf80249c42e2be5804 = $v2063c1608d6e0baf80249c42e2be5804->getFormattedDate('U');}if($v833750ac635fcc57dc33ecafe365f9a7 == 'optioned') {$v403a6c6072076794d0802f1e68e932b5 = getArrayKey($vadddc69f57bd593b8593dc04b73ea9d6, 'field-type');$vb2c97ae425dd751b0e48a3acae79cf4a = getArrayKey($vadddc69f57bd593b8593dc04b73ea9d6, 'filter');$v0382b9fd9ef50b6a335f35e0aaaebf99 = $v42aefbae01d2dfd981f7da7d823d689e->getValue($v972bf3f05d14ffbdb817bef60638ff00);foreach($v0382b9fd9ef50b6a335f35e0aaaebf99 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {foreach($vb2c97ae425dd751b0e48a3acae79cf4a as $ve358efa489f58062f10dd7316b65649e => $v03c7c0ace395d80182db07ae2c30f034) {if(getArrayKey($v9e3669d19b675bd57058fd4664205d2a, $ve358efa489f58062f10dd7316b65649e) != $v03c7c0ace395d80182db07ae2c30f034) continue 2;$v0382b9fd9ef50b6a335f35e0aaaebf99[$v865c0c0b4ab0e063e5caa3387c1a8741][$v403a6c6072076794d0802f1e68e932b5] = $v2063c1608d6e0baf80249c42e2be5804;}}$v2063c1608d6e0baf80249c42e2be5804 = $v0382b9fd9ef50b6a335f35e0aaaebf99;unset($v0382b9fd9ef50b6a335f35e0aaaebf99);}if($v833750ac635fcc57dc33ecafe365f9a7 == 'wysiwyg') {if(preg_match_all("/href=[\"']?([^ ^\"^']+)[\"']?/i", $v2063c1608d6e0baf80249c42e2be5804, $vc68271a63ddbc431c307beb7d2918275)) {foreach($vc68271a63ddbc431c307beb7d2918275[1] as $v2a304a1348456ccd2234cd71a81bd338) {$vb80bb7740288fda1f201890375a60c8f = $vb81ca7c0ccaa77e7aa91936ab0070695->getIdByPath($v2a304a1348456ccd2234cd71a81bd338);if($vb80bb7740288fda1f201890375a60c8f) {$v2063c1608d6e0baf80249c42e2be5804 = str_replace($v2a304a1348456ccd2234cd71a81bd338, "%content get_page_url({$vb80bb7740288fda1f201890375a60c8f})%", $v2063c1608d6e0baf80249c42e2be5804);}}}}else {$v2063c1608d6e0baf80249c42e2be5804 = str_replace("&nbsp;", " ", $v2063c1608d6e0baf80249c42e2be5804);}if(in_array($v833750ac635fcc57dc33ecafe365f9a7, array('text', 'string', 'int', 'float', 'price', 'date', 'tags', 'counter'))) {$v2063c1608d6e0baf80249c42e2be5804 = preg_replace("/<br ?\/?>/i", "\n", $v2063c1608d6e0baf80249c42e2be5804);$v2063c1608d6e0baf80249c42e2be5804 = strip_tags($v2063c1608d6e0baf80249c42e2be5804);}if(in_array($v833750ac635fcc57dc33ecafe365f9a7, array('img_file', 'swf_file', 'file', 'video_file')) && $v2063c1608d6e0baf80249c42e2be5804) {if(substr($v2063c1608d6e0baf80249c42e2be5804, 0, 1) != '.') $v2063c1608d6e0baf80249c42e2be5804 = '.' . $v2063c1608d6e0baf80249c42e2be5804;}$v42aefbae01d2dfd981f7da7d823d689e->setValue($v972bf3f05d14ffbdb817bef60638ff00, $v2063c1608d6e0baf80249c42e2be5804);}$v42aefbae01d2dfd981f7da7d823d689e->commit();umiObjectProperty::$IGNORE_FILTER_INPUT_STRING = false;if($v42aefbae01d2dfd981f7da7d823d689e instanceof iUmiHierarchyElement) {$v402051f4be0cc3aad33bcf3ac3d6532b = backupModel::getInstance();$v402051f4be0cc3aad33bcf3ac3d6532b->fakeBackup($v42aefbae01d2dfd981f7da7d823d689e->id);}$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("eip_save");$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("after");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("field_name", $v972bf3f05d14ffbdb817bef60638ff00);$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("obj", $v42aefbae01d2dfd981f7da7d823d689e);def_module::setEventPoint($v161c9aaa4fe035e7b2f465bc59f3ab45);}if($v972bf3f05d14ffbdb817bef60638ff00 == 'name') {$v2063c1608d6e0baf80249c42e2be5804 = $v42aefbae01d2dfd981f7da7d823d689e->getName();}else {$v2063c1608d6e0baf80249c42e2be5804 = $v42aefbae01d2dfd981f7da7d823d689e->getValue($v972bf3f05d14ffbdb817bef60638ff00, $vadddc69f57bd593b8593dc04b73ea9d6);}if($v15d61712450a686a7f365adf4fef581f == 'save') {$v2063c1608d6e0baf80249c42e2be5804 = xmlTranslator::executeMacroses($v2063c1608d6e0baf80249c42e2be5804);}if($v833750ac635fcc57dc33ecafe365f9a7 == 'date') {if(!$v2063c1608d6e0baf80249c42e2be5804) $v2063c1608d6e0baf80249c42e2be5804 = time();$v5fc732311905cb27e82d67f4f6511f7f = new umiDate();$v5fc732311905cb27e82d67f4f6511f7f->setDateByString($v2063c1608d6e0baf80249c42e2be5804);$v2063c1608d6e0baf80249c42e2be5804 = $v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate('Y-m-d H:i');}if($v833750ac635fcc57dc33ecafe365f9a7 == 'tags' && is_array($v2063c1608d6e0baf80249c42e2be5804)) {$v2063c1608d6e0baf80249c42e2be5804 = implode(', ', $v2063c1608d6e0baf80249c42e2be5804);}if($v833750ac635fcc57dc33ecafe365f9a7 == 'optioned' && !is_null($vadddc69f57bd593b8593dc04b73ea9d6)) {$v2063c1608d6e0baf80249c42e2be5804 = isset($v2063c1608d6e0baf80249c42e2be5804[0]) ? $v2063c1608d6e0baf80249c42e2be5804[0] : '';$v833750ac635fcc57dc33ecafe365f9a7 = getArrayKey($vadddc69f57bd593b8593dc04b73ea9d6, 'field-type');}$result = array(    'property' => array(     'attribute:name'  => $v972bf3f05d14ffbdb817bef60638ff00,     'attribute:type'  => $v833750ac635fcc57dc33ecafe365f9a7    )   );if($v833750ac635fcc57dc33ecafe365f9a7 == 'relation') {$vf1386a17eed513dff70798b0551dc170 = array();if($v2063c1608d6e0baf80249c42e2be5804) {if(!is_array($v2063c1608d6e0baf80249c42e2be5804)) $v2063c1608d6e0baf80249c42e2be5804 = array($v2063c1608d6e0baf80249c42e2be5804);$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();foreach($v2063c1608d6e0baf80249c42e2be5804 as $v16b2b26000987faccb260b9d39df1269) {$va8cfde6331bd59eb2ac96f8911c4b666 = $v5891da2d64975cae48d175d1e001f5da->getObject($v16b2b26000987faccb260b9d39df1269);$vf1386a17eed513dff70798b0551dc170[] = $va8cfde6331bd59eb2ac96f8911c4b666;}}$result['property']['attribute:guide-id'] = $v06e3d36fa30cea095545139854ad1fb9->getGuideId();if($v06e3d36fa30cea095545139854ad1fb9->getFieldType()->getIsMultiple()) {$result['property']['attribute:multiple'] = 'multiple';}$v599dcce2998a6b40b1e38e8c6006cb0a = selector::get('object-type')->id($v06e3d36fa30cea095545139854ad1fb9->getGuideId());if($v599dcce2998a6b40b1e38e8c6006cb0a && $v599dcce2998a6b40b1e38e8c6006cb0a->getIsPublic()) {$result['property']['attribute:public'] = 'public';}$result['property']['nodes:item'] = $vf1386a17eed513dff70798b0551dc170;}else if($v833750ac635fcc57dc33ecafe365f9a7 == 'symlink') {$result['property']['nodes:page'] = is_array($v2063c1608d6e0baf80249c42e2be5804) ? $v2063c1608d6e0baf80249c42e2be5804 : array();}else {$result['property']['node:value'] = $v2063c1608d6e0baf80249c42e2be5804;}if($v3b8ea8567b667adb398dcc8d96da3690 != $v55a31ca9a157d6799bbc5dc865b7fda6) {$result['links'] = array(     'previous' => $v3b8ea8567b667adb398dcc8d96da3690,     'current' => $v55a31ca9a157d6799bbc5dc865b7fda6    );}return $result;}protected static function loadEiPTypes() {static $vd14a8022b085f9ef19d479cbdd581127;if(is_array($vd14a8022b085f9ef19d479cbdd581127)) return $vd14a8022b085f9ef19d479cbdd581127;$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$vd14a8022b085f9ef19d479cbdd581127 = array();$va4f86f7bfc24194b276c22e0ef158197 = $v2245023265ae4cf87d02c8b6ba991139->get('edit-in-place', 'allowed-types');foreach($va4f86f7bfc24194b276c22e0ef158197 as $v981c1e7b3795da18687613fbd66d4954) {list($v599dcce2998a6b40b1e38e8c6006cb0a, $vc68ad910ed49ac65f21f1bf2c5dbf912) = preg_split("/ ?<\- ?/", $v981c1e7b3795da18687613fbd66d4954);list($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce) = split("::", $v599dcce2998a6b40b1e38e8c6006cb0a);$vd14a8022b085f9ef19d479cbdd581127[$v22884db148f0ffb0d830ba431102b0b5][$vea9f6aca279138c58f705c8d4cb4b8ce] = $vc68ad910ed49ac65f21f1bf2c5dbf912;}return $vd14a8022b085f9ef19d479cbdd581127;}protected static function prepareTypesList($vfc3ba572b59679e9e1d4ccb1069fecdc, $vd0e45878043844ffc41aac437e86b602 = null) {$vd14a8022b085f9ef19d479cbdd581127 = self::loadEiPTypes();$v6942e8fa62b3cc9d93881a58210e2fd7 = umiHierarchyTypesCollection::getInstance();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v0ffc9ad8303afce4216f05d62289e63c = $v8b1dc169bf460ee884fceef66c6607d6->getModulesList();if($vd0e45878043844ffc41aac437e86b602 instanceof iUmiHierarchyElement) {$vfc3ba572b59679e9e1d4ccb1069fecdc = $vd0e45878043844ffc41aac437e86b602->getModule();}$v73d808003f59e4aef249bd7e58258d80 = array();foreach($vd14a8022b085f9ef19d479cbdd581127 as $v22884db148f0ffb0d830ba431102b0b5 => $vd9721cb1f45178e09d6d042c4f346036) {if($vd0e45878043844ffc41aac437e86b602 && ($v22884db148f0ffb0d830ba431102b0b5 != $vfc3ba572b59679e9e1d4ccb1069fecdc && $vfc3ba572b59679e9e1d4ccb1069fecdc != 'content')) continue;asort($vd9721cb1f45178e09d6d042c4f346036, true);foreach($vd9721cb1f45178e09d6d042c4f346036 as $vea9f6aca279138c58f705c8d4cb4b8ce => $v981c1e7b3795da18687613fbd66d4954) {if($v981c1e7b3795da18687613fbd66d4954 != '*') {if(!$vd0e45878043844ffc41aac437e86b602) continue;$v47c80780ab608cc046f2a6e6f071feb6 = split('::', $v981c1e7b3795da18687613fbd66d4954);if(sizeof($v47c80780ab608cc046f2a6e6f071feb6) != 2) continue;list($ve66178c10c8cf2eae55466eb6fd0d94c, $v328b1f11b9a2d5c4aedf9438c04ac076) = $v47c80780ab608cc046f2a6e6f071feb6;if($vd0e45878043844ffc41aac437e86b602->getModule() != $ve66178c10c8cf2eae55466eb6fd0d94c || $vd0e45878043844ffc41aac437e86b602->getMethod() != $v328b1f11b9a2d5c4aedf9438c04ac076) {continue;}}$v89b0b9deff65f8b9cd1f71bc74ce36ba = $v6942e8fa62b3cc9d93881a58210e2fd7->getTypeByName($v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);if($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof iUmiHierarchyType) {if(!in_array($v22884db148f0ffb0d830ba431102b0b5, $v0ffc9ad8303afce4216f05d62289e63c)) {continue;}$v73d808003f59e4aef249bd7e58258d80[] = $v89b0b9deff65f8b9cd1f71bc74ce36ba;}}}$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("eipPrepareTypesList");$v4119639092e62c55ea8be348e4d9260d->setParam("targetModule", $vfc3ba572b59679e9e1d4ccb1069fecdc);$v4119639092e62c55ea8be348e4d9260d->setParam("parent", $vd0e45878043844ffc41aac437e86b602);$v4119639092e62c55ea8be348e4d9260d->addRef("types", $v73d808003f59e4aef249bd7e58258d80);$v4119639092e62c55ea8be348e4d9260d->setMode("after");$v4119639092e62c55ea8be348e4d9260d->call();return $v73d808003f59e4aef249bd7e58258d80;}public function eip_quick_add() {$this->setDataType("form");$this->setActionType("create");$v72352a4d26581ef082a6d2243c5a6b88 = (int) getRequest('param0');$v6301cee35ea764a1e241978f93f01069 = (int) getRequest('type-id');$vb8c8ec69026adfe891bf5e618eabb17b = (int) getRequest('force-hierarchy');$v726e8e4809d4c1b28a6549d86436a124 = selector::get('object-type')->id($v6301cee35ea764a1e241978f93f01069);if(!$vb8c8ec69026adfe891bf5e618eabb17b && $v726e8e4809d4c1b28a6549d86436a124 instanceof iUmiObjectType) {$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();$v16b2b26000987faccb260b9d39df1269 = $v5891da2d64975cae48d175d1e001f5da->addObject(NULL, $v6301cee35ea764a1e241978f93f01069);$v8d777f385d3dfec8815d20f7496026dc = array(        'attribute:object-id' => $v16b2b26000987faccb260b9d39df1269,        'status' => 'ok'    );}else {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();$permissions = permissionsCollection::getInstance();if(!$v6301cee35ea764a1e241978f93f01069) $v6301cee35ea764a1e241978f93f01069 = $vb81ca7c0ccaa77e7aa91936ab0070695->getDominantTypeId($v72352a4d26581ef082a6d2243c5a6b88);if(!$v6301cee35ea764a1e241978f93f01069) {throw new publicAdminException("No dominant object type found");}$v726e8e4809d4c1b28a6549d86436a124 = $v0e8133eb006c0f85ed9444ae07a60842->getType($v6301cee35ea764a1e241978f93f01069);$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $v726e8e4809d4c1b28a6549d86436a124->getHierarchyTypeId();$v7552cd149af7495ee7d8225974e50f80 = $vb81ca7c0ccaa77e7aa91936ab0070695->addElement($v72352a4d26581ef082a6d2243c5a6b88, $vacf567c9c3d6cf7c6e2cc0ce108e0631, '', '', $v6301cee35ea764a1e241978f93f01069);$permissions->setDefaultPermissions($v7552cd149af7495ee7d8225974e50f80);$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80);$v8e2dcfd7e7e24b1ca76c1193f645902b->isActive = true;$v8e2dcfd7e7e24b1ca76c1193f645902b->isVisible = true;$v8e2dcfd7e7e24b1ca76c1193f645902b->show_submenu = true;$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint('eipQuickAdd');$v4119639092e62c55ea8be348e4d9260d->setParam('objectTypeId', $v6301cee35ea764a1e241978f93f01069);$v4119639092e62c55ea8be348e4d9260d->setParam('elementId', $v7552cd149af7495ee7d8225974e50f80);$v4119639092e62c55ea8be348e4d9260d->setMode('after');$v4119639092e62c55ea8be348e4d9260d->call();$v8d777f385d3dfec8815d20f7496026dc = array(     'attribute:element-id' => $v7552cd149af7495ee7d8225974e50f80,     'status' => 'ok'    );}cacheFrontend::getInstance()->flush();$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function eip_add_page() {$v15d61712450a686a7f365adf4fef581f = (string) getRequest('param0');$vd0e45878043844ffc41aac437e86b602 = $this->expectElement("param1");$v22884db148f0ffb0d830ba431102b0b5 = (string) getRequest('param2');$vea9f6aca279138c58f705c8d4cb4b8ce = (string) getRequest('param3');$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v6942e8fa62b3cc9d93881a58210e2fd7 = umiHierarchyTypesCollection::getInstance();$permissions = permissionsCollection::getInstance();$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();if($v15d61712450a686a7f365adf4fef581f == 'choose') {$vd14a8022b085f9ef19d479cbdd581127 = self::prepareTypesList($v22884db148f0ffb0d830ba431102b0b5, $vd0e45878043844ffc41aac437e86b602);if(sizeof($vd14a8022b085f9ef19d479cbdd581127) == 1) {list($v89b0b9deff65f8b9cd1f71bc74ce36ba) = $vd14a8022b085f9ef19d479cbdd581127;$v22884db148f0ffb0d830ba431102b0b5 = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getModule();$vea9f6aca279138c58f705c8d4cb4b8ce = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getMethod();if($v22884db148f0ffb0d830ba431102b0b5 == 'content' && !$vea9f6aca279138c58f705c8d4cb4b8ce) $vea9f6aca279138c58f705c8d4cb4b8ce = 'page';$vbfa030fe63bacd523dd70a76cfaed98a = $vd0e45878043844ffc41aac437e86b602 ? $vd0e45878043844ffc41aac437e86b602->id : '0';$v572d4e421e5e6b9bc11d815e8a027112 = $this->pre_lang . "/admin/content/eip_add_page/form/{$vbfa030fe63bacd523dd70a76cfaed98a}/{$v22884db148f0ffb0d830ba431102b0b5}/{$vea9f6aca279138c58f705c8d4cb4b8ce}/";if($vacf567c9c3d6cf7c6e2cc0ce108e0631 = getRequest('hierarchy-type-id')) {$v572d4e421e5e6b9bc11d815e8a027112 .= '?hierarchy-type-id=' . $vacf567c9c3d6cf7c6e2cc0ce108e0631;}$this->chooseRedirect($v572d4e421e5e6b9bc11d815e8a027112);}if(sizeof($vd14a8022b085f9ef19d479cbdd581127) > 1) {if($vacf567c9c3d6cf7c6e2cc0ce108e0631 = getRequest('hierarchy-type-id')) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = $v6942e8fa62b3cc9d93881a58210e2fd7->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof iUmiHierarchyType) {$v22884db148f0ffb0d830ba431102b0b5 = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getModule();$vea9f6aca279138c58f705c8d4cb4b8ce = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getMethod();if($v22884db148f0ffb0d830ba431102b0b5 == 'content' && !$vea9f6aca279138c58f705c8d4cb4b8ce) $vea9f6aca279138c58f705c8d4cb4b8ce = 'page';$vbfa030fe63bacd523dd70a76cfaed98a = $vd0e45878043844ffc41aac437e86b602 ? $vd0e45878043844ffc41aac437e86b602->id : '0';$v572d4e421e5e6b9bc11d815e8a027112 = $this->pre_lang . "/admin/content/eip_add_page/form/{$vbfa030fe63bacd523dd70a76cfaed98a}/{$v22884db148f0ffb0d830ba431102b0b5}/{$vea9f6aca279138c58f705c8d4cb4b8ce}/?0";if(isset($_REQUEST['object-type'][$vacf567c9c3d6cf7c6e2cc0ce108e0631])) {$v572d4e421e5e6b9bc11d815e8a027112 .= '&type-id=' . $_REQUEST['object-type'][$vacf567c9c3d6cf7c6e2cc0ce108e0631];}if($vacf567c9c3d6cf7c6e2cc0ce108e0631 = getRequest('hierarchy-type-id')) {$v572d4e421e5e6b9bc11d815e8a027112 .= '&hierarchy-type-id=' . $vacf567c9c3d6cf7c6e2cc0ce108e0631;}$this->chooseRedirect($v572d4e421e5e6b9bc11d815e8a027112);}}$this->setDataType("list");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = array(      'nodes:hierarchy-type' => $vd14a8022b085f9ef19d479cbdd581127     );$this->setData($v8d777f385d3dfec8815d20f7496026dc, sizeof($vd14a8022b085f9ef19d479cbdd581127));return $this->doData();}if(sizeof($vd14a8022b085f9ef19d479cbdd581127) == 0) {$v7f2db423a49b305459147332fb01cf87->clear();$v7f2db423a49b305459147332fb01cf87->push("An error (temp message)");$v7f2db423a49b305459147332fb01cf87->end();}}$ve62e4d22f2d8630f6e44e2b7c3f70ddc = array(    'type'  => $vea9f6aca279138c58f705c8d4cb4b8ce,    'parent' => $vd0e45878043844ffc41aac437e86b602,    'module' => $v22884db148f0ffb0d830ba431102b0b5   );if($v6301cee35ea764a1e241978f93f01069 = getRequest('type-id')) {$ve62e4d22f2d8630f6e44e2b7c3f70ddc['type-id'] = $v6301cee35ea764a1e241978f93f01069;}else if ($vacf567c9c3d6cf7c6e2cc0ce108e0631 = getRequest('hierarchy-type-id')) {$ve62e4d22f2d8630f6e44e2b7c3f70ddc['type-id'] = $v0e8133eb006c0f85ed9444ae07a60842->getTypeByHierarchyTypeId($vacf567c9c3d6cf7c6e2cc0ce108e0631);}if(getRequest('param4') == "do") {$v7552cd149af7495ee7d8225974e50f80 = $this->saveAddedElementData($ve62e4d22f2d8630f6e44e2b7c3f70ddc);$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80, true);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsActive();$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();}else {throw new publicException("Can't get create umiHierarchyElement");}$permissions->setInheritedPermissions($v7552cd149af7495ee7d8225974e50f80);cacheFrontend::getInstance()->flush();$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();$v7f2db423a49b305459147332fb01cf87->contentType('text/html');$v7f2db423a49b305459147332fb01cf87->clear();$v7f2db423a49b305459147332fb01cf87->push("<script>window.parent.location.reload();</script>");$v7f2db423a49b305459147332fb01cf87->end();}$this->setDataType("form");$this->setActionType("create");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($ve62e4d22f2d8630f6e44e2b7c3f70ddc, "page");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function eip_del_page() {$this->flushAsXml('eip_del_page');$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$permissions = permissionsCollection::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $permissions->getUserId();$v7552cd149af7495ee7d8225974e50f80 = (int) getRequest('element-id');$v16b2b26000987faccb260b9d39df1269 = (int) getRequest('object-id');$v1489b8f591be275786aa6f86a0eb9f02 = $v2245023265ae4cf87d02c8b6ba991139->get('system', 'eip.fake-delete');if($v16b2b26000987faccb260b9d39df1269) {if($permissions->isSv() || $permissions->isOwnerOfObject($v16b2b26000987faccb260b9d39df1269, $permissions->getUserId())) {$v5891da2d64975cae48d175d1e001f5da->delObject($v16b2b26000987faccb260b9d39df1269);cacheFrontend::getInstance()->flush();return array(      'status' => 'ok'     );}else {return array(      'error' => getLabel('error-require-delete-permissions')     );}}else {$vb394126a0e52e75f1e3d535d0fb0d33c = $permissions->isAllowedObject($v8e44f0089b076e18a718eb9ca3d94674, $v7552cd149af7495ee7d8225974e50f80);if($vb394126a0e52e75f1e3d535d0fb0d33c[3]) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {if(!$v8e2dcfd7e7e24b1ca76c1193f645902b->name && !trim($v8e2dcfd7e7e24b1ca76c1193f645902b->altName, '_0123456789') || !$v1489b8f591be275786aa6f86a0eb9f02) {$vb81ca7c0ccaa77e7aa91936ab0070695->delElement($v7552cd149af7495ee7d8225974e50f80);}else {$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsActive(false);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();}cacheFrontend::getInstance()->flush();}return array(      'status' => 'ok'     );}else {return array(      'error' => getLabel('error-require-delete-permissions')     );}}}public function eip_move_page() {$this->flushAsXml('eip_move_page');$permissions = permissionsCollection::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $permissions->getUserId();$v7552cd149af7495ee7d8225974e50f80 = (int) getRequest('param0');$vfc702d2c3985006e9f9e11c68b0d14b7 = (int) getRequest('param1');$v72352a4d26581ef082a6d2243c5a6b88 = getRequest('parent-id');if(is_null($v72352a4d26581ef082a6d2243c5a6b88)) {if($vfc702d2c3985006e9f9e11c68b0d14b7) {$v72352a4d26581ef082a6d2243c5a6b88 = $vb81ca7c0ccaa77e7aa91936ab0070695->getParent($vfc702d2c3985006e9f9e11c68b0d14b7);}else {$v72352a4d26581ef082a6d2243c5a6b88 = $vb81ca7c0ccaa77e7aa91936ab0070695->getParent($v7552cd149af7495ee7d8225974e50f80);}}$vc68ad910ed49ac65f21f1bf2c5dbf912 = $vb81ca7c0ccaa77e7aa91936ab0070695->getAllParents($v72352a4d26581ef082a6d2243c5a6b88);if(in_array($v7552cd149af7495ee7d8225974e50f80, $vc68ad910ed49ac65f21f1bf2c5dbf912)) {throw new publicAdminException(getLabel('error-illegal-moving'));}$vb394126a0e52e75f1e3d535d0fb0d33c = $permissions->isAllowedObject($v8e44f0089b076e18a718eb9ca3d94674, $v7552cd149af7495ee7d8225974e50f80);if($vb394126a0e52e75f1e3d535d0fb0d33c[4]) {$vb81ca7c0ccaa77e7aa91936ab0070695->moveBefore($v7552cd149af7495ee7d8225974e50f80, $v72352a4d26581ef082a6d2243c5a6b88, $vfc702d2c3985006e9f9e11c68b0d14b7 ? $vfc702d2c3985006e9f9e11c68b0d14b7 : false);cacheFrontend::getInstance()->flush();return array(     'status' => 'ok'    );}else {return array(     'error' => getLabel('error-require-move-permissions')    );}}public function frontendPanel() {$this->flushAsXml('frontendPanel');$permissions = permissionsCollection::getInstance();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$v814d6805ed73dca7fcef66bf87a8cebd = 5;$vd3134b23eb03b77752dc3ae32a9ef2c4 = array('data', 'config', 'backup', 'autoupdate');$vfa169c61c2f25544afde9a90364848fb = array('seo', 'search', 'filemanager', 'trash');$v0eb9b3af2e4a00837a1b1a854c9ea18c     = array();$v0ffc9ad8303afce4216f05d62289e63c = array();foreach($vb1444fb0c07653567ad325aa25d4e37a->getList('//modules') as $v22884db148f0ffb0d830ba431102b0b5) $v0ffc9ad8303afce4216f05d62289e63c[] = $v22884db148f0ffb0d830ba431102b0b5[0];$v0ffc9ad8303afce4216f05d62289e63c[] = 'trash';foreach($v0ffc9ad8303afce4216f05d62289e63c as $v22884db148f0ffb0d830ba431102b0b5) {if($permissions->isAllowedModule(false, $v22884db148f0ffb0d830ba431102b0b5) == false) continue;if(in_array($v22884db148f0ffb0d830ba431102b0b5, $vd3134b23eb03b77752dc3ae32a9ef2c4))     $v599dcce2998a6b40b1e38e8c6006cb0a = 'system';else if(in_array($v22884db148f0ffb0d830ba431102b0b5, $vfa169c61c2f25544afde9a90364848fb))     $v599dcce2998a6b40b1e38e8c6006cb0a = 'util';else $v599dcce2998a6b40b1e38e8c6006cb0a = null;if($v22884db148f0ffb0d830ba431102b0b5 == 'data') {if(CURRENT_VERSION_LINE == "free" || CURRENT_VERSION_LINE == "lite" || CURRENT_VERSION_LINE == "freelance") {continue;}}$v0eb9b3af2e4a00837a1b1a854c9ea18c[] = array(     'attribute:label' => getLabel('module-' . $v22884db148f0ffb0d830ba431102b0b5),     'attribute:type' => $v599dcce2998a6b40b1e38e8c6006cb0a,     'node:name'   => $v22884db148f0ffb0d830ba431102b0b5    );}$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v3c6e0b8a9c15224a8228b9a98ca1531d = md5(getServer('HTTP_REFERER'));$vf2f3518f75f3b2856b0245ebb6c5dd09 = is_array(getSession($v3c6e0b8a9c15224a8228b9a98ca1531d)) ? getSession($v3c6e0b8a9c15224a8228b9a98ca1531d) : array();foreach($vf2f3518f75f3b2856b0245ebb6c5dd09 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $vb80bb7740288fda1f201890375a60c8f) $vf2f3518f75f3b2856b0245ebb6c5dd09[$v865c0c0b4ab0e063e5caa3387c1a8741] = $vb80bb7740288fda1f201890375a60c8f[2];$vf2f3518f75f3b2856b0245ebb6c5dd09 = array_unique($vf2f3518f75f3b2856b0245ebb6c5dd09);$v43b5c9175984c071f30b873fdce0a000 = array();foreach($vf2f3518f75f3b2856b0245ebb6c5dd09 as $vb80bb7740288fda1f201890375a60c8f) $v43b5c9175984c071f30b873fdce0a000[] = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($vb80bb7740288fda1f201890375a60c8f);$v8154f2ab366901a6744c15cef7c62eba = new selector('pages');$v8154f2ab366901a6744c15cef7c62eba->where('is_deleted')->equals(0);$v8154f2ab366901a6744c15cef7c62eba->where('is_active')->equals(1);$v8154f2ab366901a6744c15cef7c62eba->order('updatetime')->desc();$v8154f2ab366901a6744c15cef7c62eba->limit(0, $v814d6805ed73dca7fcef66bf87a8cebd);if(sizeof($vf2f3518f75f3b2856b0245ebb6c5dd09) && $permissions->isAllowedModule($permissions->getUserId(), 'backup')) {$v402051f4be0cc3aad33bcf3ac3d6532b = $v8b1dc169bf460ee884fceef66c6607d6->getModule('backup');$v6b306396aa9fdbc560492611d41dd56f = $v402051f4be0cc3aad33bcf3ac3d6532b->backup_panel($vf2f3518f75f3b2856b0245ebb6c5dd09[0]);}else {$v6b306396aa9fdbc560492611d41dd56f = null;}$vee11cbb19052e40b07aac0ca060c23ee = selector::get('object')->id($permissions->getUserId());$vf4ac4122ee48c213eec816f4d7944ea6 = array();$vc66c00ae9f18fc0c67d8973bd07dc4cd = getRequest('referer') ? getRequest('referer') : getServer('HTTP_REFERER');$vf4ac4122ee48c213eec816f4d7944ea6 = new selector('objects');$vf4ac4122ee48c213eec816f4d7944ea6->types('object-type')->name('content', 'ticket');$vf4ac4122ee48c213eec816f4d7944ea6->where('url')->equals($vc66c00ae9f18fc0c67d8973bd07dc4cd);$vf4ac4122ee48c213eec816f4d7944ea6->limit(0, 100);$vad82c73a429bb9b134f3760e7380a9c9 = array();foreach($vf4ac4122ee48c213eec816f4d7944ea6 as $vcdfee2bc43d63caeaa3b169ad31e966c) {$vee11cbb19052e40b07aac0ca060c23ee = selector::get('object')->id($vcdfee2bc43d63caeaa3b169ad31e966c->user_id);if(!$vee11cbb19052e40b07aac0ca060c23ee) continue;$vad82c73a429bb9b134f3760e7380a9c9[] = array(     'attribute:id' => $vcdfee2bc43d63caeaa3b169ad31e966c->id,     'author' => array(      'attribute:fname' => $vee11cbb19052e40b07aac0ca060c23ee->fname,      'attribute:lname' => $vee11cbb19052e40b07aac0ca060c23ee->lname,      'attribute:login' => $vee11cbb19052e40b07aac0ca060c23ee->login     ),     'position' => array(      'attribute:x' => $vcdfee2bc43d63caeaa3b169ad31e966c->x,      'attribute:y' => $vcdfee2bc43d63caeaa3b169ad31e966c->y,      'attribute:width' => $vcdfee2bc43d63caeaa3b169ad31e966c->width,      'attribute:height' => $vcdfee2bc43d63caeaa3b169ad31e966c->height     ),     'message' => $vcdfee2bc43d63caeaa3b169ad31e966c->message    );}$result = array(    'user'  => array(     'attribute:id' => $vee11cbb19052e40b07aac0ca060c23ee->id,     'attribute:fname' => $vee11cbb19052e40b07aac0ca060c23ee->fname,     'attribute:lname' => $vee11cbb19052e40b07aac0ca060c23ee->lname,     'attribute:login' => $vee11cbb19052e40b07aac0ca060c23ee->login    ),    'tickets' => array(     'nodes:ticket' => $vad82c73a429bb9b134f3760e7380a9c9    ),    'modules' => array('nodes:module' => $v0eb9b3af2e4a00837a1b1a854c9ea18c),    'documents'  => array(     'editable'  => array('nodes:page' => $v43b5c9175984c071f30b873fdce0a000),     'recent'  => array('nodes:page' => $v8154f2ab366901a6744c15cef7c62eba->result())    )   );if(!$permissions->isAllowedMethod($permissions->getUserId(), 'content', 'tickets')) {unset($result['tickets']);}if($v6b306396aa9fdbc560492611d41dd56f && sizeof($v6b306396aa9fdbc560492611d41dd56f['nodes:revision'])) {$result['changelog'] = $v6b306396aa9fdbc560492611d41dd56f;}$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint('eipFrontendPanelGet');$v4119639092e62c55ea8be348e4d9260d->setParam("id", getArrayKey($vf2f3518f75f3b2856b0245ebb6c5dd09, 0));$v4119639092e62c55ea8be348e4d9260d->addRef("result", $result);$v4119639092e62c55ea8be348e4d9260d->setMode('after');$v4119639092e62c55ea8be348e4d9260d->call();return $result;}static function filterStringValue($v2063c1608d6e0baf80249c42e2be5804) {$v8d351c5ff6464ae701704f2390cf06c8 = array('&nbsp;', ' ', '\n');foreach($v8d351c5ff6464ae701704f2390cf06c8 as $v9e2cd3a49272eb4863464c187878b93d) {if(substr($v2063c1608d6e0baf80249c42e2be5804, 0, strlen($v9e2cd3a49272eb4863464c187878b93d)) == $v9e2cd3a49272eb4863464c187878b93d) {$v2063c1608d6e0baf80249c42e2be5804 = substr($v2063c1608d6e0baf80249c42e2be5804, strlen($v9e2cd3a49272eb4863464c187878b93d));}if(substr($v2063c1608d6e0baf80249c42e2be5804, strlen($v2063c1608d6e0baf80249c42e2be5804) - strlen($v9e2cd3a49272eb4863464c187878b93d)) == $v9e2cd3a49272eb4863464c187878b93d) {$v2063c1608d6e0baf80249c42e2be5804 = substr($v2063c1608d6e0baf80249c42e2be5804, 0, strlen($v2063c1608d6e0baf80249c42e2be5804) - strlen($v9e2cd3a49272eb4863464c187878b93d));}}return $v2063c1608d6e0baf80249c42e2be5804;}};?>
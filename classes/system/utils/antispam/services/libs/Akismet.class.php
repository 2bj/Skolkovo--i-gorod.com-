<?php
class Akismet {private $version = '0.4';private $wordPressAPIKey;private $blogURL;private $comment;private $apiPort;private $akismetServer;private $akismetVersion;private $ignore = array('HTTP_COOKIE',        'HTTP_X_FORWARDED_FOR',        'HTTP_X_FORWARDED_HOST',        'HTTP_MAX_FORWARDS',        'HTTP_X_FORWARDED_SERVER',        'REDIRECT_STATUS',        'SERVER_PORT',        'PATH',       'DOCUMENT_ROOT',       'SERVER_ADMIN',       'QUERY_STRING',       'PHP_SELF' );public function __construct($vdf21c96ce7dc933b3544df66fb0818ef, $vea17f03f87a091cc211f4fcf19f433a6) {$this->blogURL = $vdf21c96ce7dc933b3544df66fb0818ef;$this->wordPressAPIKey = $vea17f03f87a091cc211f4fcf19f433a6;$this->apiPort = 80;$this->akismetServer = 'rest.akismet.com';$this->akismetVersion = '1.1';$this->comment['blog'] = $vdf21c96ce7dc933b3544df66fb0818ef;$this->comment['user_agent'] = $_SERVER['HTTP_USER_AGENT'];if(isset($_SERVER['HTTP_REFERER'])) {$this->comment['referrer'] = $_SERVER['HTTP_REFERER'];}$this->comment['user_ip'] = $_SERVER['REMOTE_ADDR'] != getenv('SERVER_ADDR') ? $_SERVER['REMOTE_ADDR'] : getenv('HTTP_X_FORWARDED_FOR');}public function isKeyValid() {$vd1fc8eaf36937be0c3ba8cfe0a2c1bfe = $this->sendRequest('key=' . $this->wordPressAPIKey . '&blog=' . $this->blogURL, $this->akismetServer, '/' . $this->akismetVersion . '/verify-key');return $vd1fc8eaf36937be0c3ba8cfe0a2c1bfe[1] == 'valid';}private function sendRequest($v10573b873d2fa5a365d558a45e328e47, $v67b3dba8bc6778101892eb77249db32e, $vd6fe1d0be6347b8ef2427fa629c04485) {$v50ffed5272a17076d539eb7b322837ad  = "POST " . $vd6fe1d0be6347b8ef2427fa629c04485 . " HTTP/1.0\r\n";$v50ffed5272a17076d539eb7b322837ad .= "Host: " . $v67b3dba8bc6778101892eb77249db32e . "\r\n";$v50ffed5272a17076d539eb7b322837ad .= "Content-Type: application/x-www-form-urlencoded; charset=utf-8\r\n";$v50ffed5272a17076d539eb7b322837ad .= "Content-Length: " . strlen($v10573b873d2fa5a365d558a45e328e47) . "\r\n";$v50ffed5272a17076d539eb7b322837ad .= "User-Agent: Akismet PHP5 Class " . $this->version . " | Akismet/1.11\r\n";$v50ffed5272a17076d539eb7b322837ad .= "\r\n";$v50ffed5272a17076d539eb7b322837ad .= $v10573b873d2fa5a365d558a45e328e47;$v849e562f527fa75ce699499680832c68 = new SocketWriteRead($v67b3dba8bc6778101892eb77249db32e, $this->apiPort, $v50ffed5272a17076d539eb7b322837ad);$v849e562f527fa75ce699499680832c68->send();return explode("\r\n\r\n", $v849e562f527fa75ce699499680832c68->getResponse(), 2);}private function getQueryString() {foreach($_SERVER as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v2063c1608d6e0baf80249c42e2be5804) {if(!in_array($v3c6e0b8a9c15224a8228b9a98ca1531d, $this->ignore)) {if($v3c6e0b8a9c15224a8228b9a98ca1531d == 'REMOTE_ADDR') {$this->comment[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $this->comment['user_ip'];}else {$this->comment[$v3c6e0b8a9c15224a8228b9a98ca1531d] = $v2063c1608d6e0baf80249c42e2be5804;}}}$v29b7cb96898457c6eb3e355ce9d88544 = '';foreach($this->comment as $v3c6e0b8a9c15224a8228b9a98ca1531d => $v8d777f385d3dfec8815d20f7496026dc) {if(!is_array($v8d777f385d3dfec8815d20f7496026dc)) {$v29b7cb96898457c6eb3e355ce9d88544 .= $v3c6e0b8a9c15224a8228b9a98ca1531d . '=' . urlencode(stripslashes($v8d777f385d3dfec8815d20f7496026dc)) . '&';}}return $v29b7cb96898457c6eb3e355ce9d88544;}public function isCommentSpam() {$vd1fc8eaf36937be0c3ba8cfe0a2c1bfe = $this->sendRequest($this->getQueryString(), $this->wordPressAPIKey . '.rest.akismet.com', '/' . $this->akismetVersion . '/comment-check');if($vd1fc8eaf36937be0c3ba8cfe0a2c1bfe[1] == 'invalid' && !$this->isKeyValid()) {throw new exception('The Wordpress API key passed to the Akismet constructor is invalid.  Please obtain a valid one from http://wordpress.com/api-keys/');}return ($vd1fc8eaf36937be0c3ba8cfe0a2c1bfe[1] == 'true');}public function submitSpam() {$this->sendRequest($this->getQueryString(), $this->wordPressAPIKey . '.' . $this->akismetServer, '/' . $this->akismetVersion . '/submit-spam');}public function submitHam() {$this->sendRequest($this->getQueryString(), $this->wordPressAPIKey . '.' . $this->akismetServer, '/' . $this->akismetVersion . '/submit-ham');}public function setUserIP($v89c2716eb1fc7a9b51d4eda901c7546e) {$this->comment['user_ip'] = $v89c2716eb1fc7a9b51d4eda901c7546e;}public function setReferrer($vcea75f8cd36a4f8567d5068b7e7e05e8) {$this->comment['referrer'] = $vcea75f8cd36a4f8567d5068b7e7e05e8;}public function setPermalink($v901410934be56b0767bd3093135876ac) {$this->comment['permalink'] = $v901410934be56b0767bd3093135876ac;}public function setCommentType($v7af0ed45d9449fd75bd3760370cf08ef) {$this->comment['comment_type'] = $v7af0ed45d9449fd75bd3760370cf08ef;}public function setCommentAuthor($vbd7313ed7e7cd68b83b53a5bb4621632) {$this->comment['comment_author'] = $vbd7313ed7e7cd68b83b53a5bb4621632;}public function setCommentAuthorEmail($v1b40277f2ed3551eed81c78bc892c361) {$this->comment['comment_author_email'] = $v1b40277f2ed3551eed81c78bc892c361;}public function setCommentAuthorURL($v7c84b9383cd2bf3ff2ed3c126cbd557d) {$this->comment['comment_author_url'] = $v7c84b9383cd2bf3ff2ed3c126cbd557d;}public function setCommentContent($v259ca478ccb741b206ed2d1c01187a0b) {$this->comment['comment_content'] = $v259ca478ccb741b206ed2d1c01187a0b;}public function setAPIPort($v247b774e60e6169aa48c984c9a454841) {$this->apiPort = $v247b774e60e6169aa48c984c9a454841;}public function setAkismetServer($v9f1dedc49b31ab62ed9c8342e560a52a) {$this->akismetServer = $v9f1dedc49b31ab62ed9c8342e560a52a;}public function setAkismetVersion($v6f9c5eeeda25afb667ae243a82f091f2) {$this->akismetVersion = $v6f9c5eeeda25afb667ae243a82f091f2;}}class SocketWriteRead {private $host;private $port;private $request;private $response;private $responseLength;private $errorNumber;private $errorString;public function __construct($v67b3dba8bc6778101892eb77249db32e, $v901555fb06e346cb065ceb9808dcfc25, $v10573b873d2fa5a365d558a45e328e47, $v7019cc5a44cbf45b99e12854b22208f0 = 1160) {$this->host = $v67b3dba8bc6778101892eb77249db32e;$this->port = $v901555fb06e346cb065ceb9808dcfc25;$this->request = $v10573b873d2fa5a365d558a45e328e47;$this->responseLength = $v7019cc5a44cbf45b99e12854b22208f0;$this->errorNumber = 0;$this->errorString = '';}public function send() {$this->response = '';$vbc7b36fe4d2924e49800d9b3dc4a325c = fsockopen($this->host, $this->port, $this->errorNumber, $this->errorString, 3);if($this->errorNumber != 0) {throw new Exception('Error connecting to host: ' . $this->host . ' Error number: ' . $this->errorNumber . ' Error message: ' . $this->errorString);}if($vbc7b36fe4d2924e49800d9b3dc4a325c !== false) {@fwrite($vbc7b36fe4d2924e49800d9b3dc4a325c, $this->request);while(!feof($vbc7b36fe4d2924e49800d9b3dc4a325c)) {$this->response .= fgets($vbc7b36fe4d2924e49800d9b3dc4a325c, $this->responseLength);}fclose($vbc7b36fe4d2924e49800d9b3dc4a325c);}}public function getResponse() {return $this->response;}public function getErrorNumner() {return $this->errorNumber;}public function getErrorString() {return $this->errorString;}}?>
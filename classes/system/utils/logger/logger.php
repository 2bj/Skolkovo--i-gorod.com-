<?php
 class umiLogger implements iUmiLogger {protected $logDir = "./logs/",     $log = "",     $is_saved = false,     $is_global_env_pushed = false,     $start_time = false;public function __construct($vd3326835044515b68dab0a9dc8eec976 = "./logs/") {$this->runTimer();$this->logDir = $vd3326835044515b68dab0a9dc8eec976;$this->checkDirectory();}public function pushGlobalEnviroment() {if($this->is_global_env_pushed == false) {$this->collectGlobalEnviroment();$this->is_global_env_pushed = true;return true;}else {return false;}}public function push($vf664237e19ad7e814700e688b6016d6c, $v7474e980a35c8d389fd3a8f1991c0352 = true) {if($v7474e980a35c8d389fd3a8f1991c0352 == true) {$vf664237e19ad7e814700e688b6016d6c = "[" . sprintf("%1.7f", $this->getTimer()) . "]\t" . $vf664237e19ad7e814700e688b6016d6c;}$this->log .= $vf664237e19ad7e814700e688b6016d6c . "\n";}public function log() {$this->pushGlobalEnviroment();}public function __destruct() {if($this->is_saved == false) {$this->save();}}public function save() {$v0325035afbe5ded2250a31010977cedf = $this->prepareStoreDir();$v435ed7e9f07f740abf511a62c00eef6e = date("Y-m-d_H_i_s");$v6a2a431fe8b621037ea949531c28551d = $v0325035afbe5ded2250a31010977cedf . "/" . $v435ed7e9f07f740abf511a62c00eef6e . ".log";if(file_put_contents($v6a2a431fe8b621037ea949531c28551d, $this->get())) {return $v6a2a431fe8b621037ea949531c28551d;}else {throw new Exception("Can't save log in \"{$v6a2a431fe8b621037ea949531c28551d}\"");}$this->is_saved = true;}public function get() {return $this->log;}protected function checkDirectory() {$v183f3fe79292a8d428a6160d1d44bd90 = $this->logDir;if(is_dir($v183f3fe79292a8d428a6160d1d44bd90)) {if(is_writable($v183f3fe79292a8d428a6160d1d44bd90)) {return true;}else {throw new Exception("Directory \"{$v183f3fe79292a8d428a6160d1d44bd90}\" must be writable");}}else {throw new Exception("Directory \"{$v183f3fe79292a8d428a6160d1d44bd90}\" doesn't exists");}}protected function prepareStoreDir() {$v183f3fe79292a8d428a6160d1d44bd90 = $this->logDir;$v89d2e9db6cf76746b7bebdc7f21d1646 = $_SERVER['REMOTE_ADDR'];$vd30057347e577d1ac6f943b16c967047 = $v183f3fe79292a8d428a6160d1d44bd90 . $v89d2e9db6cf76746b7bebdc7f21d1646;if(file_exists($vd30057347e577d1ac6f943b16c967047)) {if(is_writable($vd30057347e577d1ac6f943b16c967047)) {return $vd30057347e577d1ac6f943b16c967047;}else {throw new Exception("Directory \"{$vd30057347e577d1ac6f943b16c967047}\" must be writable");}}if(mkdir($vd30057347e577d1ac6f943b16c967047)) {return $vd30057347e577d1ac6f943b16c967047 . '/';}else {throw new Exception("Can't create directory \"{$vd30057347e577d1ac6f943b16c967047}\"");}}protected function collectGlobalEnviroment() {$this->collectGlobalArray('_COOKIE');$this->collectGlobalArray('_SESSION');$this->collectGlobalArray('_POST');$this->collectGlobalArray('_GET');$this->collectGlobalArray('_FILES');if(function_exists('apache_request_headers')) {$this->collectArray("Request headers", apache_request_headers());}if(function_exists('apache_response_headers')) {$this->collectArray("Response headers", apache_response_headers());}}protected function collectGlobalArray($v2b359ce0e32ccc218965d608c087eabc) {global $$v2b359ce0e32ccc218965d608c087eabc;if(isset($$v2b359ce0e32ccc218965d608c087eabc)) {$this->collectArray($v2b359ce0e32ccc218965d608c087eabc, $$v2b359ce0e32ccc218965d608c087eabc);}}protected function collectArray($vb068931cc450442b63f5b3d276ea4297, $v47c80780ab608cc046f2a6e6f071feb6) {if(!is_array($v47c80780ab608cc046f2a6e6f071feb6)) {return false;}if(sizeof($v47c80780ab608cc046f2a6e6f071feb6) == 0) {return true;}$v6e2baaf3b97dbeef01c0043275f9a0e7 = "[{$vb068931cc450442b63f5b3d276ea4297}]\n";foreach($v47c80780ab608cc046f2a6e6f071feb6 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {$v6e2baaf3b97dbeef01c0043275f9a0e7 .= "\t[" . $v865c0c0b4ab0e063e5caa3387c1a8741 . "]\n\t" . "(" . gettype($v9e3669d19b675bd57058fd4664205d2a) . ") ";if(is_array($v9e3669d19b675bd57058fd4664205d2a)) {$v9e3669d19b675bd57058fd4664205d2a = $this->serializeArray($v9e3669d19b675bd57058fd4664205d2a);}$v6e2baaf3b97dbeef01c0043275f9a0e7 .= $v9e3669d19b675bd57058fd4664205d2a . "\n\n";}$this->push($v6e2baaf3b97dbeef01c0043275f9a0e7, false);return true;}protected function serializeArray($v47c80780ab608cc046f2a6e6f071feb6) {$v9b207167e5381c47682c6b4f58a623fb = "[";$v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($v47c80780ab608cc046f2a6e6f071feb6);$v4a8a08f09d37b73795649038408b5f33 = 0;foreach($v47c80780ab608cc046f2a6e6f071feb6 as $v865c0c0b4ab0e063e5caa3387c1a8741 => $v9e3669d19b675bd57058fd4664205d2a) {if(is_array($v9e3669d19b675bd57058fd4664205d2a)) {$v9e3669d19b675bd57058fd4664205d2a = $this->serializeArray($v9e3669d19b675bd57058fd4664205d2a);}$v9b207167e5381c47682c6b4f58a623fb .= "'" . $v9e3669d19b675bd57058fd4664205d2a . "'";if(++$v4a8a08f09d37b73795649038408b5f33 < $v7dabf5c198b0bab2eaa42bb03a113e55) {$v9b207167e5381c47682c6b4f58a623fb .= ", ";}}$v9b207167e5381c47682c6b4f58a623fb .= "]";return $v9b207167e5381c47682c6b4f58a623fb;}protected function runTimer() {$this->start_time = microtime(true);}protected function getTimer() {$v07cc694b9b3fc636710fa08b6922c42b = microtime(true) - $this->start_time;return round($v07cc694b9b3fc636710fa08b6922c42b, 7);}};?>
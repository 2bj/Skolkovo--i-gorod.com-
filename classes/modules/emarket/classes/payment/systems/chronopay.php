<?php
 class chronopayPayment extends payment {public function validate() {return true;}public function process($v66f6181bcb4cff4cd38fbc804a036db6 = null) {$vcfe72f938f573f930d77049c4d4e765d = $this->object->product_id;$v11afe4b7e9141a9733fba1111534287c    = $this->object->site_id;$v59bb40a8ec256af8512a27eb24e6373a = $this->order->getId();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v8512ae7d57b1396273f76fe6ed341a23 = strtolower($v8b1dc169bf460ee884fceef66c6607d6->getCurrentLang()->getPrefix());switch ($v8512ae7d57b1396273f76fe6ed341a23) {case 'ru':     $v8512ae7d57b1396273f76fe6ed341a23 = 'Ru';break;case 'nl':     $v8512ae7d57b1396273f76fe6ed341a23 = 'Nl';break;default:     $v8512ae7d57b1396273f76fe6ed341a23 = 'En';break;}$vf577972c317be099478aeac2a0f911ff = $this->order->getActualPrice();$v1a565439c42e953c4d780f860c7bbbc4   = $this->object->secret;$vc903e6a54034f8e5e6816d62cb1b1535  = number_format($vf577972c317be099478aeac2a0f911ff, 2, '.', '');$v04b29480233f4def5c875875b6bdc3b1 = md5($vcfe72f938f573f930d77049c4d4e765d . '-' . $vc903e6a54034f8e5e6816d62cb1b1535 . '-' . $v1a565439c42e953c4d780f860c7bbbc4);$v0540ed4af888f1eadba9cd0eb73554bc = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getHost() .       "/emarket/gateway/" . $this->order->getId() . "/";$veca07335a33c5aeb5e1bc7c98b4b9d80 = array();$veca07335a33c5aeb5e1bc7c98b4b9d80["formAction"]    = "https://secure.chronopay.com/selection.cgi";$veca07335a33c5aeb5e1bc7c98b4b9d80["product_id"] = $vcfe72f938f573f930d77049c4d4e765d;$veca07335a33c5aeb5e1bc7c98b4b9d80["product_name"] = $v59bb40a8ec256af8512a27eb24e6373a;$veca07335a33c5aeb5e1bc7c98b4b9d80["product_price"] = $vf577972c317be099478aeac2a0f911ff;$veca07335a33c5aeb5e1bc7c98b4b9d80["language"]  = $v8512ae7d57b1396273f76fe6ed341a23;$veca07335a33c5aeb5e1bc7c98b4b9d80["cs1"]   = $this->order->getId();$veca07335a33c5aeb5e1bc7c98b4b9d80["cs2"]   = "";$veca07335a33c5aeb5e1bc7c98b4b9d80["cs3"]   = "";$veca07335a33c5aeb5e1bc7c98b4b9d80["cb_type"]  = "P";$veca07335a33c5aeb5e1bc7c98b4b9d80["cb_url"]  = $v0540ed4af888f1eadba9cd0eb73554bc;$veca07335a33c5aeb5e1bc7c98b4b9d80["decline_url"] = $v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getHost();$veca07335a33c5aeb5e1bc7c98b4b9d80["sign"]   = $v04b29480233f4def5c875875b6bdc3b1;$this->order->setPaymentStatus('initialized');list($v78325ef2910aaa327bba1fde7d68bbf9) = def_module::loadTemplates("./tpls/emarket/payment/chronopay/".$v66f6181bcb4cff4cd38fbc804a036db6.".tpl", "form_block");return def_module::parseTemplate($v78325ef2910aaa327bba1fde7d68bbf9, $veca07335a33c5aeb5e1bc7c98b4b9d80);}public function poll() {if (!isset($_SERVER['REMOTE_ADDR']) || $_SERVER['REMOTE_ADDR'] !== '69.20.58.35') {return false;}$v1a565439c42e953c4d780f860c7bbbc4 = $this->object->secret;$vc7fe6c0da028dabd8e96b311aeb9eedc = getRequest('customer_id');$v671139edeb98807421e35e63d9c29a6a   = getRequest('transaction_id');$vced02f721e522c9c96aa344901916d43 = getRequest('transaction_type');$vfbb44b4487415b134bce9c790a27fe5e      = getRequest('total');$v8185eea876d5ab9883766ce81a97660c = md5($v1a565439c42e953c4d780f860c7bbbc4 . $vc7fe6c0da028dabd8e96b311aeb9eedc . $v671139edeb98807421e35e63d9c29a6a . $vced02f721e522c9c96aa344901916d43 . $vfbb44b4487415b134bce9c790a27fe5e);if(strcasecmp($v8185eea876d5ab9883766ce81a97660c, getRequest('sign') ) != 0) {return false;}if($vced02f721e522c9c96aa344901916d43 !== 'Decline') {$this->order->setPaymentStatus('accepted');}else {$this->order->setPaymentStatus('declined');}$this->order->payment_document_num = $v671139edeb98807421e35e63d9c29a6a;}};?>
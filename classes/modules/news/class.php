<?php
class news extends def_module {public $per_page;public function __construct() {parent::__construct();if(cmsController::getInstance()->getCurrentMode() == "admin") {$v7513817107edd8b1833da90a2411cb3e = $this->getConfigTabs();if ($v7513817107edd8b1833da90a2411cb3e) {$v7513817107edd8b1833da90a2411cb3e->add("config");$v7513817107edd8b1833da90a2411cb3e->add("rss_list");$v7513817107edd8b1833da90a2411cb3e->add("subjects");}$this->__loadLib("__admin.php");$this->__implement("__news");$this->__loadLib("__subjects.php");$this->__implement("__subjects_news");$this->__loadLib("__custom_adm.php");$this->__implement("__custom_adm_news");}else {$this->__loadLib("__custom.php");$this->__implement("__custom_news");$this->per_page = regedit::getInstance()->getVal("//modules/news/per_page");}$this->__loadLib("__rss_import.php");$this->__implement("__rss_import_news");}public function calendar() {$this->__loadLib("calendar.php");$this->__implement("calendar");$v84cdc76cabf41bd7c961f6ab12f117d8  = getRequest('year') ? (int) getRequest('year') : date('Y');$v7436f942d5ea836cb84f1bb2527d8286 = getRequest('month') ? (int) getRequest('month') : date('m');$va0e7b2a565119c0a7ec3126a16016113 = new Calendar();$v78e6dd7a49f5b0cb2106a3a434dd5c86 = cmsController::getInstance()->getCurrentLang()->getId();$v7572559ca86e781ba8fe8073a0b725c6 = langsCollection::getInstance()->getLang($v78e6dd7a49f5b0cb2106a3a434dd5c86);if ($v7572559ca86e781ba8fe8073a0b725c6->getPrefix() == "ru")  {$va0e7b2a565119c0a7ec3126a16016113->setMonthNames(array("Январь", "Февраль", "Март", "Апрель", "Май", "Июнь",       "Июль", "Август", "Сентябрь", "Октябрь", "Ноябрь", "Декабрь"));$va0e7b2a565119c0a7ec3126a16016113->setDayNames(array("Вс", "Пн", "Вт", "Ср", "Чт", "Пт", "Сб"));$va0e7b2a565119c0a7ec3126a16016113->setStartDay(1);}$result = $va0e7b2a565119c0a7ec3126a16016113->getMonthView($v7436f942d5ea836cb84f1bb2527d8286, $v84cdc76cabf41bd7c961f6ab12f117d8);return $result;}public function lastlist($vd6fe1d0be6347b8ef2427fa629c04485 = "", $v66f6181bcb4cff4cd38fbc804a036db6 = "default", $v9d85c254b5062e518a134a61950999c3 = false, $v126424c808da347218ba631a78feaf04 = false, $v5b3e5a12bbd31d7e787635bc124dc396 = '', $v860fbe43bd299b2d3afd14b898d4da98 = false) {if($this->breakMe()) return;if(!$v9d85c254b5062e518a134a61950999c3) $v9d85c254b5062e518a134a61950999c3 = $this->per_page;if (strlen($v5b3e5a12bbd31d7e787635bc124dc396)) {$va99c8dcd63334ef25efb41ac2ee45589 = '';$v6595bab9b170d6b0f0f4bdb3e1405d9e = 0;$v22fa1e8da54770b52032043dc5bdce56 = '';$vfdb17cc775dba8fd5f45f38aef15258a = 0;$va5e9ac75a40ffda012d8a0c9ddd26ea5 = preg_split("/\s+/is", $v5b3e5a12bbd31d7e787635bc124dc396);if (isset($va5e9ac75a40ffda012d8a0c9ddd26ea5[0])) $va99c8dcd63334ef25efb41ac2ee45589 = $va5e9ac75a40ffda012d8a0c9ddd26ea5[0];if (isset($va5e9ac75a40ffda012d8a0c9ddd26ea5[1])) $v22fa1e8da54770b52032043dc5bdce56 = $va5e9ac75a40ffda012d8a0c9ddd26ea5[1];$vbc26130036e0a5b04971861f1ea1cf06 = time();if ($va99c8dcd63334ef25efb41ac2ee45589 === '+') {$v6595bab9b170d6b0f0f4bdb3e1405d9e = (PHP_INT_MAX - $vbc26130036e0a5b04971861f1ea1cf06);}elseif ($va99c8dcd63334ef25efb41ac2ee45589 === '-') {$v6595bab9b170d6b0f0f4bdb3e1405d9e = (0 - PHP_INT_MAX + $vbc26130036e0a5b04971861f1ea1cf06);}else {$v6595bab9b170d6b0f0f4bdb3e1405d9e = intval($va99c8dcd63334ef25efb41ac2ee45589);$v2e5e6c78603045c1611f3dc744fe1927 = substr($va99c8dcd63334ef25efb41ac2ee45589, -1);if ($v2e5e6c78603045c1611f3dc744fe1927 === 'm') {$v6595bab9b170d6b0f0f4bdb3e1405d9e *= (60);}elseif ($v2e5e6c78603045c1611f3dc744fe1927 === 'h' || $v2e5e6c78603045c1611f3dc744fe1927 === 'H') {$v6595bab9b170d6b0f0f4bdb3e1405d9e *= (60*60);}else {$v6595bab9b170d6b0f0f4bdb3e1405d9e *= (60*60*24);}}if ($v22fa1e8da54770b52032043dc5bdce56 === '+') {$vfdb17cc775dba8fd5f45f38aef15258a = (PHP_INT_MAX - $vbc26130036e0a5b04971861f1ea1cf06);}elseif ($v22fa1e8da54770b52032043dc5bdce56 === '-') {$vfdb17cc775dba8fd5f45f38aef15258a = (0 - PHP_INT_MAX + $vbc26130036e0a5b04971861f1ea1cf06);}else {$vfdb17cc775dba8fd5f45f38aef15258a = intval($v22fa1e8da54770b52032043dc5bdce56);$v2e5e6c78603045c1611f3dc744fe1927 = substr($v22fa1e8da54770b52032043dc5bdce56, -1);if ($v2e5e6c78603045c1611f3dc744fe1927 === 'm') {$vfdb17cc775dba8fd5f45f38aef15258a *= (60);}elseif ($v2e5e6c78603045c1611f3dc744fe1927 === 'h' || $v2e5e6c78603045c1611f3dc744fe1927 === 'H') {$vfdb17cc775dba8fd5f45f38aef15258a *= (60*60);}else {$vfdb17cc775dba8fd5f45f38aef15258a *= (60*60*24);}}$vc56bb2f8387a1bd1f57450dd23abb3e8 = $vbc26130036e0a5b04971861f1ea1cf06 + $v6595bab9b170d6b0f0f4bdb3e1405d9e;$va5e54dcdab702358cd07f9db87043cd6 = $vbc26130036e0a5b04971861f1ea1cf06 + $vfdb17cc775dba8fd5f45f38aef15258a;$v179c6c824c386f171150cb8286bbb9c1 = ($vc56bb2f8387a1bd1f57450dd23abb3e8 >= $va5e54dcdab702358cd07f9db87043cd6 ? false : true);}else {$vc56bb2f8387a1bd1f57450dd23abb3e8 = false;$va5e54dcdab702358cd07f9db87043cd6 = false;$v179c6c824c386f171150cb8286bbb9c1 = false;}list($v364f9b183bd2dd9e0beb45c754830a6c, $v28d65bb7a643774ada22f54ca0679289, $vb1c0ed8b2e25638833f73a19e1954309, $vedfb9a557bf6b2ab56513172657f1aea) = def_module::loadTemplates("tpls/news/{$v66f6181bcb4cff4cd38fbc804a036db6}.tpl", "lastlist_block", "lastlist_block_empty", "lastlist_item", "lastlist_archive");$ve1ba980ce14a8c0d7e2779f895ab8695 = (int) getRequest('p');if($v126424c808da347218ba631a78feaf04) $ve1ba980ce14a8c0d7e2779f895ab8695 = 0;$v6be379826b20cc58475f636e33f4606b = $this->analyzeRequiredPath($vd6fe1d0be6347b8ef2427fa629c04485);if($v6be379826b20cc58475f636e33f4606b === false && $vd6fe1d0be6347b8ef2427fa629c04485 != KEYWORD_GRAB_ALL) {throw new publicException(getLabel('error-page-does-not-exist', null, $vd6fe1d0be6347b8ef2427fa629c04485));}$v7436f942d5ea836cb84f1bb2527d8286 = (int) getRequest('month');$v84cdc76cabf41bd7c961f6ab12f117d8 = (int) getRequest('year');$v628b7db04235f228d40adc671413a8c8 = (int) getRequest('day');$v0715f6d9497f93911417c9c324265771 = umiHierarchyTypesCollection::getInstance()->getTypeByName("news", "item")->getId();$v87306dd4235ed712ebc07fe169b76f83 = umiObjectTypesCollection::getInstance()->getBaseType("news", "item");$v7ae7003da59ae71dcc9f8638ef50593d = umiObjectTypesCollection::getInstance()->getType($v87306dd4235ed712ebc07fe169b76f83);$vd0d5ad0219c6bb59a29b5027add37795 = $v7ae7003da59ae71dcc9f8638ef50593d->getFieldId('publish_time');$v8be74552df93e31bbdd6b36ed74bdb6a = new umiSelection;$v8be74552df93e31bbdd6b36ed74bdb6a->addElementType($v0715f6d9497f93911417c9c324265771);if($vd6fe1d0be6347b8ef2427fa629c04485 != KEYWORD_GRAB_ALL) {$v8be74552df93e31bbdd6b36ed74bdb6a->addHierarchyFilter($v6be379826b20cc58475f636e33f4606b, 0, true);}$v8be74552df93e31bbdd6b36ed74bdb6a->addPermissions();if (!$v860fbe43bd299b2d3afd14b898d4da98) {$v8be74552df93e31bbdd6b36ed74bdb6a->setOrderByProperty($vd0d5ad0219c6bb59a29b5027add37795, $v179c6c824c386f171150cb8286bbb9c1);}if (!empty($v7436f942d5ea836cb84f1bb2527d8286) && !empty($v84cdc76cabf41bd7c961f6ab12f117d8) && !empty($v628b7db04235f228d40adc671413a8c8)) {$vbb76e2549b666f1d2982782d9477fcd3 = mktime(0, 0, 0, $v7436f942d5ea836cb84f1bb2527d8286, $v628b7db04235f228d40adc671413a8c8, $v84cdc76cabf41bd7c961f6ab12f117d8);$v453242be35ea9152a4210e5c706e4ffb = mktime(23, 59, 59, $v7436f942d5ea836cb84f1bb2527d8286, $v628b7db04235f228d40adc671413a8c8, $v84cdc76cabf41bd7c961f6ab12f117d8);$v8be74552df93e31bbdd6b36ed74bdb6a->addPropertyFilterBetween($vd0d5ad0219c6bb59a29b5027add37795, $vbb76e2549b666f1d2982782d9477fcd3, $v453242be35ea9152a4210e5c706e4ffb);}elseif (!empty($v7436f942d5ea836cb84f1bb2527d8286) && !empty($v84cdc76cabf41bd7c961f6ab12f117d8)) {$vbb76e2549b666f1d2982782d9477fcd3 = mktime(0, 0, 0, $v7436f942d5ea836cb84f1bb2527d8286, 1, $v84cdc76cabf41bd7c961f6ab12f117d8);$v453242be35ea9152a4210e5c706e4ffb = mktime(23, 59, 59, $v7436f942d5ea836cb84f1bb2527d8286+1, 0, $v84cdc76cabf41bd7c961f6ab12f117d8);$v8be74552df93e31bbdd6b36ed74bdb6a->addPropertyFilterBetween($vd0d5ad0219c6bb59a29b5027add37795, $vbb76e2549b666f1d2982782d9477fcd3, $v453242be35ea9152a4210e5c706e4ffb);}elseif( !empty($v84cdc76cabf41bd7c961f6ab12f117d8)) {$vbb76e2549b666f1d2982782d9477fcd3 = mktime(0, 0, 0, 1, 1, $v84cdc76cabf41bd7c961f6ab12f117d8);$v453242be35ea9152a4210e5c706e4ffb = mktime(23, 59, 59, 12, 0, $v84cdc76cabf41bd7c961f6ab12f117d8);$v8be74552df93e31bbdd6b36ed74bdb6a->addPropertyFilterBetween($vd0d5ad0219c6bb59a29b5027add37795, $vbb76e2549b666f1d2982782d9477fcd3, $v453242be35ea9152a4210e5c706e4ffb);}elseif ($vc56bb2f8387a1bd1f57450dd23abb3e8 !== $va5e54dcdab702358cd07f9db87043cd6) {if($vc56bb2f8387a1bd1f57450dd23abb3e8 != false && $va5e54dcdab702358cd07f9db87043cd6 != false) {if($v5b3e5a12bbd31d7e787635bc124dc396 && $v5b3e5a12bbd31d7e787635bc124dc396 != '+ -') {if ($vc56bb2f8387a1bd1f57450dd23abb3e8 < $va5e54dcdab702358cd07f9db87043cd6) {$v8be74552df93e31bbdd6b36ed74bdb6a->addPropertyFilterBetween($vd0d5ad0219c6bb59a29b5027add37795, $vc56bb2f8387a1bd1f57450dd23abb3e8, $va5e54dcdab702358cd07f9db87043cd6);}else {$v8be74552df93e31bbdd6b36ed74bdb6a->addPropertyFilterBetween($vd0d5ad0219c6bb59a29b5027add37795, $va5e54dcdab702358cd07f9db87043cd6, $vc56bb2f8387a1bd1f57450dd23abb3e8);}}}}if($v87306dd4235ed712ebc07fe169b76f83) {$this->autoDetectOrders($v8be74552df93e31bbdd6b36ed74bdb6a, $v87306dd4235ed712ebc07fe169b76f83);$this->autoDetectFilters($v8be74552df93e31bbdd6b36ed74bdb6a, $v87306dd4235ed712ebc07fe169b76f83);}$v8be74552df93e31bbdd6b36ed74bdb6a->addLimit($v9d85c254b5062e518a134a61950999c3, $ve1ba980ce14a8c0d7e2779f895ab8695);$result = umiSelectionsParser::runSelection($v8be74552df93e31bbdd6b36ed74bdb6a);$vfbb44b4487415b134bce9c790a27fe5e = umiSelectionsParser::runSelectionCounts($v8be74552df93e31bbdd6b36ed74bdb6a);if(($v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($result)) > 0) {$vfca1bff8ad8b3a8585abfb0ad523ba42 = Array();$v980da98409d058c365664ff7ea33dd6b = Array();for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v69ba0c89abba8a3e9cc0c5e32be0d35d = Array();$v7057e8409c7c531a1a6e9ac3df4ed549 = $result[$v865c0c0b4ab0e063e5caa3387c1a8741];$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);if(!$v8e2dcfd7e7e24b1ca76c1193f645902b) continue;$v69ba0c89abba8a3e9cc0c5e32be0d35d['attribute:id'] = $v7057e8409c7c531a1a6e9ac3df4ed549;$v69ba0c89abba8a3e9cc0c5e32be0d35d['node:name'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getName();$v69ba0c89abba8a3e9cc0c5e32be0d35d['attribute:link'] = umiHierarchy::getInstance()->getPathById($v7057e8409c7c531a1a6e9ac3df4ed549);$v69ba0c89abba8a3e9cc0c5e32be0d35d['xlink:href'] = "upage://" . $v7057e8409c7c531a1a6e9ac3df4ed549;$v69ba0c89abba8a3e9cc0c5e32be0d35d['void:header'] = $v058ea00715de566bfe7b13f8e17aaf15['name'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getName();if($v0faea619a3eb6dfca4ced9bbe5bf4c9a = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue('publish_time')) {$v69ba0c89abba8a3e9cc0c5e32be0d35d['attribute:publish_time'] = $v0faea619a3eb6dfca4ced9bbe5bf4c9a->getFormattedDate("U");}$v6fabf75517b5101eb528b7998297505f = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();if($v5d1ca5f343bb81e1e9857b241e1e136b = umiHierarchy::getInstance()->getElement($v6fabf75517b5101eb528b7998297505f)) {$vc8772a52fd9f99858a251a5ab983118f = $v5d1ca5f343bb81e1e9857b241e1e136b->getName();$v9b1022b0cbbd3965a1562542f4b4d9ea = umiHierarchy::getInstance()->getPathById($v6fabf75517b5101eb528b7998297505f);}else {$vc8772a52fd9f99858a251a5ab983118f = "";$v9b1022b0cbbd3965a1562542f4b4d9ea = "";}$v69ba0c89abba8a3e9cc0c5e32be0d35d['attribute:lent_id'] = $v6fabf75517b5101eb528b7998297505f;$v69ba0c89abba8a3e9cc0c5e32be0d35d['attribute:lent_name'] = $vc8772a52fd9f99858a251a5ab983118f;$v69ba0c89abba8a3e9cc0c5e32be0d35d['attribute:lent_link'] = $v9b1022b0cbbd3965a1562542f4b4d9ea;$v980da98409d058c365664ff7ea33dd6b[] = self::parseTemplate($vb1c0ed8b2e25638833f73a19e1954309, $v69ba0c89abba8a3e9cc0c5e32be0d35d, $v7057e8409c7c531a1a6e9ac3df4ed549);templater::pushEditable("news", "item", $v7057e8409c7c531a1a6e9ac3df4ed549);umiHierarchy::getInstance()->unloadElement($v7057e8409c7c531a1a6e9ac3df4ed549);}if(is_array($v6be379826b20cc58475f636e33f4606b)) {list($v6be379826b20cc58475f636e33f4606b) = $v6be379826b20cc58475f636e33f4606b;}$vfca1bff8ad8b3a8585abfb0ad523ba42['subnodes:items'] = $vfca1bff8ad8b3a8585abfb0ad523ba42['void:lines'] = $v980da98409d058c365664ff7ea33dd6b;$vfca1bff8ad8b3a8585abfb0ad523ba42['archive'] = ($vfbb44b4487415b134bce9c790a27fe5e > ($v865c0c0b4ab0e063e5caa3387c1a8741)) ? $vedfb9a557bf6b2ab56513172657f1aea : "";$vfca1bff8ad8b3a8585abfb0ad523ba42['archive_link'] = umiHierarchy::getInstance()->getPathById($v6be379826b20cc58475f636e33f4606b);$vfca1bff8ad8b3a8585abfb0ad523ba42['total'] = $vfbb44b4487415b134bce9c790a27fe5e;$vfca1bff8ad8b3a8585abfb0ad523ba42['per_page'] = $v9d85c254b5062e518a134a61950999c3;$vfca1bff8ad8b3a8585abfb0ad523ba42['category_id'] = $v6be379826b20cc58475f636e33f4606b;return self::parseTemplate($v364f9b183bd2dd9e0beb45c754830a6c, $vfca1bff8ad8b3a8585abfb0ad523ba42, $v6be379826b20cc58475f636e33f4606b);}else {return $v28d65bb7a643774ada22f54ca0679289;}}public function rubric($vd6fe1d0be6347b8ef2427fa629c04485 = "", $v66f6181bcb4cff4cd38fbc804a036db6 = "default") {if($this->breakMe()) return;$v7057e8409c7c531a1a6e9ac3df4ed549 = cmsController::getInstance()->getCurrentElementId();templater::pushEditable("news", "rubric", $v7057e8409c7c531a1a6e9ac3df4ed549);return $this->lastlents($v7057e8409c7c531a1a6e9ac3df4ed549, $v66f6181bcb4cff4cd38fbc804a036db6) . $this->lastlist($v7057e8409c7c531a1a6e9ac3df4ed549, $v66f6181bcb4cff4cd38fbc804a036db6);}public function view($v4a20784bb5bad10b0f5c941a900f0c04 = "", $v66f6181bcb4cff4cd38fbc804a036db6 = "default") {if($this->breakMe()) return;$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();list($v364f9b183bd2dd9e0beb45c754830a6c) = def_module::loadTemplates("tpls/news/{$v66f6181bcb4cff4cd38fbc804a036db6}.tpl", "view");$v7552cd149af7495ee7d8225974e50f80 = $this->analyzeRequiredPath($v4a20784bb5bad10b0f5c941a900f0c04);if($v7552cd149af7495ee7d8225974e50f80 === false) {throw new publicException(getLabel('error-page-does-not-exist', null, $v4a20784bb5bad10b0f5c941a900f0c04));}$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement == false) {throw new publicException(getLabel('error-page-does-not-exist', null, $v4a20784bb5bad10b0f5c941a900f0c04));}templater::pushEditable("news", "item", $v8e2dcfd7e7e24b1ca76c1193f645902b->id);return self::parseTemplate($v364f9b183bd2dd9e0beb45c754830a6c, array(   'id' => $v8e2dcfd7e7e24b1ca76c1193f645902b->id  ), $v8e2dcfd7e7e24b1ca76c1193f645902b->id);}public function related_links($v4a20784bb5bad10b0f5c941a900f0c04 = false, $v66f6181bcb4cff4cd38fbc804a036db6 = "default", $vaa9f73eea60a006820d0f8768bc8a3fc = 3) {if($this->breakMe()) return;list($v364f9b183bd2dd9e0beb45c754830a6c, $v28d65bb7a643774ada22f54ca0679289, $vb1c0ed8b2e25638833f73a19e1954309) = def_module::loadTemplates("tpls/news/{$v66f6181bcb4cff4cd38fbc804a036db6}.tpl", "related_block", "related_block_empty", "related_line");$v7057e8409c7c531a1a6e9ac3df4ed549 = $this->analyzeRequiredPath($v4a20784bb5bad10b0f5c941a900f0c04);if($v7057e8409c7c531a1a6e9ac3df4ed549 === false) {throw new publicException(getLabel('error-page-does-not-exist', null, $v4a20784bb5bad10b0f5c941a900f0c04));}$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);if(!$v8e2dcfd7e7e24b1ca76c1193f645902b) return $v28d65bb7a643774ada22f54ca0679289;$vfffc742f2235d2af7f71d6117d1cf2fc = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue("subjects");$v0715f6d9497f93911417c9c324265771 = umiHierarchyTypesCollection::getInstance()->getTypeByName("news", "item")->getId();if(sizeof($vfffc742f2235d2af7f71d6117d1cf2fc)) {$v8be74552df93e31bbdd6b36ed74bdb6a = new umiSelection;$v8be74552df93e31bbdd6b36ed74bdb6a->addElementType($v0715f6d9497f93911417c9c324265771);$v1f6a133be1246df5291f4e1719c08e89 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getFieldId('subjects');$v8be74552df93e31bbdd6b36ed74bdb6a->addPropertyFilterEqual($v1f6a133be1246df5291f4e1719c08e89, $vfffc742f2235d2af7f71d6117d1cf2fc);$v8be74552df93e31bbdd6b36ed74bdb6a->setOrderByProperty($v8e2dcfd7e7e24b1ca76c1193f645902b->getFieldId('publish_time'), false);$v8be74552df93e31bbdd6b36ed74bdb6a->addPermissions();$v8be74552df93e31bbdd6b36ed74bdb6a->addLimit($vaa9f73eea60a006820d0f8768bc8a3fc + 1);$result = umiSelectionsParser::runSelection($v8be74552df93e31bbdd6b36ed74bdb6a);}else {$result = Array();}if(($v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($result)) > 0) {$vfca1bff8ad8b3a8585abfb0ad523ba42 = Array();$v980da98409d058c365664ff7ea33dd6b = Array();$v7dabf5c198b0bab2eaa42bb03a113e55--;for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v69ba0c89abba8a3e9cc0c5e32be0d35d = Array();$v13fba93b98196f2395dec474c9ba27e5 = $result[$v865c0c0b4ab0e063e5caa3387c1a8741];if($v13fba93b98196f2395dec474c9ba27e5 == $v7057e8409c7c531a1a6e9ac3df4ed549) {$v7dabf5c198b0bab2eaa42bb03a113e55++;continue;}$vd20f9dc7a7cbd9a54a7884c3df4a870a = umiHierarchy::getInstance()->getElement($v13fba93b98196f2395dec474c9ba27e5);$v69ba0c89abba8a3e9cc0c5e32be0d35d['attribute:id'] = $v13fba93b98196f2395dec474c9ba27e5;$v69ba0c89abba8a3e9cc0c5e32be0d35d['attribute:link'] = umiHierarchy::getInstance()->getPathById($v13fba93b98196f2395dec474c9ba27e5);$v69ba0c89abba8a3e9cc0c5e32be0d35d['xlink:href'] = "upage://" . $v13fba93b98196f2395dec474c9ba27e5;$v69ba0c89abba8a3e9cc0c5e32be0d35d['node:name'] = $vd20f9dc7a7cbd9a54a7884c3df4a870a->getName();$v980da98409d058c365664ff7ea33dd6b[] = self::parseTemplate($vb1c0ed8b2e25638833f73a19e1954309, $v69ba0c89abba8a3e9cc0c5e32be0d35d, $v13fba93b98196f2395dec474c9ba27e5);}if(!$v980da98409d058c365664ff7ea33dd6b) {return "";}$vfca1bff8ad8b3a8585abfb0ad523ba42['subnodes:items'] = $vfca1bff8ad8b3a8585abfb0ad523ba42['void:lines'] = $vfca1bff8ad8b3a8585abfb0ad523ba42['void:related_links'] = $v980da98409d058c365664ff7ea33dd6b;return self::parseTemplate($v364f9b183bd2dd9e0beb45c754830a6c, $vfca1bff8ad8b3a8585abfb0ad523ba42);}else {return $v28d65bb7a643774ada22f54ca0679289;}}public function config() {return __news::config();}private function checkPath($vd6fe1d0be6347b8ef2427fa629c04485) {if(is_numeric($vd6fe1d0be6347b8ef2427fa629c04485)) {return (umiHierarchy::getInstance()->isExists((int) $vd6fe1d0be6347b8ef2427fa629c04485)) ? (int) $vd6fe1d0be6347b8ef2427fa629c04485 : false;}else {if(trim($vd6fe1d0be6347b8ef2427fa629c04485)) {$vd5d4bb9b2c282937ee64b1fb0495ef08 = umiHierarchy::getInstance()->getIdByPath($vd6fe1d0be6347b8ef2427fa629c04485);return ($vd5d4bb9b2c282937ee64b1fb0495ef08 !== false) ? $vd5d4bb9b2c282937ee64b1fb0495ef08 : false;}else {return false;}}}public function item() {if($this->breakMe()) return;$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) cmsController::getInstance()->getCurrentElementId();return $this->view($v7057e8409c7c531a1a6e9ac3df4ed549);}public function listlents($v7057e8409c7c531a1a6e9ac3df4ed549, $v66f6181bcb4cff4cd38fbc804a036db6 = "default", $v9d85c254b5062e518a134a61950999c3 = false, $v126424c808da347218ba631a78feaf04 = false) {if($this->breakMe()) return;return $this->lastlents($v7057e8409c7c531a1a6e9ac3df4ed549, $v66f6181bcb4cff4cd38fbc804a036db6, $v9d85c254b5062e518a134a61950999c3, $v126424c808da347218ba631a78feaf04);}public function lastlents($v4a20784bb5bad10b0f5c941a900f0c04, $v66f6181bcb4cff4cd38fbc804a036db6 = "default", $v9d85c254b5062e518a134a61950999c3 = false, $v126424c808da347218ba631a78feaf04 = false) {if($this->breakMe()) return;if(!$v9d85c254b5062e518a134a61950999c3) $v9d85c254b5062e518a134a61950999c3 = $this->per_page;list($v364f9b183bd2dd9e0beb45c754830a6c, $v28d65bb7a643774ada22f54ca0679289, $vb1c0ed8b2e25638833f73a19e1954309, $vedfb9a557bf6b2ab56513172657f1aea) = def_module::loadTemplates("tpls/news/{$v66f6181bcb4cff4cd38fbc804a036db6}.tpl", "listlents_block", "listlents_block_empty", "listlents_item", "listlents_archive");$ve1ba980ce14a8c0d7e2779f895ab8695 = (int) getRequest('p');if($v126424c808da347218ba631a78feaf04) {$ve1ba980ce14a8c0d7e2779f895ab8695 = 0;}$v6be379826b20cc58475f636e33f4606b = $this->analyzeRequiredPath($v4a20784bb5bad10b0f5c941a900f0c04);if($v6be379826b20cc58475f636e33f4606b === false) {throw new publicException(getLabel('error-page-does-not-exist', null, $v4a20784bb5bad10b0f5c941a900f0c04));}$v0715f6d9497f93911417c9c324265771 = umiHierarchyTypesCollection::getInstance()->getTypeByName("news", "rubric")->getId();$v8be74552df93e31bbdd6b36ed74bdb6a = new umiSelection;$v8be74552df93e31bbdd6b36ed74bdb6a->addElementType($v0715f6d9497f93911417c9c324265771);$v8be74552df93e31bbdd6b36ed74bdb6a->addHierarchyFilter($v6be379826b20cc58475f636e33f4606b, 0, true);$v8be74552df93e31bbdd6b36ed74bdb6a->addPermissions();$v8be74552df93e31bbdd6b36ed74bdb6a->addLimit($v9d85c254b5062e518a134a61950999c3, $ve1ba980ce14a8c0d7e2779f895ab8695);$result = umiSelectionsParser::runSelection($v8be74552df93e31bbdd6b36ed74bdb6a);$vfbb44b4487415b134bce9c790a27fe5e = umiSelectionsParser::runSelectionCounts($v8be74552df93e31bbdd6b36ed74bdb6a);if(($v7dabf5c198b0bab2eaa42bb03a113e55 = sizeof($result)) > 0) {$vfca1bff8ad8b3a8585abfb0ad523ba42 = Array();$v980da98409d058c365664ff7ea33dd6b = Array();for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < $v7dabf5c198b0bab2eaa42bb03a113e55;$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v69ba0c89abba8a3e9cc0c5e32be0d35d = Array();$v7057e8409c7c531a1a6e9ac3df4ed549 = $result[$v865c0c0b4ab0e063e5caa3387c1a8741];$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);$v69ba0c89abba8a3e9cc0c5e32be0d35d['attribute:id'] = $v7057e8409c7c531a1a6e9ac3df4ed549;$v69ba0c89abba8a3e9cc0c5e32be0d35d['attribute:link'] = umiHierarchy::getInstance()->getPathById($v7057e8409c7c531a1a6e9ac3df4ed549);$v69ba0c89abba8a3e9cc0c5e32be0d35d['xlink:href'] = "upage://" . $v7057e8409c7c531a1a6e9ac3df4ed549;$v69ba0c89abba8a3e9cc0c5e32be0d35d['void:header'] = $v058ea00715de566bfe7b13f8e17aaf15['name'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getName();$v69ba0c89abba8a3e9cc0c5e32be0d35d['node:name'] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getName();$v980da98409d058c365664ff7ea33dd6b[] = self::parseTemplate($vb1c0ed8b2e25638833f73a19e1954309, $v69ba0c89abba8a3e9cc0c5e32be0d35d, $v7057e8409c7c531a1a6e9ac3df4ed549);templater::pushEditable("news", "rubric", $v7057e8409c7c531a1a6e9ac3df4ed549);}if(is_array($v6be379826b20cc58475f636e33f4606b)) {list($v6be379826b20cc58475f636e33f4606b) = $v6be379826b20cc58475f636e33f4606b;}$vfca1bff8ad8b3a8585abfb0ad523ba42['subnodes:items'] = $vfca1bff8ad8b3a8585abfb0ad523ba42['void:lines'] = $v980da98409d058c365664ff7ea33dd6b;$vfca1bff8ad8b3a8585abfb0ad523ba42['total'] = $vfbb44b4487415b134bce9c790a27fe5e;$vfca1bff8ad8b3a8585abfb0ad523ba42['per_page'] = $v9d85c254b5062e518a134a61950999c3;return self::parseTemplate($v364f9b183bd2dd9e0beb45c754830a6c, $vfca1bff8ad8b3a8585abfb0ad523ba42, $v6be379826b20cc58475f636e33f4606b);}else {return $v28d65bb7a643774ada22f54ca0679289;}}public function addNewsItem() {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v6942e8fa62b3cc9d93881a58210e2fd7 = umiHierarchyTypesCollection::getInstance();$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v6be379826b20cc58475f636e33f4606b = (int) getRequest('param0');$v87306dd4235ed712ebc07fe169b76f83 = (int) getRequest('param1');$vd5d3db1765287eef77d7927cc956f50a = htmlspecialchars(trim(getRequest('title')));$va4f09cfeea7392a1f6df6a3de5c3bc9e = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v6be379826b20cc58475f636e33f4606b);$vd02e12eb6d6c3f6ebd763197df01e211  = $va4f09cfeea7392a1f6df6a3de5c3bc9e->getTplId();$v662cbf1253ac7d8750ed9190c52163e5 = $va4f09cfeea7392a1f6df6a3de5c3bc9e->getDomainId();$v78e6dd7a49f5b0cb2106a3a434dd5c86 = $va4f09cfeea7392a1f6df6a3de5c3bc9e->getLangId();$v0715f6d9497f93911417c9c324265771 = $v6942e8fa62b3cc9d93881a58210e2fd7->getTypeByName("news", "item")->getId();if(!$v87306dd4235ed712ebc07fe169b76f83) {$v87306dd4235ed712ebc07fe169b76f83 = $v0e8133eb006c0f85ed9444ae07a60842->getBaseType("news", "item");}$v7ae7003da59ae71dcc9f8638ef50593d = $v0e8133eb006c0f85ed9444ae07a60842->getType($v87306dd4235ed712ebc07fe169b76f83);if($v7ae7003da59ae71dcc9f8638ef50593d->getHierarchyTypeId() != $v0715f6d9497f93911417c9c324265771) {$this->errorNewMessage("Object type and hierarchy type doesn't match");$this->errorPanic();}$v7057e8409c7c531a1a6e9ac3df4ed549 = $vb81ca7c0ccaa77e7aa91936ab0070695->addElement($v6be379826b20cc58475f636e33f4606b, $v0715f6d9497f93911417c9c324265771, $vd5d3db1765287eef77d7927cc956f50a, $vd5d3db1765287eef77d7927cc956f50a, $v87306dd4235ed712ebc07fe169b76f83, $v662cbf1253ac7d8750ed9190c52163e5, $v78e6dd7a49f5b0cb2106a3a434dd5c86, $vd02e12eb6d6c3f6ebd763197df01e211);$v9bc65c2abec141778ffaa729489f3e87 = $v8b1dc169bf460ee884fceef66c6607d6->getModule("users");if($v9bc65c2abec141778ffaa729489f3e87 instanceof def_module) {$v9bc65c2abec141778ffaa729489f3e87->setDefaultPermissions($v7057e8409c7c531a1a6e9ac3df4ed549);}$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7057e8409c7c531a1a6e9ac3df4ed549, true);$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsActive(true);$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsVisible(false);$v8e2dcfd7e7e24b1ca76c1193f645902b->setName($vd5d3db1765287eef77d7927cc956f50a);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$va4f09cfeea7392a1f6df6a3de5c3bc9e->setUpdateTime(time());$va4f09cfeea7392a1f6df6a3de5c3bc9e->commit();if($v71d83896a0226ab60dc2cc43905c1a92) {return Array("node:result" => "ok");}else {$this->redirect($v12b29cd4a546ab7c02774080f819f7dc);}}public function getEditLink($v7057e8409c7c531a1a6e9ac3df4ed549, $vb8910fa4dc8f637c214b8e9094ef35b9) {$v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);$v6be379826b20cc58475f636e33f4606b = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();switch($vb8910fa4dc8f637c214b8e9094ef35b9) {case "rubric": {$v20d49e744b40132da5f81045b5d6ec25 = $this->pre_lang . "/admin/news/add/{$v7057e8409c7c531a1a6e9ac3df4ed549}/item/";$v441c674b4099be68caf8fb0f7ff47e3e = $this->pre_lang . "/admin/news/edit/{$v7057e8409c7c531a1a6e9ac3df4ed549}/";return Array($v20d49e744b40132da5f81045b5d6ec25, $v441c674b4099be68caf8fb0f7ff47e3e);break;}case "item": {$v441c674b4099be68caf8fb0f7ff47e3e = $this->pre_lang . "/admin/news/edit/{$v7057e8409c7c531a1a6e9ac3df4ed549}/";return Array(false, $v441c674b4099be68caf8fb0f7ff47e3e);break;}default: {return false;}}}};?>

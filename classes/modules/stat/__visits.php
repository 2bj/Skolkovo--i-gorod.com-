<?php
abstract class __stat_visits extends baseModuleAdmin {public function visits_hits() {$this->updateFilter();$v3086f2e00ea19967e011c652edfc2884 = getRequest('param0');$ve1ba980ce14a8c0d7e2779f895ab8695 = (int) getRequest('p');$v7982b1e077e535e00dc62cf8d6e9a455 = cmsController::getInstance()->getCurrentDomain()->getHost();$v23a2cbb13502e40ff869bbfa3211fc9b = cmsController::getInstance()->getCurrentLang()->getPrefix();$v5430f956c571aa9e86e91947b5da11a2 = '/'.$v23a2cbb13502e40ff869bbfa3211fc9b.'/admin/stat/'.__FUNCTION__;$v4062f8ff37e55691af3f19fac2155cf9 = '';$v9549dd6065d019211460c59a86dd6536 = new statisticFactory(dirname(__FILE__) . '/classes');if ($v3086f2e00ea19967e011c652edfc2884 === 'xml') {}elseif ($v3086f2e00ea19967e011c652edfc2884 === 'xml1') {$v9549dd6065d019211460c59a86dd6536->isValid('visitCommon');$ve98d2f001da5678b39482efbdf5770dc = $v9549dd6065d019211460c59a86dd6536->get('visitCommon');$ve98d2f001da5678b39482efbdf5770dc->setStart($this->from_time);$ve98d2f001da5678b39482efbdf5770dc->setFinish($this->to_time);$ve98d2f001da5678b39482efbdf5770dc->setDomain($this->domain);$ve98d2f001da5678b39482efbdf5770dc->setUser($this->user);$result = $ve98d2f001da5678b39482efbdf5770dc->get();$v03f1bcf4bdfde045733bb97482344c55 = 0;$v58048d5700b450e117e35a9c095fa5cb = $result['summ'];$v233762765fbf2a8381bb11dac5c21b8f = $result['total'];$va985177e18afdab154ab615657ef1514 = "";$va985177e18afdab154ab615657ef1514 .= "<"."?xml version=\"1.0\" encoding=\"utf-8\"?".">\n";$va985177e18afdab154ab615657ef1514 .= <<<END
                <statistics> 
                 <report name="visitCommon" title="Динамика хитов по дням" host="{$v7982b1e077e535e00dc62cf8d6e9a455}" lang="{$v23a2cbb13502e40ff869bbfa3211fc9b}"  timerange_start="{$this->from_time}" timerange_finish="{$this->to_time}">
                <table>
                    <column field="timestamp" title="День" showas="date" valueSuffix="" prefix="" />
                    <column field="count"    title="Хитов (абсолютное значение)" valueSuffix="" prefix="" />
                    <column field="rel"      title="Хитов (относительное значение)" valueSuffix="%" prefix="" />
                </table>
                <chart type="column" drawTrendLine="true">
                    <argument field="timestamp" />
                    <value field="count" description="Количество хитов" axisTitle="Количество хитов" />
                    <caption field="date" />
                </chart>
                <data>\n
END;                $vfd2fac4b54a807d1a4826928fcf501fc = $this->from_time;foreach($result['detail']['result'] as $vcaf9b6b99962bf5c2264824231d7a40c) {if(!isset($vcaf9b6b99962bf5c2264824231d7a40c['ts'])) {$vcaf9b6b99962bf5c2264824231d7a40c['ts'] = NULL;}$ve567105b879e132a1e0f4b73c9701373 = date('d M', $vcaf9b6b99962bf5c2264824231d7a40c['ts']);while( ($vfd2fac4b54a807d1a4826928fcf501fc < $vcaf9b6b99962bf5c2264824231d7a40c['ts']) &&                            (date('d M', $vfd2fac4b54a807d1a4826928fcf501fc) != $ve567105b879e132a1e0f4b73c9701373) ) {$v7a1d7ac941d4e2c056bc94857e0d2575   = htmlspecialchars( '' );$va985177e18afdab154ab615657ef1514 .= "<row ".                                    "timestamp=\"".$vfd2fac4b54a807d1a4826928fcf501fc."\" ".                                    "count=\"0\" ".                                    "date=\"".__stat_admin::makeDate('d M', $vfd2fac4b54a807d1a4826928fcf501fc)."\" ".                                    "uri=\"".$v7a1d7ac941d4e2c056bc94857e0d2575."\" rel=\"0\" />\n";$vfd2fac4b54a807d1a4826928fcf501fc += 86400;}$vfd2fac4b54a807d1a4826928fcf501fc = $vcaf9b6b99962bf5c2264824231d7a40c['ts'] + 86400;$v02f23ea9e3029ddaa616ddb1af52ada9 = (isset($vcaf9b6b99962bf5c2264824231d7a40c['cnt'])) ? $vcaf9b6b99962bf5c2264824231d7a40c['cnt'] : 0;$v03f1bcf4bdfde045733bb97482344c55 += $v02f23ea9e3029ddaa616ddb1af52ada9;$v9c502c0ace8194273cfb602536cdfa44 = '';$ve334be05f2d25b295e8542a58661ed67= htmlspecialchars($v9c502c0ace8194273cfb602536cdfa44);$va985177e18afdab154ab615657ef1514 .= "<row ";$v6ce4e6be1d85a1e200672196c9411bfd = '';$v6ce4e6be1d85a1e200672196c9411bfd .= 'timestamp="'.$vcaf9b6b99962bf5c2264824231d7a40c['ts'].'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'count="'.$v02f23ea9e3029ddaa616ddb1af52ada9.'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'date="'.__stat_admin::makeDate('d M', $vcaf9b6b99962bf5c2264824231d7a40c['ts']).'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'uri="'.$ve334be05f2d25b295e8542a58661ed67.'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'rel="'.round($v02f23ea9e3029ddaa616ddb1af52ada9/($v58048d5700b450e117e35a9c095fa5cb/100), 1).'" ';$va985177e18afdab154ab615657ef1514 .= $v6ce4e6be1d85a1e200672196c9411bfd;$va985177e18afdab154ab615657ef1514 .= "/>\n";}$ve567105b879e132a1e0f4b73c9701373 = date('d M', $this->to_time+86400);while( ($vfd2fac4b54a807d1a4826928fcf501fc < $this->to_time+86400) &&                        (date('d M', $vfd2fac4b54a807d1a4826928fcf501fc) != $ve567105b879e132a1e0f4b73c9701373) ) {$v7a1d7ac941d4e2c056bc94857e0d2575   = htmlspecialchars( '' );$va985177e18afdab154ab615657ef1514 .= "<row ".                                "timestamp=\"".$vfd2fac4b54a807d1a4826928fcf501fc."\" ".                                "count=\"0\" ".                                "date=\"".__stat_admin::makeDate('d M', $vfd2fac4b54a807d1a4826928fcf501fc)."\" ".                                "uri=\"".$v7a1d7ac941d4e2c056bc94857e0d2575."\" rel=\"0\" />\n";$vfd2fac4b54a807d1a4826928fcf501fc += 86400;}$vbbc1d718fe0a068b8d46f0b73cc73264 = ($v58048d5700b450e117e35a9c095fa5cb - $v03f1bcf4bdfde045733bb97482344c55);$va985177e18afdab154ab615657ef1514 .= "</data>\n";$va985177e18afdab154ab615657ef1514 .= "</report>\n</statistics>";header("Content-type: text/xml; charset=utf-8");header("Content-length: ".strlen($va985177e18afdab154ab615657ef1514));$this->flush($va985177e18afdab154ab615657ef1514);return "";}elseif ($v3086f2e00ea19967e011c652edfc2884 === 'xml2') {$v9549dd6065d019211460c59a86dd6536->isValid('visitCommonHours');$ve98d2f001da5678b39482efbdf5770dc = $v9549dd6065d019211460c59a86dd6536->get('visitCommonHours');$ve98d2f001da5678b39482efbdf5770dc->setStart($this->from_time);$ve98d2f001da5678b39482efbdf5770dc->setFinish($this->to_time);$ve98d2f001da5678b39482efbdf5770dc->setDomain($this->domain);$ve98d2f001da5678b39482efbdf5770dc->setUser($this->user);$result = $ve98d2f001da5678b39482efbdf5770dc->get();$v03f1bcf4bdfde045733bb97482344c55 = 0;$v58048d5700b450e117e35a9c095fa5cb = $result['summ']?$result['summ']:1;$v233762765fbf2a8381bb11dac5c21b8f = $result['total'];$va985177e18afdab154ab615657ef1514 = "";$va985177e18afdab154ab615657ef1514 .= "<"."?xml version=\"1.0\" encoding=\"utf-8\"?".">\n";$va985177e18afdab154ab615657ef1514 .= <<<END
                <statistics>
                <report name="visitCommonHours" title="Распеределение хитов по часам суток" host="{$v7982b1e077e535e00dc62cf8d6e9a455}" lang="{$v23a2cbb13502e40ff869bbfa3211fc9b}"  timerange_start="{$this->from_time}" timerange_finish="{$this->to_time}">
                <table>
                    <column field="hourint"  title="Часы" valueSuffix="" prefix="" />
                    <column field="count" title="Хитов (абсолютное значение)" valueSuffix="" prefix="" />
                    <column field="rel"   title="Хитов (относительное значение)" valueSuffix="%" prefix="" />
                </table>
                <chart type="line" drawTrendLine="true">
                    <argument field="hour" />
                    <value field="count" description="Количество хитов" axisTitle="Количество хитов" />
                    <caption field="hourint" />
                </chart>
                <data>\n
END;                $v3100aba9f221cdf6a03d155d6a84fd53 = 0;for ($v3100aba9f221cdf6a03d155d6a84fd53 = 0;$v3100aba9f221cdf6a03d155d6a84fd53 < 24;$v3100aba9f221cdf6a03d155d6a84fd53++) {if (isset($result['detail'][$v3100aba9f221cdf6a03d155d6a84fd53])) {$vcaf9b6b99962bf5c2264824231d7a40c = $result['detail'][$v3100aba9f221cdf6a03d155d6a84fd53];}else {$vcaf9b6b99962bf5c2264824231d7a40c = array('ts'=>mktime($v3100aba9f221cdf6a03d155d6a84fd53), 'cnt'=>0);}$v02f23ea9e3029ddaa616ddb1af52ada9 = $vcaf9b6b99962bf5c2264824231d7a40c['cnt'];$v03f1bcf4bdfde045733bb97482344c55 += $v02f23ea9e3029ddaa616ddb1af52ada9;$v9c502c0ace8194273cfb602536cdfa44 = '';$v2ada3901b0b903d16e5c1b78f4228d68 = intval(date('G', $vcaf9b6b99962bf5c2264824231d7a40c['ts']));$vb73b19f3754a0e0b3972c787ac204174 = $v2ada3901b0b903d16e5c1b78f4228d68."..".($v2ada3901b0b903d16e5c1b78f4228d68+1);$vc897060c947591dbd734ea2283a203b7 = htmlspecialchars($vb73b19f3754a0e0b3972c787ac204174);$ve334be05f2d25b295e8542a58661ed67= htmlspecialchars($v9c502c0ace8194273cfb602536cdfa44);$va985177e18afdab154ab615657ef1514 .= "<row ";$v6ce4e6be1d85a1e200672196c9411bfd = '';$v6ce4e6be1d85a1e200672196c9411bfd .= 'count="'.$v02f23ea9e3029ddaa616ddb1af52ada9.'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'hourint="'.$vc897060c947591dbd734ea2283a203b7.'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'uri="'.$ve334be05f2d25b295e8542a58661ed67.'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'timestamp="'.$vcaf9b6b99962bf5c2264824231d7a40c['ts'].'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'rel="'.round($v02f23ea9e3029ddaa616ddb1af52ada9/($v58048d5700b450e117e35a9c095fa5cb/100), 1).'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'hour="'.$v2ada3901b0b903d16e5c1b78f4228d68.'" ';$va985177e18afdab154ab615657ef1514 .= $v6ce4e6be1d85a1e200672196c9411bfd;$va985177e18afdab154ab615657ef1514 .= "/>\n";}$vbbc1d718fe0a068b8d46f0b73cc73264 = ($v58048d5700b450e117e35a9c095fa5cb - $v03f1bcf4bdfde045733bb97482344c55);$va985177e18afdab154ab615657ef1514 .= "</data>\n";$va985177e18afdab154ab615657ef1514 .= "</report>\n</statistics>";header("Content-type: text/xml; charset=utf-8");header("Content-length: ".strlen($va985177e18afdab154ab615657ef1514));$this->flush($va985177e18afdab154ab615657ef1514);return "";}else {$v21ffce5b8a6cc8cc6a41448dd69623c9 = array();$v21ffce5b8a6cc8cc6a41448dd69623c9['filter'] = $this->getFilterPanel();$v21ffce5b8a6cc8cc6a41448dd69623c9['ReportHitsByDays']['flash:report1']  = "url=".$v5430f956c571aa9e86e91947b5da11a2."/xml1/".$v4062f8ff37e55691af3f19fac2155cf9;$v21ffce5b8a6cc8cc6a41448dd69623c9['ReportHitsByHours']['flash:report2'] = "url=".$v5430f956c571aa9e86e91947b5da11a2."/xml2/".$v4062f8ff37e55691af3f19fac2155cf9;$this->setDataType("settings");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v21ffce5b8a6cc8cc6a41448dd69623c9, 'settings');$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}}public function visits_visitors() {return $this->auditory();}public function visits_sessions() {return $this->visitors();}public function visits() {return $this->visits_hits();}public function visitsByDate() {return "under construction";}}?>
<?php
abstract class __import {public function import_old_blogs() {$v1723bdd4ee51910267a625cae41ced8a = umiHierarchyTypesCollection::getInstance();$vb3827f7111095f5ba1a9f49988fe9382     = umiObjectTypesCollection::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695  = umiHierarchy::getInstance();$v5891da2d64975cae48d175d1e001f5da    = umiObjectsCollection::getInstance();$v93c8b11a465337228aebfb1960a41348   = $v1723bdd4ee51910267a625cae41ced8a->getTypeByName('blogs20', 'blog');$vffd4f6acc31bf36b7a915f28af706301    = $vb3827f7111095f5ba1a9f49988fe9382->getType( $vb3827f7111095f5ba1a9f49988fe9382->getTypeByHierarchyTypeId($v93c8b11a465337228aebfb1960a41348->getId()) );$vd08fe9e3a1d8bd288603dc299320d4ab  = $v1723bdd4ee51910267a625cae41ced8a->getTypeByName('blogs20', 'post');$v9a29dfd84a8d6a30638eb3f0a09440ef   = $vb3827f7111095f5ba1a9f49988fe9382->getType( $vb3827f7111095f5ba1a9f49988fe9382->getTypeByHierarchyTypeId($vd08fe9e3a1d8bd288603dc299320d4ab->getId()) );$va6522624e32f6e60c7817f791067d5a1 = $v1723bdd4ee51910267a625cae41ced8a->getTypeByName('blogs20', 'comment');$vfeec2c84494a5e54915ce2f3494733c9  = $vb3827f7111095f5ba1a9f49988fe9382->getType( $vb3827f7111095f5ba1a9f49988fe9382->getTypeByHierarchyTypeId($va6522624e32f6e60c7817f791067d5a1->getId()) );$v0a62f4f965bf31dc14abe4dde86a81f6     = $v1723bdd4ee51910267a625cae41ced8a->getTypeByName('blogs', 'blog');$ve3b34d2d921e354b45a0efd1a52d356e      = $vb3827f7111095f5ba1a9f49988fe9382->getType( $vb3827f7111095f5ba1a9f49988fe9382->getTypeByHierarchyTypeId($v0a62f4f965bf31dc14abe4dde86a81f6->getId()) );$vec9204f6801b7e33a41db8c5feb8b0a1    = $v1723bdd4ee51910267a625cae41ced8a->getTypeByName('blogs', 'blog_message');$v923128794de6199acd19eb5b9cd1775f     = $vb3827f7111095f5ba1a9f49988fe9382->getType( $vb3827f7111095f5ba1a9f49988fe9382->getTypeByHierarchyTypeId($v0a62f4f965bf31dc14abe4dde86a81f6->getId()) );$v3daae63738810e0764715b3d582ad4e8   = $v1723bdd4ee51910267a625cae41ced8a->getTypeByName('blogs', 'blog_comment');$v676e0216a3ee092a589fc1bf1cf4f9c9    = $vb3827f7111095f5ba1a9f49988fe9382->getType( $vb3827f7111095f5ba1a9f49988fe9382->getTypeByHierarchyTypeId($v0a62f4f965bf31dc14abe4dde86a81f6->getId()) );$vef5714e0519bfaa645cdff7d28843b70 = new umiSelection();$vef5714e0519bfaa645cdff7d28843b70->addElementType($v0a62f4f965bf31dc14abe4dde86a81f6->getId());$v68638ada95d67ad4c2e4bad95504dce1  = umiSelectionsParser::runSelection($vef5714e0519bfaa645cdff7d28843b70);foreach($v68638ada95d67ad4c2e4bad95504dce1 as $v5ec92172c9f45d96f490290ccbaaf809) {$v126ac9f6149081eb0e97c2e939eaad52      = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v5ec92172c9f45d96f490290ccbaaf809, true, false);$vee83fdbc973e3b4421b4e530fc12f829 = $this->makeElementFromExisting($v5ec92172c9f45d96f490290ccbaaf809, $v126ac9f6149081eb0e97c2e939eaad52->getRel(), $v93c8b11a465337228aebfb1960a41348->getId(),               array('content'=>'description', 'prvlist_friends'=>'friendlist'));$vef5714e0519bfaa645cdff7d28843b70 = new umiSelection();$vef5714e0519bfaa645cdff7d28843b70->addElementType($vec9204f6801b7e33a41db8c5feb8b0a1->getId());$vef5714e0519bfaa645cdff7d28843b70->addHierarchyFilter($v5ec92172c9f45d96f490290ccbaaf809);$v38da1b06ac43d6aec08ab89361acd328  = umiSelectionsParser::runSelection($vef5714e0519bfaa645cdff7d28843b70);foreach($v38da1b06ac43d6aec08ab89361acd328 as $v73f10df5e289faaff50345b514062c0e) {$vb2ee08744fa3dfc2e85031911ac1765a = $this->makeElementFromExisting($v73f10df5e289faaff50345b514062c0e, $vee83fdbc973e3b4421b4e530fc12f829, $vd08fe9e3a1d8bd288603dc299320d4ab->getId());$this->import_comments($v73f10df5e289faaff50345b514062c0e, $vb2ee08744fa3dfc2e85031911ac1765a, $v3daae63738810e0764715b3d582ad4e8->getId(), $va6522624e32f6e60c7817f791067d5a1->getId());}}regedit::getInstance()->setVar("//modules/blogs20/import/old", 1);$this->chooseRedirect( getServer('HTTP_REFERER') );return null;}public function import_comments($vd98a07f84921b24ee30f86fd8cd85c3c, $v01b6e20344b68835c5ed1ddedf20d531, $v201eacffe730b97e9d61f8f46e4e0939, $ve1ad2f7cec55a8455b38bdd3843a3aed) {$vef5714e0519bfaa645cdff7d28843b70 = new umiSelection();$vef5714e0519bfaa645cdff7d28843b70->addElementType($v201eacffe730b97e9d61f8f46e4e0939);$vef5714e0519bfaa645cdff7d28843b70->addHierarchyFilter($vd98a07f84921b24ee30f86fd8cd85c3c);$vac5a2d02c360521d5f73ec15bea6b240  = umiSelectionsParser::runSelection($vef5714e0519bfaa645cdff7d28843b70);foreach($vac5a2d02c360521d5f73ec15bea6b240 as $ve2e1896b91c77e852e93acb763cdb1a7) {$v6fb212ba5df61f20dfc19ddc9c6a763d = $this->makeElementFromExisting($ve2e1896b91c77e852e93acb763cdb1a7, $v01b6e20344b68835c5ed1ddedf20d531, $ve1ad2f7cec55a8455b38bdd3843a3aed);$this->import_comments($ve2e1896b91c77e852e93acb763cdb1a7, $v6fb212ba5df61f20dfc19ddc9c6a763d, $v201eacffe730b97e9d61f8f46e4e0939, $ve1ad2f7cec55a8455b38bdd3843a3aed);}}public function makeElementFromExisting($v52195dae0174459c5f066fa0df053c26, $vbfa030fe63bacd523dd70a76cfaed98a, $vd406d549ad9e52f620dde042c6580f1d, $vcc78fa16352dfe6f4fcb2121e6de4ee2 = array()) {static $v360b018ca0116095d6539d4415bf7149 = 0;static $vdbe90c4afa209cc84bd8e7c16c7a747e   = 0;$vb81ca7c0ccaa77e7aa91936ab0070695  = umiHierarchy::getInstance();$v5891da2d64975cae48d175d1e001f5da    = umiObjectsCollection::getInstance();$vb3827f7111095f5ba1a9f49988fe9382 = umiObjectTypesCollection::getInstance();if(!($v360b018ca0116095d6539d4415bf7149 && $vdbe90c4afa209cc84bd8e7c16c7a747e)) {$vf5919c11158cf4e9fb323468aef126c6   = $vb3827f7111095f5ba1a9f49988fe9382->getBaseType('blogs', 'blog_privacy');$v39c23ebb705e834c8a62b789c89ecbd6 = $v5891da2d64975cae48d175d1e001f5da->getGuidedItems($vf5919c11158cf4e9fb323468aef126c6);foreach($v39c23ebb705e834c8a62b789c89ecbd6 as $v4102a8adb3c662a9387c4101ef79c9c7 => $va6f2d36985cb0eef9367ce5e40208616) {if($va6f2d36985cb0eef9367ce5e40208616 == 'friends') $v360b018ca0116095d6539d4415bf7149 = $v4102a8adb3c662a9387c4101ef79c9c7;if($va6f2d36985cb0eef9367ce5e40208616 == 'owner')   $vdbe90c4afa209cc84bd8e7c16c7a747e   = $v93989f47f486fce0735387e1341709b7;}}$v78897dfaf41a79226c8c760832b0f4ba    = $vb3827f7111095f5ba1a9f49988fe9382->getType( $vb3827f7111095f5ba1a9f49988fe9382->getTypeByHierarchyTypeId($vd406d549ad9e52f620dde042c6580f1d) );$v36cd38f49b9afa08222c0dc9ebfe35eb = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v52195dae0174459c5f066fa0df053c26, true, false);$v6c02b5bcb9b148d7b3321dfdb2ba85a0  = $vb81ca7c0ccaa77e7aa91936ab0070695->copyElement($v52195dae0174459c5f066fa0df053c26, $vbfa030fe63bacd523dd70a76cfaed98a, false);$v22af645d1859cb5ca6da0c484f1f37ea = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v6c02b5bcb9b148d7b3321dfdb2ba85a0);$v22af645d1859cb5ca6da0c484f1f37ea->setTypeId($vd406d549ad9e52f620dde042c6580f1d);$v37da86a9d0323d80fe2030c908ac634a = $v22af645d1859cb5ca6da0c484f1f37ea->getObject();$v399c32699000f9c132ed4c9c9dbba2a3  = $v5891da2d64975cae48d175d1e001f5da->addObject($v37da86a9d0323d80fe2030c908ac634a->getName(), $v78897dfaf41a79226c8c760832b0f4ba->getId());$v0c7f28926c50104e917a6cd58527573e    = $v5891da2d64975cae48d175d1e001f5da->getObject($v399c32699000f9c132ed4c9c9dbba2a3);$vd41d4ef14290645e0827bc8762394ba3 = $v78897dfaf41a79226c8c760832b0f4ba->getAllFields();foreach($vd41d4ef14290645e0827bc8762394ba3 as $v06e3d36fa30cea095545139854ad1fb9) {$v2063c1608d6e0baf80249c42e2be5804 = $v37da86a9d0323d80fe2030c908ac634a->getValue( $v06e3d36fa30cea095545139854ad1fb9->getName() );if($v2063c1608d6e0baf80249c42e2be5804 !== false) {$v0c7f28926c50104e917a6cd58527573e->setValue($v06e3d36fa30cea095545139854ad1fb9->getName(), $v2063c1608d6e0baf80249c42e2be5804);}}foreach($vcc78fa16352dfe6f4fcb2121e6de4ee2 as $v8e4f7f3726b31fa47ff1ad9f6ab5a8f5 => $va49c5f7fa984d02d4cbaba1d30c64c0f) {$v0c7f28926c50104e917a6cd58527573e->setValue($va49c5f7fa984d02d4cbaba1d30c64c0f, $v37da86a9d0323d80fe2030c908ac634a->getValue($v8e4f7f3726b31fa47ff1ad9f6ab5a8f5));}switch($v37da86a9d0323d80fe2030c908ac634a->getValue('privacy')) {case $v360b018ca0116095d6539d4415bf7149: $v0c7f28926c50104e917a6cd58527573e->setValue('only_for_friends', 1);break;case $vdbe90c4afa209cc84bd8e7c16c7a747e  : $v22af645d1859cb5ca6da0c484f1f37ea->setIsActive(false);break;}$v0c7f28926c50104e917a6cd58527573e->setOwnerId( $v37da86a9d0323d80fe2030c908ac634a->getOwnerId() );$v22af645d1859cb5ca6da0c484f1f37ea->setObject($v0c7f28926c50104e917a6cd58527573e);return $v6c02b5bcb9b148d7b3321dfdb2ba85a0;}}?>
<?php
 abstract class discount extends umiObjectProxy {protected $object, $modificator, $rules = Array();protected function __construct(umiObject $va8cfde6331bd59eb2ac96f8911c4b666) {parent::__construct($va8cfde6331bd59eb2ac96f8911c4b666);if($v0858acc363f25bb7ca4fd2bf48d53592 = $va8cfde6331bd59eb2ac96f8911c4b666->getValue('discount_modificator_id')) {$this->modificator = discountModificator::get($v0858acc363f25bb7ca4fd2bf48d53592, $this);}if($va4f86f7bfc24194b276c22e0ef158197 = $va8cfde6331bd59eb2ac96f8911c4b666->getValue('discount_rules_id')) {foreach($va4f86f7bfc24194b276c22e0ef158197 as $vd518fb001991da3cf0287dbd4d7bab6e) {$this->rules[] = discountRule::get($vd518fb001991da3cf0287dbd4d7bab6e, $this);}}}public function getName() {return $this->object->getName();}public function setName($vb068931cc450442b63f5b3d276ea4297) {$this->object->setName($vb068931cc450442b63f5b3d276ea4297);}public function getDiscountRules() {return $this->rules;}public function appendDiscountRule(discountRule $v8c9d6a5f393f9eb1b2e37f7a8e0c9b70) {foreach($this->rules as $v981c1e7b3795da18687613fbd66d4954) {if($v981c1e7b3795da18687613fbd66d4954->getId() == $v8c9d6a5f393f9eb1b2e37f7a8e0c9b70->getId()) {return;}}$this->rules[] = $v8c9d6a5f393f9eb1b2e37f7a8e0c9b70;$v2063c1608d6e0baf80249c42e2be5804 = array();foreach($this->rules as $v981c1e7b3795da18687613fbd66d4954) {$v2063c1608d6e0baf80249c42e2be5804[] = $v981c1e7b3795da18687613fbd66d4954->getId();}$this->object->discount_rules_id = $v2063c1608d6e0baf80249c42e2be5804;$this->commit();}public function getDiscountModificator() {return $this->modificator;}public function setDiscountModificator(discountModificator $vc51eb052c85d4fb7aaf7db0aacadde46) {$this->modificator = $vc51eb052c85d4fb7aaf7db0aacadde46;$this->object->discount_modificator_id = $vc51eb052c85d4fb7aaf7db0aacadde46->getId();$this->commit();}public function recalcPrice($v78a5eb43deef9a7b5b9ce157b9d52ac4) {$vcc988f011312e4c8b814c94033811229 = $this->getDiscountModificator();if($vcc988f011312e4c8b814c94033811229 instanceof discountModificator) {return $vcc988f011312e4c8b814c94033811229->recalcPrice($v78a5eb43deef9a7b5b9ce157b9d52ac4);}else {throw new coreException("Discount modificator couldn't be loaded");}}public static function get($ve1f1eeb708e15555efc136c5aee1f9bb) {static $v0fea6a13c52b4d4725368f24b045ca84 = array();if(!$ve1f1eeb708e15555efc136c5aee1f9bb) {return null;}if(isset($v0fea6a13c52b4d4725368f24b045ca84[$ve1f1eeb708e15555efc136c5aee1f9bb])) {return $v0fea6a13c52b4d4725368f24b045ca84[$ve1f1eeb708e15555efc136c5aee1f9bb];}$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();$v4c3e3e50c8ef3b2a481767d59ccbc0b8 = $v5891da2d64975cae48d175d1e001f5da->getObject($ve1f1eeb708e15555efc136c5aee1f9bb);if($v4c3e3e50c8ef3b2a481767d59ccbc0b8 instanceof iUmiObject == false) {return false;}$v65b6e2aac2f682a632ccd61650e47085 = $v4c3e3e50c8ef3b2a481767d59ccbc0b8->discount_type_id;$v7099fb9aeeb75bce70bb4d89a11256d0 = $v5891da2d64975cae48d175d1e001f5da->getObject($v65b6e2aac2f682a632ccd61650e47085);if($v7099fb9aeeb75bce70bb4d89a11256d0 instanceof iUmiObject == false) return null;$v6f66e878c62db60568a3487869695820 = $v7099fb9aeeb75bce70bb4d89a11256d0->codename . 'Discount';self::includeDiscount($v6f66e878c62db60568a3487869695820);return $v0fea6a13c52b4d4725368f24b045ca84[$ve1f1eeb708e15555efc136c5aee1f9bb] = new $v6f66e878c62db60568a3487869695820($v4c3e3e50c8ef3b2a481767d59ccbc0b8);}public static function add($v9a79c462c3c07cbf915ce11837e9d3c9, $v65b6e2aac2f682a632ccd61650e47085) {$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();$v0e8133eb006c0f85ed9444ae07a60842 = umiObjectTypesCollection::getInstance();$v6301cee35ea764a1e241978f93f01069 = $v0e8133eb006c0f85ed9444ae07a60842->getBaseType('emarket', 'discount');$v16b2b26000987faccb260b9d39df1269 = $v5891da2d64975cae48d175d1e001f5da->addObject($v9a79c462c3c07cbf915ce11837e9d3c9, $v6301cee35ea764a1e241978f93f01069);$va8cfde6331bd59eb2ac96f8911c4b666 = $v5891da2d64975cae48d175d1e001f5da->getObject($v16b2b26000987faccb260b9d39df1269);try {$va8cfde6331bd59eb2ac96f8911c4b666->discount_type_id = $v65b6e2aac2f682a632ccd61650e47085;}catch (valueRequiredException $ve1671797c52e15f763380b45e841ec32) {$va8cfde6331bd59eb2ac96f8911c4b666->delete();throw $ve1671797c52e15f763380b45e841ec32;}$va8cfde6331bd59eb2ac96f8911c4b666->commit();return self::get($v16b2b26000987faccb260b9d39df1269);}public static function getTypeId($v47ce1d30363ad59c2924ba07acae4d01) {$v8be74552df93e31bbdd6b36ed74bdb6a = new selector('objects');$v8be74552df93e31bbdd6b36ed74bdb6a->types('object-type')->name('emarket', 'discount_type');$v8be74552df93e31bbdd6b36ed74bdb6a->where('codename')->equals($v47ce1d30363ad59c2924ba07acae4d01);return ($v8be74552df93e31bbdd6b36ed74bdb6a->first) ? $v8be74552df93e31bbdd6b36ed74bdb6a->first->id : false;}public static function init() {self::includeDiscount('itemDiscount');self::includeDiscount('orderDiscount');}private static function includeDiscount($vb068931cc450442b63f5b3d276ea4297) {static $v0fea6a13c52b4d4725368f24b045ca84 = Array();if(isset($v0fea6a13c52b4d4725368f24b045ca84[$vb068931cc450442b63f5b3d276ea4297])) {return $v0fea6a13c52b4d4725368f24b045ca84[$vb068931cc450442b63f5b3d276ea4297];}$v47826cacc65c665212b821e6ff80b9b0 = CURRENT_WORKING_DIR . '/classes/modules/emarket/classes/discounts/discounts/' . $vb068931cc450442b63f5b3d276ea4297 . '.php';if(is_file($v47826cacc65c665212b821e6ff80b9b0)) {require $v47826cacc65c665212b821e6ff80b9b0;return $v0fea6a13c52b4d4725368f24b045ca84[$vb068931cc450442b63f5b3d276ea4297] = true;}else {return $v0fea6a13c52b4d4725368f24b045ca84[$vb068931cc450442b63f5b3d276ea4297] = false;}}};?>
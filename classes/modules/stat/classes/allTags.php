<?php
class allTags extends simpleStat{protected $params = array('user_id' => 0);public function get()    {$result = array();$ve8ecbdd23c701c161e8de11f046c9b38 = md5( ((is_array($this->host_id)) ? implode("", $this->host_id) : $this->host_id ).       ":".(is_array($this->user_id) ? implode("", $this->user_id) : $this->user_id));if( isset($_GLOBALS['stat']['allTags'][$ve8ecbdd23c701c161e8de11f046c9b38]) )   return $_GLOBALS['stat']['allTags'][$ve8ecbdd23c701c161e8de11f046c9b38];$ve938b6995733c155e14651ff88913790 = array();if(is_array($this->user_id) && !empty($this->user_id)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT hit.id as `hid` FROM cms_stat_hits hit,
                   cms_stat_paths path WHERE 
                   hit.path_id=path.id AND path.user_id IN (".implode(",",$this->user_id).") AND 
                   path.date BETWEEN ".$this->getQueryInterval();$v64bc6a1e5375a5043bc2422a10dfb93d = mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_assoc($v64bc6a1e5375a5043bc2422a10dfb93d))                $ve938b6995733c155e14651ff88913790[] = $vf1965a857bc285d26fe22023aa5ab50d['hid'];}else if(is_array($this->user_login) && !empty($this->user_login)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT hit.id as `hid` FROM cms_stat_hits hit,
			       cms_stat_paths path, cms_stat_users user WHERE 
				   hit.path_id=path.id AND path.user_id=user.id AND
                   path.date BETWEEN ".$this->getQueryInterval()." AND 
				   user.login IN (".implode(",",$this->user_login).")";$v64bc6a1e5375a5043bc2422a10dfb93d = mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_assoc($v64bc6a1e5375a5043bc2422a10dfb93d))    $ve938b6995733c155e14651ff88913790[] = $vf1965a857bc285d26fe22023aa5ab50d['hid'];}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT hit.id as `hid` FROM cms_stat_hits hit,
                   cms_stat_paths path, cms_stat_users user WHERE 
                   hit.path_id=path.id AND path.user_id=user.id AND
                   path.date BETWEEN ".$this->getQueryInterval(). " LIMIT 100";$v64bc6a1e5375a5043bc2422a10dfb93d = mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if( $v64bc6a1e5375a5043bc2422a10dfb93d )            while($vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_assoc($v64bc6a1e5375a5043bc2422a10dfb93d))                $ve938b6995733c155e14651ff88913790[] = $vf1965a857bc285d26fe22023aa5ab50d['hid'];}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT se.id as `id`, se.name as `tag`, COUNT(*) as `cnt` ".     "FROM cms_stat_events se, cms_stat_events_collected sec ".     "WHERE se.type = 2 AND sec.event_id = se.id ".     $this->getHostSQL("se")." ".     ((!empty($ve938b6995733c155e14651ff88913790)||!empty($this->user_id)) ? " AND sec.hit_id IN (".implode(",",$ve938b6995733c155e14651ff88913790).") " : "").     " GROUP BY sec.event_id LIMIT 50";$v64bc6a1e5375a5043bc2422a10dfb93d = mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$result['labels'] = Array();$v2ffe4e77325d9a7152f7086ea7aa5114 = 0;$v1d623b89683f9ce4e074de1676d12416 = 0;while($vf1965a857bc285d26fe22023aa5ab50d = @mysql_fetch_assoc($v64bc6a1e5375a5043bc2422a10dfb93d)) {$result['labels'][] = $vf1965a857bc285d26fe22023aa5ab50d;if($vf1965a857bc285d26fe22023aa5ab50d['cnt'] > $v2ffe4e77325d9a7152f7086ea7aa5114) {$v2ffe4e77325d9a7152f7086ea7aa5114 = $vf1965a857bc285d26fe22023aa5ab50d['cnt'];}$v1d623b89683f9ce4e074de1676d12416 += $vf1965a857bc285d26fe22023aa5ab50d['cnt'];}$result['max'] = $v2ffe4e77325d9a7152f7086ea7aa5114;$result['sum'] = $v1d623b89683f9ce4e074de1676d12416;$_GLOBALS['stat']['allTags'][$ve8ecbdd23c701c161e8de11f046c9b38] = $result;return $result;}}?>
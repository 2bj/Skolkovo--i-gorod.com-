<?php
 class redirects implements iRedirects {public static function getInstance() {static $v7123a699d77db6479a1d8ece2c4f1c16;if(is_null($v7123a699d77db6479a1d8ece2c4f1c16)) {$v7123a699d77db6479a1d8ece2c4f1c16 = new redirects;}return $v7123a699d77db6479a1d8ece2c4f1c16;}public function add($v36cd38f49b9afa08222c0dc9ebfe35eb, $v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258 = 301) {if($v36cd38f49b9afa08222c0dc9ebfe35eb == $v42aefbae01d2dfd981f7da7d823d689e) return;$v36cd38f49b9afa08222c0dc9ebfe35eb = mysql_real_escape_string($this->parseUri($v36cd38f49b9afa08222c0dc9ebfe35eb));$v42aefbae01d2dfd981f7da7d823d689e = mysql_real_escape_string($this->parseUri($v42aefbae01d2dfd981f7da7d823d689e));$v9acb44549b41563697bb490144ec6258 = (int) $v9acb44549b41563697bb490144ec6258;l_mysql_query("START TRANSACTION /* Adding new redirect records */");$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO `cms3_redirects`
	(`source`, `target`, `status`)
	SELECT `source`, '{$v42aefbae01d2dfd981f7da7d823d689e}', '{$v9acb44549b41563697bb490144ec6258}' FROM `cms3_redirects`	
		WHERE `target` = '{$v36cd38f49b9afa08222c0dc9ebfe35eb}'
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
DELETE FROM `cms3_redirects` WHERE `target` = '{$v36cd38f49b9afa08222c0dc9ebfe35eb}'
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$result = l_mysql_query("SELECT * FROM `cms3_redirects` WHERE `source` = '{$v36cd38f49b9afa08222c0dc9ebfe35eb}' AND `target` = '{$v42aefbae01d2dfd981f7da7d823d689e}'", true);if(mysql_num_rows($result)) {return;}$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
INSERT INTO `cms3_redirects`
	(`source`, `target`, `status`)
	VALUES
	('{$v36cd38f49b9afa08222c0dc9ebfe35eb}', '{$v42aefbae01d2dfd981f7da7d823d689e}', '{$v9acb44549b41563697bb490144ec6258}')
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);l_mysql_query("COMMIT");}public function getRedirectsIdBySource($v36cd38f49b9afa08222c0dc9ebfe35eb) {$vc08b1ffecd5ba75362b821842b4f4505 = mysql_real_escape_string($this->parseUri($v36cd38f49b9afa08222c0dc9ebfe35eb));$v2d8413ae32cda5259e93d4f3666f1235 = array();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `id`, `target`, `status` FROM `cms3_redirects` WHERE `source` = '{$vc08b1ffecd5ba75362b821842b4f4505}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($vb80bb7740288fda1f201890375a60c8f, $v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258) = mysql_fetch_row($result)) {$v2d8413ae32cda5259e93d4f3666f1235[$vb80bb7740288fda1f201890375a60c8f] = Array($v36cd38f49b9afa08222c0dc9ebfe35eb, $v42aefbae01d2dfd981f7da7d823d689e, (int) $v9acb44549b41563697bb490144ec6258);}return $v2d8413ae32cda5259e93d4f3666f1235;}public function getRedirectIdByTarget($v42aefbae01d2dfd981f7da7d823d689e) {$vf70cd12b2475f48430f5afb914d43f9c = mysql_real_escape_string($this->parseUri($v42aefbae01d2dfd981f7da7d823d689e));$v2d8413ae32cda5259e93d4f3666f1235 = array();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT `id`, `source`, `status` FROM `cms3_redirects` WHERE `target` = '{$vf70cd12b2475f48430f5afb914d43f9c}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(list($vb80bb7740288fda1f201890375a60c8f, $v36cd38f49b9afa08222c0dc9ebfe35eb, $v9acb44549b41563697bb490144ec6258) = mysql_fetch_row($result)) {return Array($v36cd38f49b9afa08222c0dc9ebfe35eb, $v42aefbae01d2dfd981f7da7d823d689e, (int) $v9acb44549b41563697bb490144ec6258);}else {return false;}}public function del($vb80bb7740288fda1f201890375a60c8f) {$vb80bb7740288fda1f201890375a60c8f = (int) $vb80bb7740288fda1f201890375a60c8f;$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
DELETE FROM `cms3_redirects` WHERE `id` = '{$vb80bb7740288fda1f201890375a60c8f}'
SQL;   l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);}public function redirectIfRequired($vf0183130c6c478a364b95e4325786eb9) {$vf0183130c6c478a364b95e4325786eb9 = mysql_real_escape_string($this->parseUri($vf0183130c6c478a364b95e4325786eb9));$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT `target`, `status` FROM `cms3_redirects`
	WHERE `source` = '{$vf0183130c6c478a364b95e4325786eb9}'
	ORDER BY `id` DESC LIMIT 1
SQL;   $result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(mysql_num_rows($result)) {list($v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258) = mysql_fetch_row($result);return $this->redirect("/" . $v42aefbae01d2dfd981f7da7d823d689e, (int) $v9acb44549b41563697bb490144ec6258);}$v8401668c4e8a4292331d5d46ddd1f649 = split("\/", trim($vf0183130c6c478a364b95e4325786eb9, "/"));do {array_pop($v8401668c4e8a4292331d5d46ddd1f649);$vf93632f2f958d47116bf0ad6ae7e6509 = implode("/", $v8401668c4e8a4292331d5d46ddd1f649) . "/";$v059db73d368bc8964f075448480bb487 = mysql_real_escape_string($this->parseUri($vf93632f2f958d47116bf0ad6ae7e6509));$vac5c74b64b4b8352ef2f181affb5ac2a = <<<SQL
SELECT `source`, `target`, `status` FROM `cms3_redirects`
	WHERE `source` = '{$v059db73d368bc8964f075448480bb487}'
	ORDER BY `id` DESC LIMIT 1
SQL;    $result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);if(mysql_num_rows($result)) {list($v36cd38f49b9afa08222c0dc9ebfe35eb, $v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258) = mysql_fetch_row($result);$v4cb75ae8da8b4b486d9a2eb6220d78f2 = substr($vf0183130c6c478a364b95e4325786eb9, strlen($v36cd38f49b9afa08222c0dc9ebfe35eb));$v42aefbae01d2dfd981f7da7d823d689e .= $v4cb75ae8da8b4b486d9a2eb6220d78f2;$this->redirect("/" . $v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258);}}while (sizeof($v8401668c4e8a4292331d5d46ddd1f649) > 1);}public function init() {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();if($v2245023265ae4cf87d02c8b6ba991139->get('seo', 'watch-redirects-history')) {$vd0b62cf0cd270bb58374f321620931ff = new umiEventListener("systemModifyElement", "content", "onModifyPageWatchRedirects");$vd0b62cf0cd270bb58374f321620931ff = new umiEventListener("systemMoveElement", "content", "onModifyPageWatchRedirects");}}protected function redirect($v42aefbae01d2dfd981f7da7d823d689e, $v9acb44549b41563697bb490144ec6258) {$vcccb484e3a7978e609c6d8725c8c8c09 = array(    300 => 'Multiple Choices',    'Moved Permanently', 'Found', 'See Other',    'Not Modified', 'Use Proxy', 'Switch Proxy', 'Temporary Redirect'   );if(!isset($vcccb484e3a7978e609c6d8725c8c8c09[$v9acb44549b41563697bb490144ec6258])) return false;$va153823cb904cdc2433606062b6aea0f = $vcccb484e3a7978e609c6d8725c8c8c09[$v9acb44549b41563697bb490144ec6258];$v7f2db423a49b305459147332fb01cf87 = outputBuffer::current();if($vc66c00ae9f18fc0c67d8973bd07dc4cd = getServer('HTTP_REFERER')) {$v7f2db423a49b305459147332fb01cf87->header('Referrer', $vc66c00ae9f18fc0c67d8973bd07dc4cd);}$v7f2db423a49b305459147332fb01cf87->status($v9acb44549b41563697bb490144ec6258 . ' ' . $va153823cb904cdc2433606062b6aea0f);$v7f2db423a49b305459147332fb01cf87->redirect($v42aefbae01d2dfd981f7da7d823d689e);$v7f2db423a49b305459147332fb01cf87->end();}protected function parseUri($v9305b73d359bd06734fee0b3638079e1) {return trim($v9305b73d359bd06734fee0b3638079e1, '/');}};?>
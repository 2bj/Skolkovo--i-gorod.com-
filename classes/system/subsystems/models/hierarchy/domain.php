<?php
 class domain extends umiEntinty implements iUmiEntinty, iDomainMirrow, iDomain {private $host, $default_lang_id, $mirrows = Array();protected $store_type = "domain";protected function loadInfo($vf1965a857bc285d26fe22023aa5ab50d = false) {if($vf1965a857bc285d26fe22023aa5ab50d === false) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT SQL_CACHE id, host, is_default, default_lang_id FROM cms3_domains WHERE id = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result);}if(list($vb80bb7740288fda1f201890375a60c8f, $v67b3dba8bc6778101892eb77249db32e, $vf62baf4c4ead98d50d516eca0ac5a746, $v97558aef72e0ceae6733793ba319a8d1) = $vf1965a857bc285d26fe22023aa5ab50d) {$this->host = $v67b3dba8bc6778101892eb77249db32e;$this->is_default = (bool) $vf62baf4c4ead98d50d516eca0ac5a746;$this->default_lang_id = (int) $v97558aef72e0ceae6733793ba319a8d1;return $this->loadMirrows();}else {return false;}}public function getHost() {return $this->host;}public function getIsDefault() {return $this->is_default;}public function setHost($v67b3dba8bc6778101892eb77249db32e) {$this->host = $this->filterHostName($v67b3dba8bc6778101892eb77249db32e);$this->setIsUpdated();}public function setIsDefault($vf62baf4c4ead98d50d516eca0ac5a746) {$this->is_default = (bool) $vf62baf4c4ead98d50d516eca0ac5a746;$this->setIsUpdated();}public function getDefaultLangId() {return $this->default_lang_id;}public function setDefaultLangId($v78e6dd7a49f5b0cb2106a3a434dd5c86) {if(langsCollection::getInstance()->isExists($v78e6dd7a49f5b0cb2106a3a434dd5c86)) {$this->default_lang_id = $v78e6dd7a49f5b0cb2106a3a434dd5c86;$this->setIsUpdated();return true;}else throw new coreException("Language #{$v78e6dd7a49f5b0cb2106a3a434dd5c86} doesn't exists");}public function addMirrow($vc9b148be34c2f7632fa35c418e265083) {if($v8ec042d79ac0de3ba2c91d757c4bbf06 = $this->getMirrowId($vc9b148be34c2f7632fa35c418e265083)) {return $v8ec042d79ac0de3ba2c91d757c4bbf06;}else {$this->setIsUpdated();$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_domain_mirrows (rel) VALUES('{$this->id}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v8ec042d79ac0de3ba2c91d757c4bbf06 = mysql_insert_id();$vda570110a5cf8f2ea8b037f530ec4f5a = new domainMirrow($v8ec042d79ac0de3ba2c91d757c4bbf06);$vda570110a5cf8f2ea8b037f530ec4f5a->setHost($vc9b148be34c2f7632fa35c418e265083);$vda570110a5cf8f2ea8b037f530ec4f5a->commit();$this->mirrows[$v8ec042d79ac0de3ba2c91d757c4bbf06] = $vda570110a5cf8f2ea8b037f530ec4f5a;return $v8ec042d79ac0de3ba2c91d757c4bbf06;}}public function delMirrow($v8ec042d79ac0de3ba2c91d757c4bbf06) {if($this->isMirrowExists($v8ec042d79ac0de3ba2c91d757c4bbf06)) {$this->setIsUpdated();$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_domain_mirrows WHERE id = '{$v8ec042d79ac0de3ba2c91d757c4bbf06}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);unset($this->mirrows[$v8ec042d79ac0de3ba2c91d757c4bbf06]);return true;}else return false;}public function delAllMirrows() {$this->setIsUpdated();$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_domain_mirrows WHERE rel = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public function getMirrowId($vc9b148be34c2f7632fa35c418e265083) {foreach($this->mirrows as $vda570110a5cf8f2ea8b037f530ec4f5a) {if($vda570110a5cf8f2ea8b037f530ec4f5a->getHost() == $vc9b148be34c2f7632fa35c418e265083) {return $vda570110a5cf8f2ea8b037f530ec4f5a->getId();}}return false;}public function getMirrow($v8ec042d79ac0de3ba2c91d757c4bbf06) {if($this->isMirrowExists($v8ec042d79ac0de3ba2c91d757c4bbf06)) {return $this->mirrows[$v8ec042d79ac0de3ba2c91d757c4bbf06];}else {return false;}}public function isMirrowExists($v8ec042d79ac0de3ba2c91d757c4bbf06) {return (bool) array_key_exists($v8ec042d79ac0de3ba2c91d757c4bbf06, $this->mirrows);}public function getMirrowsList() {return $this->mirrows;}private function loadMirrows() {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT SQL_CACHE id, host FROM cms3_domain_mirrows WHERE rel = '{$this->id}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);while(list($v8ec042d79ac0de3ba2c91d757c4bbf06) = $vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {try {$this->mirrows[$v8ec042d79ac0de3ba2c91d757c4bbf06] = new domainMirrow($v8ec042d79ac0de3ba2c91d757c4bbf06, $vf1965a857bc285d26fe22023aa5ab50d);}catch(privateException $ve1671797c52e15f763380b45e841ec32) {continue;}}return true;}protected function save() {$v67b3dba8bc6778101892eb77249db32e = self::filterInputString($this->host);$vf62baf4c4ead98d50d516eca0ac5a746 = (int) $this->is_default;$v97558aef72e0ceae6733793ba319a8d1 = (int) $this->default_lang_id;$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms3_domains SET host = '{$v67b3dba8bc6778101892eb77249db32e}', is_default = '{$vf62baf4c4ead98d50d516eca0ac5a746}', default_lang_id = '{$v97558aef72e0ceae6733793ba319a8d1}' WHERE id = '{$this->id}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}public static function filterHostName($v67b3dba8bc6778101892eb77249db32e) {return preg_replace("/([^A-z0-9\-А-я\.:]+)|[\^_\\\\]/u", "", $v67b3dba8bc6778101892eb77249db32e);}};?>

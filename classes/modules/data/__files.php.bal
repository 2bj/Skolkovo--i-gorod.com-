<?php
abstract class __files_data {private $cwd = '/files';public function getfilelist() {$this->flushAsXml('getfilelist');$this->setupCwd();$veca07335a33c5aeb5e1bc7c98b4b9d80 = array(     array('delete', 'unlink', 1),     array('copy',   'copy', 2),     array('move',   'rename', 2)     );for($v865c0c0b4ab0e063e5caa3387c1a8741=0;$v865c0c0b4ab0e063e5caa3387c1a8741<count($veca07335a33c5aeb5e1bc7c98b4b9d80);$v865c0c0b4ab0e063e5caa3387c1a8741++) {if(isset($_REQUEST[$veca07335a33c5aeb5e1bc7c98b4b9d80[$v865c0c0b4ab0e063e5caa3387c1a8741][0]]) && !empty($_REQUEST[$veca07335a33c5aeb5e1bc7c98b4b9d80[$v865c0c0b4ab0e063e5caa3387c1a8741][0]])) {foreach($_REQUEST[$veca07335a33c5aeb5e1bc7c98b4b9d80[$v865c0c0b4ab0e063e5caa3387c1a8741][0]] as $v447b7147e84be512208dcc0995d67ebc) {$v447b7147e84be512208dcc0995d67ebc = CURRENT_WORKING_DIR . base64_decode($v447b7147e84be512208dcc0995d67ebc);$vdbc11caa5bda99f77e6fb4dabd882e7d = array($v447b7147e84be512208dcc0995d67ebc);if($veca07335a33c5aeb5e1bc7c98b4b9d80[$v865c0c0b4ab0e063e5caa3387c1a8741][2] > 1) {$vdbc11caa5bda99f77e6fb4dabd882e7d[] = $this->cwd . '/' . basename($v447b7147e84be512208dcc0995d67ebc);}@call_user_func_array($veca07335a33c5aeb5e1bc7c98b4b9d80[$v865c0c0b4ab0e063e5caa3387c1a8741][1], $vdbc11caa5bda99f77e6fb4dabd882e7d);}}}$v7beed3ce9be23764654c1abac1fa3094 = '';$v4e5868d676cb634aa75b125a0f741abf      = 0;if(isset($_REQUEST['showOnlyImages'])) {$vd97a187384fb2a6e45703dfaee973d62 = glob($this->cwd . '/*.{jpg,JPG,jpeg,JPEG,png,PNG,gif,GIF}', GLOB_BRACE);}else if(isset($_REQUEST['showOnlyVideos'])) {$vd97a187384fb2a6e45703dfaee973d62 = glob($this->cwd . '/*.{flv,FLV,mp4,MP4}', GLOB_BRACE);}else if(isset($_REQUEST['showOnlyMedia'])) {$vd97a187384fb2a6e45703dfaee973d62 = glob($this->cwd . '/*.{swf,SWF,flv,FLV,dcr,DCR,mov,MOV,qt,QT,mpg,MPG,mp3,MP3,mp4,MP4,mpeg,MPEG,avi,AVI,wmv,WMV,wm,WM,asf,ASF,asx,ASX,wmx,WMX,wvx,WVX,rm,RM,ra,RA,ram,RAM}', GLOB_BRACE);}else {$vd97a187384fb2a6e45703dfaee973d62 = glob($this->cwd . '/*');}$v109633366fd0d46d371ede589998abaa = substr($this->cwd, strlen(CURRENT_WORKING_DIR));$vdf5f4017b6fcffd3d6219d1b52a09a92 = array("jpg", "jpeg", "gif", "png");$vc593be47baba6cb70f8bd566824effe2 = array("b", "Kb", "Mb", "Gb", "Tb");$vda08a758b1aef8bae094ef77f41d6518 = array();if(is_array($vd97a187384fb2a6e45703dfaee973d62) && !empty($vd97a187384fb2a6e45703dfaee973d62)) foreach($vd97a187384fb2a6e45703dfaee973d62 as $v447b7147e84be512208dcc0995d67ebc) {$vb068931cc450442b63f5b3d276ea4297 = basename($v447b7147e84be512208dcc0995d67ebc);if(is_dir($v447b7147e84be512208dcc0995d67ebc)) {continue;}$vcaf9b6b99962bf5c2264824231d7a40c = pathinfo($v447b7147e84be512208dcc0995d67ebc);$v599dcce2998a6b40b1e38e8c6006cb0a = strtolower($vcaf9b6b99962bf5c2264824231d7a40c['extension']);$v4d682ec4eed27c53849758bc13b6e179   = filectime($v447b7147e84be512208dcc0995d67ebc);$v07cc694b9b3fc636710fa08b6922c42b = date('g:i, d.m.Y' , $v4d682ec4eed27c53849758bc13b6e179 );$vf7bd60b75b29d79b660a2859395c1a24 = filesize($v447b7147e84be512208dcc0995d67ebc);$v8c7dd922ad47494fc02c388e12c00eac = array('attribute:name' => $vb068931cc450442b63f5b3d276ea4297,           'attribute:type' => $v599dcce2998a6b40b1e38e8c6006cb0a,        'attribute:size' => $vf7bd60b75b29d79b660a2859395c1a24,        'attribute:ctime'     => $v07cc694b9b3fc636710fa08b6922c42b,        'attribute:timestamp' => $v4d682ec4eed27c53849758bc13b6e179);$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;while($vf7bd60b75b29d79b660a2859395c1a24 > 1024.0) {$vf7bd60b75b29d79b660a2859395c1a24 /= 1024;$v865c0c0b4ab0e063e5caa3387c1a8741++;}$v21b4ac538ad09dfd5b7bb7cdabf4ce39 = (int)round($vf7bd60b75b29d79b660a2859395c1a24);if($v21b4ac538ad09dfd5b7bb7cdabf4ce39 == 1 && (int)floor($vf7bd60b75b29d79b660a2859395c1a24) != $v21b4ac538ad09dfd5b7bb7cdabf4ce39) {$v865c0c0b4ab0e063e5caa3387c1a8741++;}$v8c7dd922ad47494fc02c388e12c00eac['attribute:converted-size']   = $v21b4ac538ad09dfd5b7bb7cdabf4ce39.$vc593be47baba6cb70f8bd566824effe2[$v865c0c0b4ab0e063e5caa3387c1a8741];if(in_array($v599dcce2998a6b40b1e38e8c6006cb0a, $vdf5f4017b6fcffd3d6219d1b52a09a92) && $vcaf9b6b99962bf5c2264824231d7a40c = @getimagesize($v447b7147e84be512208dcc0995d67ebc)) {$v8c7dd922ad47494fc02c388e12c00eac['attribute:mime']   = $vcaf9b6b99962bf5c2264824231d7a40c['mime'];$v8c7dd922ad47494fc02c388e12c00eac['attribute:width']  = $vcaf9b6b99962bf5c2264824231d7a40c[0];$v8c7dd922ad47494fc02c388e12c00eac['attribute:height'] = $vcaf9b6b99962bf5c2264824231d7a40c[1];}else {}$vda08a758b1aef8bae094ef77f41d6518[] = $v8c7dd922ad47494fc02c388e12c00eac;}$v8d777f385d3dfec8815d20f7496026dc = array(   'attribute:folder' => $v109633366fd0d46d371ede589998abaa,   'data'    => array(   'list'    => array(    'files' => array('nodes:file' => $vda08a758b1aef8bae094ef77f41d6518)   ))  );return $v8d777f385d3dfec8815d20f7496026dc;}public function getfolderlist() {$this->flushAsXml('getfolderlist');$this->setupCwd();$v7cb31435da1bef1e450754ff725b0fdd  = glob($this->cwd . '/*', GLOB_ONLYDIR);$v109633366fd0d46d371ede589998abaa = substr($this->cwd, strlen(CURRENT_WORKING_DIR));$vd7e60af0bd7f0d873176d1215771001e = array();foreach($v7cb31435da1bef1e450754ff725b0fdd as $v447b7147e84be512208dcc0995d67ebc) {$vb068931cc450442b63f5b3d276ea4297 = basename($v447b7147e84be512208dcc0995d67ebc);$vd7e60af0bd7f0d873176d1215771001e[] = array('attribute:name' => $vb068931cc450442b63f5b3d276ea4297);}$v8d777f385d3dfec8815d20f7496026dc = array(   'attribute:folder' => $v109633366fd0d46d371ede589998abaa,   'data'    => array(   'list'    => array(    'folders' => array(     'nodes:folder' => $vd7e60af0bd7f0d873176d1215771001e    )   ))  );return $v8d777f385d3dfec8815d20f7496026dc;}public function createfolder() {$this->flushAsXml('createfolder');$this->setupCwd();if(!is_dir($this->cwd)) {@mkdir($this->cwd);}return array();}public function deletefolder() {$this->flushAsXml('deletefolder');$this->setupCwd();if(is_dir($this->cwd)) {@rmdir($this->cwd);}return array();}public function uploadfile() {$this->flushAsXml('uploadfile');$this->setupCwd();if(isset($_FILES['Filedata']['name'])) {foreach($_FILES['Filedata'] as $v8ce4b16b22b58894aa86c421e8759df3 => $v9e3669d19b675bd57058fd4664205d2a) {$_FILES['Filedata'][$v8ce4b16b22b58894aa86c421e8759df3] = array('upload' => $v9e3669d19b675bd57058fd4664205d2a);}$v8c7dd922ad47494fc02c388e12c00eac = umiFile::upload('Filedata', 'upload', $this->cwd);}$v109633366fd0d46d371ede589998abaa = substr($this->cwd, strlen(CURRENT_WORKING_DIR));$result = array(   'attribute:folder' => $v109633366fd0d46d371ede589998abaa,   'attribute:upload' => 'done'  );if($v8c7dd922ad47494fc02c388e12c00eac) {$v447b7147e84be512208dcc0995d67ebc = $this->cwd . "/" . $v8c7dd922ad47494fc02c388e12c00eac->getFileName();$vdf5f4017b6fcffd3d6219d1b52a09a92    = array("jpg", "jpeg", "gif", "png");$vc593be47baba6cb70f8bd566824effe2 = array("b", "Kb", "Mb", "Gb", "Tb");$vb068931cc450442b63f5b3d276ea4297 = $v8c7dd922ad47494fc02c388e12c00eac->getFileName();$v599dcce2998a6b40b1e38e8c6006cb0a = strtolower($v8c7dd922ad47494fc02c388e12c00eac->getExt());$v4d682ec4eed27c53849758bc13b6e179   = $v8c7dd922ad47494fc02c388e12c00eac->getModifyTime();$v07cc694b9b3fc636710fa08b6922c42b = date('g:i, d.m.Y' , $v4d682ec4eed27c53849758bc13b6e179 );$vf7bd60b75b29d79b660a2859395c1a24 = $v8c7dd922ad47494fc02c388e12c00eac->getSize();if(isset($_REQUEST['imagesOnly']) && !in_array($v599dcce2998a6b40b1e38e8c6006cb0a, $vdf5f4017b6fcffd3d6219d1b52a09a92)) {unlink($v447b7147e84be512208dcc0995d67ebc);return $result;}$v8c7dd922ad47494fc02c388e12c00eac = array('attribute:name' => $vb068931cc450442b63f5b3d276ea4297,        'attribute:type' => $v599dcce2998a6b40b1e38e8c6006cb0a,        'attribute:size' => $vf7bd60b75b29d79b660a2859395c1a24,        'attribute:ctime'     => $v07cc694b9b3fc636710fa08b6922c42b,        'attribute:timestamp' => $v4d682ec4eed27c53849758bc13b6e179);$v865c0c0b4ab0e063e5caa3387c1a8741 = 0;while($vf7bd60b75b29d79b660a2859395c1a24 > 1024.0) {$vf7bd60b75b29d79b660a2859395c1a24 /= 1024;$v865c0c0b4ab0e063e5caa3387c1a8741++;}$v21b4ac538ad09dfd5b7bb7cdabf4ce39 = (int)round($vf7bd60b75b29d79b660a2859395c1a24);if($v21b4ac538ad09dfd5b7bb7cdabf4ce39 == 1 && (int)floor($vf7bd60b75b29d79b660a2859395c1a24) != $v21b4ac538ad09dfd5b7bb7cdabf4ce39) {$v865c0c0b4ab0e063e5caa3387c1a8741++;}$v8c7dd922ad47494fc02c388e12c00eac['attribute:converted-size']   = $v21b4ac538ad09dfd5b7bb7cdabf4ce39.$vc593be47baba6cb70f8bd566824effe2[$v865c0c0b4ab0e063e5caa3387c1a8741];if(in_array($v599dcce2998a6b40b1e38e8c6006cb0a, $vdf5f4017b6fcffd3d6219d1b52a09a92) && $vcaf9b6b99962bf5c2264824231d7a40c = @getimagesize($v447b7147e84be512208dcc0995d67ebc)) {umiImageFile::addWatermark("." . $v109633366fd0d46d371ede589998abaa . "/" . $vb068931cc450442b63f5b3d276ea4297);$v8c7dd922ad47494fc02c388e12c00eac['attribute:mime']   = $vcaf9b6b99962bf5c2264824231d7a40c['mime'];$v8c7dd922ad47494fc02c388e12c00eac['attribute:width']  = $vcaf9b6b99962bf5c2264824231d7a40c[0];$v8c7dd922ad47494fc02c388e12c00eac['attribute:height'] = $vcaf9b6b99962bf5c2264824231d7a40c[1];}else {}$result["file"] = $v8c7dd922ad47494fc02c388e12c00eac;}return $result;}public function deletefiles() {$this->flushAsXml('deletefiles');$this->setupCwd();if(isset($_REQUEST['delete']) && is_array($_REQUEST['delete'])) {foreach($_REQUEST['delete'] as $v447b7147e84be512208dcc0995d67ebc) {$v447b7147e84be512208dcc0995d67ebc = $this->cwd . '/' . base64_decode($v447b7147e84be512208dcc0995d67ebc);if(is_dir($v447b7147e84be512208dcc0995d67ebc)) @rmdir($v447b7147e84be512208dcc0995d67ebc);else @unlink($v447b7147e84be512208dcc0995d67ebc);}}if(!isset($_REQUEST['nolisting'])) {return $this->getfilelist();}}public function rename() {$this->flushAsXml('rename');$vd6fe1d0be6347b8ef2427fa629c04485    = CURRENT_WORKING_DIR . base64_decode( getRequest("oldName") );$vb094188943aa15ee9da7c1357bc88eb5 = dirname($vd6fe1d0be6347b8ef2427fa629c04485) . "/" . base64_decode( getRequest("newName") );rename($vd6fe1d0be6347b8ef2427fa629c04485, $vb094188943aa15ee9da7c1357bc88eb5);return array(   'attribute:path' => substr($vb094188943aa15ee9da7c1357bc88eb5, strlen(CURRENT_WORKING_DIR))  );}public function getimagepreview() {$this->setupCwd();if(isset($_REQUEST['file'])){readfile( CURRENT_WORKING_DIR . base64_decode($_REQUEST['file']) );}exit();}public function setupCwd() {$vb03baa629c1fc0b4cf091303e56d5329 = array(CURRENT_WORKING_DIR . '/files', CURRENT_WORKING_DIR . '/images' );$this->cwd    = CURRENT_WORKING_DIR . '/files';if($v3460755c1b91ce6a8d70df5f52443b3d= getRequest('folder')) {$v3460755c1b91ce6a8d70df5f52443b3d = CURRENT_WORKING_DIR . rtrim(base64_decode($v3460755c1b91ce6a8d70df5f52443b3d), "/");$vfa816edb83e95bf0c8da580bdfd491ef    = $v3460755c1b91ce6a8d70df5f52443b3d;do {if(in_array($vfa816edb83e95bf0c8da580bdfd491ef, $vb03baa629c1fc0b4cf091303e56d5329)) {$this->cwd = $v3460755c1b91ce6a8d70df5f52443b3d;break;}$vfa816edb83e95bf0c8da580bdfd491ef = substr($vfa816edb83e95bf0c8da580bdfd491ef, 0, strrpos($vfa816edb83e95bf0c8da580bdfd491ef, "/"));}while($vfa816edb83e95bf0c8da580bdfd491ef != "\\" && $vfa816edb83e95bf0c8da580bdfd491ef != "/" && strlen($vfa816edb83e95bf0c8da580bdfd491ef));}}};?>
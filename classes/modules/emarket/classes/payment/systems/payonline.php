<?php
 class payonlinePayment extends payment {public function validate() {return true;}public function process($v66f6181bcb4cff4cd38fbc804a036db6 = null) {$v1af0389838508d7016a9841eb6273962    = strtoupper( mainConfiguration::getInstance()->get('system', 'default-currency') );if(!in_array($v1af0389838508d7016a9841eb6273962, array('RUB', 'EUR', 'USD'))) {$v1af0389838508d7016a9841eb6273962 = 'RUB';}$v242547909513cbcedb20ad5b39d8463d  = $this->object->merchant_id;$vbd0c8e3bd998a500b0984584a7245ca0  = $this->object->private_key;$v61e9abeaa2ba0e1296555c135d818e6e     = $this->order->getId();$ve9f40e1f1d1658681dad2dac4ae0971e      = number_format($this->order->getActualPrice(), 2, '.', '');$v3330c2ef5a5d4f7d0b3c3a560ffe67f6   = "MerchantId={$v242547909513cbcedb20ad5b39d8463d}&OrderId={$v61e9abeaa2ba0e1296555c135d818e6e}&Amount={$ve9f40e1f1d1658681dad2dac4ae0971e}&Currency={$v1af0389838508d7016a9841eb6273962}&PrivateSecurityKey={$vbd0c8e3bd998a500b0984584a7245ca0}";$ve114af7df8b0a516b06cb49e654a9de7 = md5($v3330c2ef5a5d4f7d0b3c3a560ffe67f6);$v3dbcbd1703a24842f71594ddaebc5a08  = "?MerchantId={$v242547909513cbcedb20ad5b39d8463d}&OrderId={$v61e9abeaa2ba0e1296555c135d818e6e}&Amount={$ve9f40e1f1d1658681dad2dac4ae0971e}&Currency={$v1af0389838508d7016a9841eb6273962}&SecurityKey={$ve114af7df8b0a516b06cb49e654a9de7}&order-id={$v61e9abeaa2ba0e1296555c135d818e6e}";$v3dbcbd1703a24842f71594ddaebc5a08  = "https://secure.payonlinesystem.com/ru/payment/" . $v3dbcbd1703a24842f71594ddaebc5a08;$veca07335a33c5aeb5e1bc7c98b4b9d80 = array();$veca07335a33c5aeb5e1bc7c98b4b9d80['formAction']  = $v3dbcbd1703a24842f71594ddaebc5a08;$this->order->setPaymentStatus('initialized');list($v78325ef2910aaa327bba1fde7d68bbf9) = def_module::loadTemplates("tpls/emarket/payment/payonline/".$v66f6181bcb4cff4cd38fbc804a036db6.".tpl", "form_block");return def_module::parseTemplate($v78325ef2910aaa327bba1fde7d68bbf9, $veca07335a33c5aeb5e1bc7c98b4b9d80);}public function poll() {$vdcf569ee792f42313127137ca01badc2      = getRequest('DateTime');$v671139edeb98807421e35e63d9c29a6a = getRequest('TransactionID');$v61e9abeaa2ba0e1296555c135d818e6e       = getRequest('OrderId');$ve9f40e1f1d1658681dad2dac4ae0971e        = getRequest('Amount');$v1af0389838508d7016a9841eb6273962      = getRequest('Currency');$ve114af7df8b0a516b06cb49e654a9de7   = getRequest('SecurityKey');$vbd0c8e3bd998a500b0984584a7245ca0    = $this->object->private_key;$v3330c2ef5a5d4f7d0b3c3a560ffe67f6     = "DateTime={$vdcf569ee792f42313127137ca01badc2}&TransactionID={$v671139edeb98807421e35e63d9c29a6a}&OrderId={$v61e9abeaa2ba0e1296555c135d818e6e}&Amount={$ve9f40e1f1d1658681dad2dac4ae0971e}&Currency={$v1af0389838508d7016a9841eb6273962}&PrivateSecurityKey={$vbd0c8e3bd998a500b0984584a7245ca0}";$ve8701a96f778fea2f6da0920e291d189      = md5($v3330c2ef5a5d4f7d0b3c3a560ffe67f6);if(strcasecmp($ve8701a96f778fea2f6da0920e291d189, $ve114af7df8b0a516b06cb49e654a9de7) == 0) {$this->order->setPaymentStatus('accepted');}$this->order->payment_document_num = $v671139edeb98807421e35e63d9c29a6a;$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();if($vfcaea7edd270964cc145ea48e4367d43 = $v8b1dc169bf460ee884fceef66c6607d6->getModule("emarket")) {$vfcaea7edd270964cc145ea48e4367d43->redirect($v8b1dc169bf460ee884fceef66c6607d6->getCurrentDomain()->getHost());}}};?>
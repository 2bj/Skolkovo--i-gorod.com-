<?php
    abstract class __popular_stat extends baseModuleAdmin {public function popular_pages() {$v3086f2e00ea19967e011c652edfc2884 = getRequest('param0');$v7982b1e077e535e00dc62cf8d6e9a455 = cmsController::getInstance()->getCurrentDomain()->getHost();$v23a2cbb13502e40ff869bbfa3211fc9b = cmsController::getInstance()->getCurrentLang()->getPrefix();$v5430f956c571aa9e86e91947b5da11a2 = '/'.$v23a2cbb13502e40ff869bbfa3211fc9b.'/admin/stat/'.__FUNCTION__;$v4062f8ff37e55691af3f19fac2155cf9 = '';$this->updateFilter();if ($v3086f2e00ea19967e011c652edfc2884 === 'xml') {$v9549dd6065d019211460c59a86dd6536 = new statisticFactory(dirname(__FILE__) . '/classes');$v9549dd6065d019211460c59a86dd6536->isValid('pagesHits');$ve98d2f001da5678b39482efbdf5770dc = $v9549dd6065d019211460c59a86dd6536->get('pagesHits');$ve98d2f001da5678b39482efbdf5770dc->setStart($this->from_time);$ve98d2f001da5678b39482efbdf5770dc->setFinish($this->to_time);$ve98d2f001da5678b39482efbdf5770dc->setLimit($this->items_per_page);$ve98d2f001da5678b39482efbdf5770dc->setDomain($this->domain);$ve98d2f001da5678b39482efbdf5770dc->setUser($this->user);$result = $ve98d2f001da5678b39482efbdf5770dc->get();$v03f1bcf4bdfde045733bb97482344c55 = 0;$v58048d5700b450e117e35a9c095fa5cb = $result['summ'];$v233762765fbf2a8381bb11dac5c21b8f = $result['total'];$va985177e18afdab154ab615657ef1514 = "";$va985177e18afdab154ab615657ef1514 .= "<"."?xml version=\"1.0\" encoding=\"utf-8\"?".">\n";$va985177e18afdab154ab615657ef1514 .= <<<END
                    <statistics>
                    <report name="pagesHits" title="Популярность страниц" host="{$v7982b1e077e535e00dc62cf8d6e9a455}" lang="{$v23a2cbb13502e40ff869bbfa3211fc9b}"  timerange_start="{$this->from_time}" timerange_finish="{$this->to_time}">
                    <table>
                        <column field="name" title="Страница" prefix="" valueSuffix=""  datatipField="uri"  />
                        <column field="cnt" title="Показов абс." prefix="" valueSuffix="" />
                        <column field="rel" title="Показов отн." prefix="" valueSuffix="%" />
                    </table>
                    <chart type="pie">
                        <argument />
                        <value field="cnt"/>
                        <caption field="name" />
                    </chart>                    
                    <data>
END;                    foreach($result['all'] as $vcaf9b6b99962bf5c2264824231d7a40c) {$v02f23ea9e3029ddaa616ddb1af52ada9 = $vcaf9b6b99962bf5c2264824231d7a40c['abs'];$va140ee0297c98eb2fcdcffb026609e8d = $vcaf9b6b99962bf5c2264824231d7a40c['rel'];$v03f1bcf4bdfde045733bb97482344c55 += $v02f23ea9e3029ddaa616ddb1af52ada9;$v9c502c0ace8194273cfb602536cdfa44 = $vcaf9b6b99962bf5c2264824231d7a40c['uri'];$vb73b19f3754a0e0b3972c787ac204174 = '';if ($v7057e8409c7c531a1a6e9ac3df4ed549 = umiHierarchy::getInstance()->getIdByPath($v9c502c0ace8194273cfb602536cdfa44)) {}elseif( $v9c502c0ace8194273cfb602536cdfa44 == "/") {$v7057e8409c7c531a1a6e9ac3df4ed549 = umiHierarchy::getInstance()->getDefaultElementId();}if($v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549)) {$vb73b19f3754a0e0b3972c787ac204174 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getName();}if (!strlen($vb73b19f3754a0e0b3972c787ac204174)) $vb73b19f3754a0e0b3972c787ac204174 = $vcaf9b6b99962bf5c2264824231d7a40c['uri'];$vc897060c947591dbd734ea2283a203b7 = htmlspecialchars($vb73b19f3754a0e0b3972c787ac204174);$ve334be05f2d25b295e8542a58661ed67= htmlspecialchars($v9c502c0ace8194273cfb602536cdfa44);$va985177e18afdab154ab615657ef1514 .= "<row ";$v6ce4e6be1d85a1e200672196c9411bfd = '';$v6ce4e6be1d85a1e200672196c9411bfd .= 'cnt="'.$v02f23ea9e3029ddaa616ddb1af52ada9.'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'name="'.$vc897060c947591dbd734ea2283a203b7.'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'uri="'.$ve334be05f2d25b295e8542a58661ed67.'" ';$v6ce4e6be1d85a1e200672196c9411bfd .= 'rel="'.round($va140ee0297c98eb2fcdcffb026609e8d, 1).'" ';foreach ($vcaf9b6b99962bf5c2264824231d7a40c as $vfc19ae0e7cb9076cc4077381bbe0b168=>$v3656061349751653a39f2de7e568c9e1) {if ($vfc19ae0e7cb9076cc4077381bbe0b168 !== 'cnt' && $vfc19ae0e7cb9076cc4077381bbe0b168 !== 'name' && $vfc19ae0e7cb9076cc4077381bbe0b168 !== 'uri' && $vfc19ae0e7cb9076cc4077381bbe0b168 !== 'rel') {$v6ce4e6be1d85a1e200672196c9411bfd .= $vfc19ae0e7cb9076cc4077381bbe0b168.'="'.htmlspecialchars($v3656061349751653a39f2de7e568c9e1, ENT_COMPAT).'" ';}}$va985177e18afdab154ab615657ef1514 .= $v6ce4e6be1d85a1e200672196c9411bfd;$va985177e18afdab154ab615657ef1514 .= "/>\n";}$vbbc1d718fe0a068b8d46f0b73cc73264 = ($v58048d5700b450e117e35a9c095fa5cb - $v03f1bcf4bdfde045733bb97482344c55);if ($vbbc1d718fe0a068b8d46f0b73cc73264 > 0) {$va985177e18afdab154ab615657ef1514 .= "<row cnt=\"{$vbbc1d718fe0a068b8d46f0b73cc73264}\" name=\"Прочее\" uri=\"\" rel=\"".round($vbbc1d718fe0a068b8d46f0b73cc73264/($v58048d5700b450e117e35a9c095fa5cb/100), 1)."\" />";}$va985177e18afdab154ab615657ef1514 .= "</data>\n";$va985177e18afdab154ab615657ef1514 .= "</report>\n</statistics>";header("Content-type: text/xml; charset=utf-8");header("Content-length: ".strlen($va985177e18afdab154ab615657ef1514));$this->flush($va985177e18afdab154ab615657ef1514);return "";}$v21ffce5b8a6cc8cc6a41448dd69623c9 = array();$v21ffce5b8a6cc8cc6a41448dd69623c9['filter'] = $this->getFilterPanel();$v21ffce5b8a6cc8cc6a41448dd69623c9['ReportPagePopularity']['flash:report']  = "url=".$v5430f956c571aa9e86e91947b5da11a2."/xml/".$v4062f8ff37e55691af3f19fac2155cf9;$this->setDataType("settings");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v21ffce5b8a6cc8cc6a41448dd69623c9, 'settings');$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}};?>
<?php
 abstract class __json_content extends baseModuleAdmin {public function json_get_editable_blocks() {$v510ff634fce407eea1763854519fd3ce = (int) getRequest('requestId');$vd11a7f89d7c79e361cb82bd0ada9ef91 = 50;if(!system_is_allowed("content", "qedit")) {exit();}$v4b43b0aee35624cd95b910189b3dc231 = getServer('HTTP_REFERER') . " | " . "http://" . getServer('HTTP_HOST') . getServer('REQUEST_URI');$v9b207167e5381c47682c6b4f58a623fb = '';$v3c6e0b8a9c15224a8228b9a98ca1531d = md5(getServer('HTTP_REFERER'));$v47c80780ab608cc046f2a6e6f071feb6 = getSession($v3c6e0b8a9c15224a8228b9a98ca1531d);if(!is_array($v47c80780ab608cc046f2a6e6f071feb6)) {$v47c80780ab608cc046f2a6e6f071feb6 = Array();}if(true) {$this->is_auth = false;if($v1e88513e4226ca45a20547bab9761c76 = cmsController::getInstance()->getModule("users")) {if($v1e88513e4226ca45a20547bab9761c76->is_auth()) {$v7ad6e70c936a7223ff2f1663258f4a0a = (int) $v1e88513e4226ca45a20547bab9761c76->user_id;$this->is_auth = true;$this->user_id = $v7ad6e70c936a7223ff2f1663258f4a0a;if($v5a459b4b428788e52383cf8fae051ef7 = umiObjectsCollection::getInstance()->getObject($v7ad6e70c936a7223ff2f1663258f4a0a)) {$vf92772949d595a912815dfee0eebc3fb = $v5a459b4b428788e52383cf8fae051ef7->getValue("lname");$v1bc8668465e7dcba83804ed7d95f8bce = $v5a459b4b428788e52383cf8fae051ef7->getValue("fname");$v37618849f93660614b1339b5a82f67f6 = $v5a459b4b428788e52383cf8fae051ef7->getValue("father_name");$vc56f5648d4c0e137f9de3dfc7a54d55b = "$vf92772949d595a912815dfee0eebc3fb $v1bc8668465e7dcba83804ed7d95f8bce $v37618849f93660614b1339b5a82f67f6";$v13ac4273dc853636a2413f2d70b438ff = $v5a459b4b428788e52383cf8fae051ef7->getValue("login");$v145cdd22e03d2447db29f9459c129600 = $v5a459b4b428788e52383cf8fae051ef7->getValue("groups");$v5c875c5744744651d10ccce32b6fb464 = Array();foreach($v145cdd22e03d2447db29f9459c129600 as $v5296237d106d81dd1e2314c49a643035) {$v5c875c5744744651d10ccce32b6fb464[] = umiObjectsCollection::getInstance()->getObject($v5296237d106d81dd1e2314c49a643035)->getName();}$va1ca70124e53a4f2847d6d1c34844be4 = implode(", ", $v5c875c5744744651d10ccce32b6fb464);}}}$v8f85b44f4a1eb8cd5c1064df913b3b29 = (int) permissionsCollection::getInstance()->isAllowedMethod($this->user_id, "content", "tickets");$v9b207167e5381c47682c6b4f58a623fb = <<<END
var response = new lLibResponse({$v510ff634fce407eea1763854519fd3ce});
response.links = new Array();
response.user_name = "{$vc56f5648d4c0e137f9de3dfc7a54d55b}";
response.user_login = "{$v13ac4273dc853636a2413f2d70b438ff}";
response.user_groups = "{$va1ca70124e53a4f2847d6d1c34844be4}";
response.modules = new Array();
response.ticketsAllowed = {$v8f85b44f4a1eb8cd5c1064df913b3b29};

END;    $v55d1a47fcab2c33dd159d000e4da096b = regedit::getInstance();$v611d9f9f4606c513ed705dde4447856d = $v55d1a47fcab2c33dd159d000e4da096b->getList('modules');for ($v168965c34d6a1fd6ad3d68aa5e76ae56=0;$v168965c34d6a1fd6ad3d68aa5e76ae56<count($v611d9f9f4606c513ed705dde4447856d);$v168965c34d6a1fd6ad3d68aa5e76ae56++) {$v9bf79682f1e3fc87a37a395957f52d1d = $v611d9f9f4606c513ed705dde4447856d[$v168965c34d6a1fd6ad3d68aa5e76ae56];if(!system_is_allowed($v9bf79682f1e3fc87a37a395957f52d1d[0], "")) continue;cmsController::getInstance()->getModule($v9bf79682f1e3fc87a37a395957f52d1d[0]);$vabdc6fca39c945587efec7f17113d48a = '//modules/' . $v9bf79682f1e3fc87a37a395957f52d1d[0] . '/';$v4d4fd01822ffe42eeec20da60ad4460b = $v55d1a47fcab2c33dd159d000e4da096b->getVal($vabdc6fca39c945587efec7f17113d48a . 'name');$v0744bf6dc42fec1c2800fc05b9808d82 = getLabel("module-".$v4d4fd01822ffe42eeec20da60ad4460b);$vf3ad57c965e88f9adb8fdde75cf5f0d3 = $this->pre_lang."/admin/".$v4d4fd01822ffe42eeec20da60ad4460b;if(defined("CURRENT_VERSION_LINE")) {if(CURRENT_VERSION_LINE == "free" || CURRENT_VERSION_LINE == "lite" || CURRENT_VERSION_LINE == "freelance") {if($v9bf79682f1e3fc87a37a395957f52d1d[0] == "data") {continue;}if(CURRENT_VERSION_LINE != "freelance") {if($v9bf79682f1e3fc87a37a395957f52d1d[0] == "vote" || $v9bf79682f1e3fc87a37a395957f52d1d[0] == "forum" || $v9bf79682f1e3fc87a37a395957f52d1d[0] == "webforms") {continue;}}}}if(defined('DB_DRIVER') && DB_DRIVER=="xml") {if($v9bf79682f1e3fc87a37a395957f52d1d[0] == 'search' || $v9bf79682f1e3fc87a37a395957f52d1d[0] == 'stat') continue;}$v9b207167e5381c47682c6b4f58a623fb .= <<<END
response.modules[response.modules.length] = new Array('{$v0744bf6dc42fec1c2800fc05b9808d82}', '{$vf3ad57c965e88f9adb8fdde75cf5f0d3}');

END;    }$v0744bf6dc42fec1c2800fc05b9808d82 = getLabel('header-data-trash');$vf3ad57c965e88f9adb8fdde75cf5f0d3 = $this->pre_lang . "/admin/data/trash/";$v9b207167e5381c47682c6b4f58a623fb .= <<<END
response.modules[response.modules.length] = new Array('{$v0744bf6dc42fec1c2800fc05b9808d82}', '{$vf3ad57c965e88f9adb8fdde75cf5f0d3}');

END;    $vf1290186a5d0b1ceab27f4e77c0c5d68 = Array();foreach($v47c80780ab608cc046f2a6e6f071feb6 as $v4a8a08f09d37b73795649038408b5f33) {if(in_array(Array($v4a8a08f09d37b73795649038408b5f33[0], $v4a8a08f09d37b73795649038408b5f33[2]), $vf1290186a5d0b1ceab27f4e77c0c5d68)) continue;$vf1290186a5d0b1ceab27f4e77c0c5d68[] = Array($v4a8a08f09d37b73795649038408b5f33[0], $v4a8a08f09d37b73795649038408b5f33[2]);if($v8e2dcfd7e7e24b1ca76c1193f645902b = umiHierarchy::getInstance()->getElement($v4a8a08f09d37b73795649038408b5f33[2])) {$vb068931cc450442b63f5b3d276ea4297 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getName();}else {continue;}if($v22884db148f0ffb0d830ba431102b0b5 = cmsController::getInstance()->getModule($v4a8a08f09d37b73795649038408b5f33[0])) {$v807765384d9d5527da8848df14a4f02f = $v22884db148f0ffb0d830ba431102b0b5->getEditLink($v4a8a08f09d37b73795649038408b5f33[2], $v4a8a08f09d37b73795649038408b5f33[1]);if(is_array($v807765384d9d5527da8848df14a4f02f)) {list(, $v2a304a1348456ccd2234cd71a81bd338) = $v807765384d9d5527da8848df14a4f02f;}else {$v2a304a1348456ccd2234cd71a81bd338 = false;}if(!$v2a304a1348456ccd2234cd71a81bd338) continue;if(wa_strlen($vb068931cc450442b63f5b3d276ea4297) > $vd11a7f89d7c79e361cb82bd0ada9ef91) {$vb068931cc450442b63f5b3d276ea4297 = wa_substr($vb068931cc450442b63f5b3d276ea4297, 0, $vd11a7f89d7c79e361cb82bd0ada9ef91) . "...";}$vb068931cc450442b63f5b3d276ea4297 = $this->filterString($vb068931cc450442b63f5b3d276ea4297);$v2a304a1348456ccd2234cd71a81bd338 = $this->filterString($v2a304a1348456ccd2234cd71a81bd338);$v94757cae63fd3e398c0811a976dd6bbe = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()->getTypeId();$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v94757cae63fd3e398c0811a976dd6bbe);$v22178d66649d30b18a7e4e331dc778ce = $v599dcce2998a6b40b1e38e8c6006cb0a->getName();$v1ab0d841dc5f91663e98cad420687e71 = $this->pre_lang . "/admin/data/type_edit/" . $v94757cae63fd3e398c0811a976dd6bbe . "/";if(isset($v4a8a08f09d37b73795649038408b5f33[3]) && $v4a8a08f09d37b73795649038408b5f33[3]) {$v22178d66649d30b18a7e4e331dc778ce = "";$v1ab0d841dc5f91663e98cad420687e71 = "";}$v9b207167e5381c47682c6b4f58a623fb .= <<<END
response.links[response.links.length] = new Array('{$vb068931cc450442b63f5b3d276ea4297}', '{$v2a304a1348456ccd2234cd71a81bd338}', '{$v22178d66649d30b18a7e4e331dc778ce}', '{$v1ab0d841dc5f91663e98cad420687e71}');

END;     }else {continue;}}$v9b207167e5381c47682c6b4f58a623fb .= <<<END
lLib.getInstance().makeResponse(response);

END;   }else {}header("Content-type: text/javascript; charset=utf-8");$this->flush($v9b207167e5381c47682c6b4f58a623fb);}public function json_get_field_content() {$v944720f8c45818e8d3caeb688b70b9a9 = getRequest("control_id");$v7057e8409c7c531a1a6e9ac3df4ed549 = (int) getRequest("element_id");$v23a5b8ab834cb5140fa6665622eb6417 = getRequest("prop");$v266dfb6190a3ce57973bce176a01701e = umiHierarchy::getInstance()->getElement($v7057e8409c7c531a1a6e9ac3df4ed549);$v3656061349751653a39f2de7e568c9e1 = str_replace('"', '\"', $v266dfb6190a3ce57973bce176a01701e->getValue($v23a5b8ab834cb5140fa6665622eb6417));$v3656061349751653a39f2de7e568c9e1 = str_replace("\r", '\r', $v3656061349751653a39f2de7e568c9e1);$v3656061349751653a39f2de7e568c9e1 = str_replace("\n", '\n', $v3656061349751653a39f2de7e568c9e1);$vdccc8c8d061984a56d899361b4934477 = <<<END

				var response = {
					"element_id"	: "{$v7057e8409c7c531a1a6e9ac3df4ed549}",
					"prop_name"	: "{$v23a5b8ab834cb5140fa6665622eb6417}",
					"control_id"	: "{$v944720f8c45818e8d3caeb688b70b9a9}",
					"value"		: "{$v3656061349751653a39f2de7e568c9e1}",
					"prop"		: "{$v23a5b8ab834cb5140fa6665622eb6417}"
				}

				lLib.getInstance().makeResponse(response);
END;   header("Content-type: text/javascript; charset=utf-8");$this->flush($vdccc8c8d061984a56d899361b4934477);}public function json_remove_imanager_object() {$vc0bf0ed8212ea4bc5c24d1d8a0eed789 = strtolower(getRequest("type"));$vabdc6fca39c945587efec7f17113d48a = base64_decode(getRequest('obj_path'));$vabdc6fca39c945587efec7f17113d48a = str_replace("\\", "/", $vabdc6fca39c945587efec7f17113d48a);$vabdc6fca39c945587efec7f17113d48a = str_replace("//", "/", $vabdc6fca39c945587efec7f17113d48a);$v2ce9f0ddf8a74a96b76f1da1214ca0ec = ini_get("include_path");$v3801fb7eccf485dd67a663e826a57066 = $v2ce9f0ddf8a74a96b76f1da1214ca0ec.$vabdc6fca39c945587efec7f17113d48a;while (substr($v3801fb7eccf485dd67a663e826a57066, -1)=="/") $v3801fb7eccf485dd67a663e826a57066=substr($v3801fb7eccf485dd67a663e826a57066, 0, (strlen($v3801fb7eccf485dd67a663e826a57066)-1));if ($vabdc6fca39c945587efec7f17113d48a == '/images') $this->flush('');if ($vc0bf0ed8212ea4bc5c24d1d8a0eed789 === "img" && is_file($v3801fb7eccf485dd67a663e826a57066)) {unlink($v3801fb7eccf485dd67a663e826a57066);}elseif ($vc0bf0ed8212ea4bc5c24d1d8a0eed789 === "dir" && is_dir($v3801fb7eccf485dd67a663e826a57066)) {}$this->flush();}public function removeDirectoryItem () {$v6149843274f2e068b5b7de0061ffa338 = strtolower(getRequest("type"));$vc830e0d8128143ea39e62de4abbfffaf = base64_decode(getRequest('obj_path'));$vc830e0d8128143ea39e62de4abbfffaf = str_replace("\\", "/", $vc830e0d8128143ea39e62de4abbfffaf);$vc830e0d8128143ea39e62de4abbfffaf = str_replace("\\", "/", $vc830e0d8128143ea39e62de4abbfffaf);}public function json_create_imanager_object() {$vf68d2c3658a26018e43729b214bc84c9 = getRequest('requestId');$vc0bf0ed8212ea4bc5c24d1d8a0eed789 = strtolower(getRequest("type"));$v2ce9f0ddf8a74a96b76f1da1214ca0ec = ini_get("include_path");$vd3e73e87c121191720aa03fc8a866ab4 = $v2ce9f0ddf8a74a96b76f1da1214ca0ec.'images';$vfc19ae0e7cb9076cc4077381bbe0b168 = getRequest('name');$vdf38ceb6517abb2f95107c2b39cfc047 = "";if (strlen(getRequest('dir'))) {$vdf38ceb6517abb2f95107c2b39cfc047 = base64_decode(getRequest('dir'));}$vdf38ceb6517abb2f95107c2b39cfc047 = str_replace("\\", "/", $vdf38ceb6517abb2f95107c2b39cfc047);$vdf38ceb6517abb2f95107c2b39cfc047 = str_replace("//", "/", $vdf38ceb6517abb2f95107c2b39cfc047);if(strpos($vdf38ceb6517abb2f95107c2b39cfc047, $vd3e73e87c121191720aa03fc8a866ab4) === false || strpos($vdf38ceb6517abb2f95107c2b39cfc047, "..") !== false || strpos($vdf38ceb6517abb2f95107c2b39cfc047, "./") !== false) {$vdf38ceb6517abb2f95107c2b39cfc047 = $vd3e73e87c121191720aa03fc8a866ab4;}while (substr($vdf38ceb6517abb2f95107c2b39cfc047, -1)=="/") $vdf38ceb6517abb2f95107c2b39cfc047=substr($vdf38ceb6517abb2f95107c2b39cfc047, 0, (strlen($vdf38ceb6517abb2f95107c2b39cfc047)-1));if ($vc0bf0ed8212ea4bc5c24d1d8a0eed789 === "img") {if (isset($_FILES['pics'])) {$va013a6af08beabf2bde3d2818a73c0eb = umiImageFile::upload("pics", "panel_item", $vdf38ceb6517abb2f95107c2b39cfc047);if ($va013a6af08beabf2bde3d2818a73c0eb instanceof umiImageFile) {if (umiImageFile::getIsImage($va013a6af08beabf2bde3d2818a73c0eb->getFilePath())) {header("Content-type: text/html; charset=utf-8");$v285fe165c97e9d97d252997fe63243dc = self::__renderPanelItem($va013a6af08beabf2bde3d2818a73c0eb, true);$vdccc8c8d061984a56d899361b4934477 = <<<END
								<html>
									<head>
										<script type="text/javascript">
											var responseArgs = new Array();

											{$v285fe165c97e9d97d252997fe63243dc}

										</script>
									</head>
									<body>Upload ok!</body>
								</html>
END;       echo $vdccc8c8d061984a56d899361b4934477;}else {header("Content-type: text/html; charset=utf-8");$vdccc8c8d061984a56d899361b4934477 = <<<END
							<html>
								<head>
									<script type="text/javascript">
										var error = 'uploadError';
									</script>
								</head>
								<body>Upload error!</body>
							</html>
END;       echo $vdccc8c8d061984a56d899361b4934477;}}else {$vdccc8c8d061984a56d899361b4934477 = <<<END
							<html>
								<head>
									<script type="text/javascript">
										var error = 'uploadError';
									</script>
								</head>
								<body>Upload error!</body>
							</html>
END;       echo $vdccc8c8d061984a56d899361b4934477;}}}elseif ($vc0bf0ed8212ea4bc5c24d1d8a0eed789 === "dir") {header("Content-type: text/javascript; charset=utf-8");$v9608e936812ff564801c97aebf07fd3c = $vdf38ceb6517abb2f95107c2b39cfc047 . "/" . translit::convert($vfc19ae0e7cb9076cc4077381bbe0b168);@mkdir($v9608e936812ff564801c97aebf07fd3c);@chmod($v9608e936812ff564801c97aebf07fd3c, 0777);$vdccc8c8d061984a56d899361b4934477 = <<<END
					var responseArgs = new Array();

					jsonRequestsController.getInstance().reportRequest({$vf68d2c3658a26018e43729b214bc84c9}, responseArgs);
END;     $this->flush($vdccc8c8d061984a56d899361b4934477);}exit();}protected function __renderPanelItem(umiImageFile $v70d35a4c33a246719a34e09f997e3290, $v68524a9713713f04544ec033a39dcf16 = false) {$v19e00dfe66d7957ccdaf9f5b7d7ae796      = umiConversion::getInstance()->Any2UTF8( $v70d35a4c33a246719a34e09f997e3290->getFilePath(true) );$vbde484e34e0810594928a030fa23495e = explode(".", $v19e00dfe66d7957ccdaf9f5b7d7ae796);$v3cc3cfd0a62f38145783ef77e19a0610         = array_pop($vbde484e34e0810594928a030fa23495e);$vb5503b3860aaf636fad4eaac73916b90 = implode(".", $vbde484e34e0810594928a030fa23495e);$vb4d75579f85ca024faa86f7c989140aa = implode(".", $vbde484e34e0810594928a030fa23495e);$vb4d75579f85ca024faa86f7c989140aa .= "_sl_90_60." . $v3cc3cfd0a62f38145783ef77e19a0610;$veeaddacfa04d904c5e99ba1de2509ae8 = "/autothumbs.php?img=" . $vb4d75579f85ca024faa86f7c989140aa . ($v68524a9713713f04544ec033a39dcf16 ? "&rnd=".time() : "");$vb5503b3860aaf636fad4eaac73916b90 = "/autothumbs.php?img=" . $vb5503b3860aaf636fad4eaac73916b90;$v6629619bd7ec45768f567901dd8f08b2  = umiConversion::getInstance()->Any2UTF8($v70d35a4c33a246719a34e09f997e3290->getFileName());$v077694994fbe8cfb750856a03bca4708 = truncStr($v6629619bd7ec45768f567901dd8f08b2, 16, ".." . substr($vb5503b3860aaf636fad4eaac73916b90, strlen($vb5503b3860aaf636fad4eaac73916b90) - 2) . "." . $v3cc3cfd0a62f38145783ef77e19a0610);$vb790175058e05911758cdaedd66fe5d9 = $v6629619bd7ec45768f567901dd8f08b2 . " (" . $v70d35a4c33a246719a34e09f997e3290->getWidth() . "x" . $v70d35a4c33a246719a34e09f997e3290->getHeight() . ", " . round($v70d35a4c33a246719a34e09f997e3290->getSize() / 1024, 1) . "Kb)";$v8e628d09ca20413b8e4f414260ec63d9 = <<<END

				responseArgs[responseArgs.length] = {
						img_info	: {
							"name"	: "{$v077694994fbe8cfb750856a03bca4708}",
							"title" : "{$vb790175058e05911758cdaedd66fe5d9}",
							"src"	: "{$v19e00dfe66d7957ccdaf9f5b7d7ae796}",
							"thumb_base" : "{$vb5503b3860aaf636fad4eaac73916b90}",
							"ext"	: "{$v3cc3cfd0a62f38145783ef77e19a0610}",
							"thumb"	: "{$veeaddacfa04d904c5e99ba1de2509ae8}",
							"width"	: "{$v70d35a4c33a246719a34e09f997e3290->getWidth()}",
							"height"	: "{$v70d35a4c33a246719a34e09f997e3290->getHeight()}"
						}
				}

END;   return $v8e628d09ca20413b8e4f414260ec63d9;}public function json_load_zip_folder () {$vf68d2c3658a26018e43729b214bc84c9   = (int) getRequest("requestId");$vd6fe1d0be6347b8ef2427fa629c04485     = (string) base64_decode (getRequest ("dirpath"));$v7fee4f7b906c49d382375b9db2541387 = (string) getRequest ("filetypes");if ($vd6fe1d0be6347b8ef2427fa629c04485 == "./" || $vd6fe1d0be6347b8ef2427fa629c04485 == ".." || $vd6fe1d0be6347b8ef2427fa629c04485 == ".") $vd6fe1d0be6347b8ef2427fa629c04485 = "";if (substr($vd6fe1d0be6347b8ef2427fa629c04485, 0,1) == "/") $vd6fe1d0be6347b8ef2427fa629c04485 = substr($vd6fe1d0be6347b8ef2427fa629c04485, 1);if(strlen(getRequest('rootpath')))     $vefc07d307f874988a2e55c3d443b2869 = getRequest('rootpath');else     $vefc07d307f874988a2e55c3d443b2869 = ".";$vd6fe1d0be6347b8ef2427fa629c04485 = $vefc07d307f874988a2e55c3d443b2869."/".$vd6fe1d0be6347b8ef2427fa629c04485;$vd6fe1d0be6347b8ef2427fa629c04485 = preg_replace("/(\/+)$/", "", $vd6fe1d0be6347b8ef2427fa629c04485);$vba78048dfd7717f145fa37ef4bff1cad = '';if ($vd6fe1d0be6347b8ef2427fa629c04485 != "./" && $vd6fe1d0be6347b8ef2427fa629c04485 != ".") {$v2df02dc36eb1e0db3ef21b860cd973ae = pathinfo ($vd6fe1d0be6347b8ef2427fa629c04485);$vba78048dfd7717f145fa37ef4bff1cad  = $v2df02dc36eb1e0db3ef21b860cd973ae['dirname'];$vba78048dfd7717f145fa37ef4bff1cad  = substr ($vba78048dfd7717f145fa37ef4bff1cad, strlen ($vefc07d307f874988a2e55c3d443b2869));$vba78048dfd7717f145fa37ef4bff1cad  = str_replace ('./', '', $vba78048dfd7717f145fa37ef4bff1cad);if (substr ($vba78048dfd7717f145fa37ef4bff1cad, 0 ,1) == '/') $vba78048dfd7717f145fa37ef4bff1cad = substr ($vba78048dfd7717f145fa37ef4bff1cad, 1);}$v1445430df3316a18ab1ab44a0c8b3ef4 = new umiDirectory($vd6fe1d0be6347b8ef2427fa629c04485);$v24a6b5f44b3f16e82baabd05c30cbae0    = "";if (strlen($v7fee4f7b906c49d382375b9db2541387)) {$v24a6b5f44b3f16e82baabd05c30cbae0     = "^.+\.(";$v3308208c91a9e9a7814f0f32b0827b43 = explode(",", $v7fee4f7b906c49d382375b9db2541387);foreach ($v3308208c91a9e9a7814f0f32b0827b43 as $v3c6e0b8a9c15224a8228b9a98ca1531d=>$v566bbee0f961ad71b54c3c2fd36db053) {if ($v3c6e0b8a9c15224a8228b9a98ca1531d != (count($v3308208c91a9e9a7814f0f32b0827b43)-1)) {$v24a6b5f44b3f16e82baabd05c30cbae0 .= $v566bbee0f961ad71b54c3c2fd36db053."|";}else{$v24a6b5f44b3f16e82baabd05c30cbae0 .= $v566bbee0f961ad71b54c3c2fd36db053;}}$v24a6b5f44b3f16e82baabd05c30cbae0 .= ")$";}else{$v24a6b5f44b3f16e82baabd05c30cbae0 = "^.+\.(zip)$";}$va4a0f0f02d782d445d5c517d7472c23e = "^(?!\.).*";$v10cb936da65d5769d57dcb1f51a10f44 = $v1445430df3316a18ab1ab44a0c8b3ef4->getDirectories($va4a0f0f02d782d445d5c517d7472c23e);$result  = "var responseArgs = new Array();\n";$result .=  <<<END
responseArgs[responseArgs.length] = {
		file_info	: {
			"type"	: "dir",
			"name"  : "..",
			"src"   : "{$vba78048dfd7717f145fa37ef4bff1cad}",
			"full_path" : "{$vd6fe1d0be6347b8ef2427fa629c04485}"
		}
	};

END;   $v61bc14cb8b5ad53713391fa68d17e48c = $v1445430df3316a18ab1ab44a0c8b3ef4->getFiles($v24a6b5f44b3f16e82baabd05c30cbae0);if(!empty($v10cb936da65d5769d57dcb1f51a10f44)) {asort($v10cb936da65d5769d57dcb1f51a10f44);reset($v10cb936da65d5769d57dcb1f51a10f44);}if(!empty($v61bc14cb8b5ad53713391fa68d17e48c)){asort($v61bc14cb8b5ad53713391fa68d17e48c);reset($v61bc14cb8b5ad53713391fa68d17e48c);}foreach ($v10cb936da65d5769d57dcb1f51a10f44 as $v100664c6e2c0333b19a729f2f3ddb7dd=>$vc70871ff39c982c9cdb5da58c43442e7) {$v25d902c24283ab8cfbac54dfa101ad31 = $vd6fe1d0be6347b8ef2427fa629c04485 . '/' . $v100664c6e2c0333b19a729f2f3ddb7dd;$v25d902c24283ab8cfbac54dfa101ad31 = substr ($v25d902c24283ab8cfbac54dfa101ad31, strlen ($vefc07d307f874988a2e55c3d443b2869));$v25d902c24283ab8cfbac54dfa101ad31 = str_replace ('./', '', $v25d902c24283ab8cfbac54dfa101ad31);if (substr ($v25d902c24283ab8cfbac54dfa101ad31, 0 ,1) == '/') $v25d902c24283ab8cfbac54dfa101ad31 = substr ($v25d902c24283ab8cfbac54dfa101ad31, 1);$result.= <<<END
responseArgs[responseArgs.length] = {
		file_info	: {
			"type"	: "dir",
			"name"  : "{$v100664c6e2c0333b19a729f2f3ddb7dd}",
			"src"   : "{$v25d902c24283ab8cfbac54dfa101ad31}",
			"full_path" : "{$vd6fe1d0be6347b8ef2427fa629c04485}"
		}
	};

END;   }foreach ($v61bc14cb8b5ad53713391fa68d17e48c as $v5b063e275d506f65ebf1b02d926f19a4=>$v8b0afb238c3cd824b61190b77b926185){$result.= <<<END
responseArgs[responseArgs.length] = {
		file_info	: {
			"type"	: "file",
			"name"  : "{$v5b063e275d506f65ebf1b02d926f19a4}",
			"src"   : "{$v8b0afb238c3cd824b61190b77b926185}",
			"full_path" : "{$vd6fe1d0be6347b8ef2427fa629c04485}"
		}
	};

END;   }$result .= "
jsonRequestsController.getInstance().reportRequest({$vf68d2c3658a26018e43729b214bc84c9}, responseArgs);";header("Content-type: text/javascript; charset=utf-8");$this->flush($result);}public function json_get_images_panel() {$vf68d2c3658a26018e43729b214bc84c9 = getRequest('requestId');$v0bf37cfe9982a08aeee2ac22107dcb2a = strtolower(getRequest("type"));$vdf38ceb6517abb2f95107c2b39cfc047  = '';$v2ce9f0ddf8a74a96b76f1da1214ca0ec = ini_get("include_path");$vd3e73e87c121191720aa03fc8a866ab4 = $v2ce9f0ddf8a74a96b76f1da1214ca0ec.'images';if (strlen(getRequest('dir'))) {$vdf38ceb6517abb2f95107c2b39cfc047 = base64_decode(getRequest('dir'));}$vdf38ceb6517abb2f95107c2b39cfc047 = str_replace("\\", "/", $vdf38ceb6517abb2f95107c2b39cfc047);$vdf38ceb6517abb2f95107c2b39cfc047 = str_replace("//", "/", $vdf38ceb6517abb2f95107c2b39cfc047);if(strpos($vdf38ceb6517abb2f95107c2b39cfc047, $vd3e73e87c121191720aa03fc8a866ab4) === false || strpos($vdf38ceb6517abb2f95107c2b39cfc047, "..") !== false || strpos($vdf38ceb6517abb2f95107c2b39cfc047, "./") !== false) {$vdf38ceb6517abb2f95107c2b39cfc047 = $vd3e73e87c121191720aa03fc8a866ab4;}while (substr($vdf38ceb6517abb2f95107c2b39cfc047, -1)=="/") $vdf38ceb6517abb2f95107c2b39cfc047=substr($vdf38ceb6517abb2f95107c2b39cfc047, 0, (strlen($vdf38ceb6517abb2f95107c2b39cfc047)-1));$v720aa0a7de050a6992d8e710eaa13450 = new umiDirectory($vdf38ceb6517abb2f95107c2b39cfc047);$vb566484d98c3f5131cfe5bda8303a120 = "";if (!$v720aa0a7de050a6992d8e710eaa13450->getIsBroken()) {if ($v0bf37cfe9982a08aeee2ac22107dcb2a === "dir") {$v0dd970ac429c7bc44ed532dc1807e2f6 = '';if ($vdf38ceb6517abb2f95107c2b39cfc047 !== $vd3e73e87c121191720aa03fc8a866ab4) {$v1161410dd62d4b2d416dfd7b561daf72 = explode("/", $v720aa0a7de050a6992d8e710eaa13450->getPath());array_pop($v1161410dd62d4b2d416dfd7b561daf72);$v0dd970ac429c7bc44ed532dc1807e2f6 = implode("/", $v1161410dd62d4b2d416dfd7b561daf72);}$vfc19ae0e7cb9076cc4077381bbe0b168 = umiConversion::getInstance()->Any2UTF8($v720aa0a7de050a6992d8e710eaa13450->getName());$vb566484d98c3f5131cfe5bda8303a120 .= <<<END
					responseArgs[responseArgs.length] = {
									"name" : '{$vfc19ae0e7cb9076cc4077381bbe0b168}',
									"path" : '{$v720aa0a7de050a6992d8e710eaa13450->getPath()}',
									"parent_dir" : '{$v0dd970ac429c7bc44ed532dc1807e2f6}'
							}
END;    }foreach ($v720aa0a7de050a6992d8e710eaa13450 as $v3801fb7eccf485dd67a663e826a57066 => $v70d35a4c33a246719a34e09f997e3290) {if ($v70d35a4c33a246719a34e09f997e3290 instanceof umiImageFile && $v0bf37cfe9982a08aeee2ac22107dcb2a === "img") {if (!umiImageFile::getIsImage($v3801fb7eccf485dd67a663e826a57066)) continue;$vb566484d98c3f5131cfe5bda8303a120 .= self::__renderPanelItem($v70d35a4c33a246719a34e09f997e3290);}elseif ($v70d35a4c33a246719a34e09f997e3290 instanceof umiDirectory && $v0bf37cfe9982a08aeee2ac22107dcb2a === "dir") {$vfa716d5b55e839746e3a2789a2cb0148 = $v70d35a4c33a246719a34e09f997e3290->getName();if ($vfa716d5b55e839746e3a2789a2cb0148 === '.svn' ||       $vfa716d5b55e839746e3a2789a2cb0148 === 'thumbs' ||       $vfa716d5b55e839746e3a2789a2cb0148 === 'admin' ||       $vfa716d5b55e839746e3a2789a2cb0148 === 'autothumbs'      ) continue;$vfa716d5b55e839746e3a2789a2cb0148 = umiConversion::getInstance()->Any2UTF8($vfa716d5b55e839746e3a2789a2cb0148);$vb566484d98c3f5131cfe5bda8303a120 .= <<<END

							responseArgs[responseArgs.length] = {
									"name" : '{$vfa716d5b55e839746e3a2789a2cb0148}',
									"path" : '{$v70d35a4c33a246719a34e09f997e3290->getPath()}'
							}

END;     }}}$vdccc8c8d061984a56d899361b4934477 = <<<END
				var responseArgs = new Array();

				{$vb566484d98c3f5131cfe5bda8303a120}

				jsonRequestsController.getInstance().reportRequest({$vf68d2c3658a26018e43729b214bc84c9}, responseArgs);
END;   header("Content-type: text/javascript; charset=utf-8");$this->flush($vdccc8c8d061984a56d899361b4934477);}public function json_load_files() {header("Content-type: text/javascript; charset=utf-8");$vc7fd747df51400a95998ed50cb1af062 = substr(getRequest('param0'), 7);$v0596b27a450533ae67fc6635c21bebc1 = (string) getRequest('param1');$v4ed9407630eb1000c0f6b63842defa7d = getRequest('def');$v736007832d2167baaae763fd3a3f3cf1 = getRequest('dir');$v8277e0910d750195b448797616e091ad = trim($v736007832d2167baaae763fd3a3f3cf1, "/.");$v53f0c808573dcdea857102bfbdf251ce = false;if (strpos($v8277e0910d750195b448797616e091ad, "images") === 0) {$v53f0c808573dcdea857102bfbdf251ce = true;}$ve760580cc55e0c3a962b4dfd1473765d = new cifi($vc7fd747df51400a95998ed50cb1af062, $v736007832d2167baaae763fd3a3f3cf1, $v53f0c808573dcdea857102bfbdf251ce);$ve760580cc55e0c3a962b4dfd1473765d->maxFilesPerFolder = false;$v45b963397aa40d4a0063e0d85e4fe7a1 = $ve760580cc55e0c3a962b4dfd1473765d->read_files();$v9b207167e5381c47682c6b4f58a623fb = <<<JS
cifi_images_arr_{$vc7fd747df51400a95998ed50cb1af062} = Array();

JS;   for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < sizeof($v45b963397aa40d4a0063e0d85e4fe7a1);$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v8c7dd922ad47494fc02c388e12c00eac = $v45b963397aa40d4a0063e0d85e4fe7a1[$v865c0c0b4ab0e063e5caa3387c1a8741];$v8c7dd922ad47494fc02c388e12c00eac[0] = iconv("CP1251", "UTF-8//IGNORE", $v8c7dd922ad47494fc02c388e12c00eac[0]);$v8c7dd922ad47494fc02c388e12c00eac[1] = iconv("CP1251", "UTF-8//IGNORE", $v8c7dd922ad47494fc02c388e12c00eac[1]);$ve86e7a0d8f8acb1759c5cda08e5ad8f6 = "./images/cms/data/";switch ($vc7fd747df51400a95998ed50cb1af062) {case "menu_pi_ua" : $ve86e7a0d8f8acb1759c5cda08e5ad8f6 = "./images/cms/menu/";break;case "header_pic" : $ve86e7a0d8f8acb1759c5cda08e5ad8f6 = "./images/cms/headers/";break;case "menu_pic_a" : $ve86e7a0d8f8acb1759c5cda08e5ad8f6 = "./images/cms/data/";break;default : $ve86e7a0d8f8acb1759c5cda08e5ad8f6 = "./images/cms/data/";break;}$v8c7dd922ad47494fc02c388e12c00eac[0] = substr ($v8c7dd922ad47494fc02c388e12c00eac[0], strlen($ve86e7a0d8f8acb1759c5cda08e5ad8f6));$v9b207167e5381c47682c6b4f58a623fb .= <<<JS
cifi_images_arr_{$vc7fd747df51400a95998ed50cb1af062}[$v865c0c0b4ab0e063e5caa3387c1a8741] = {"filename" : "{$v8c7dd922ad47494fc02c388e12c00eac[1]}", "full" : "{$v8c7dd922ad47494fc02c388e12c00eac[0]}"};

JS;   }$v9b207167e5381c47682c6b4f58a623fb .= <<<JS
image_cifi_generate('{$vc7fd747df51400a95998ed50cb1af062}', cifi_images_arr_{$vc7fd747df51400a95998ed50cb1af062}, '{$v4ed9407630eb1000c0f6b63842defa7d}', '{$v736007832d2167baaae763fd3a3f3cf1}');

var selectObj = document.getElementById('cifi_select_{$vc7fd747df51400a95998ed50cb1af062}');
if(selectObj) {
	if(typeof selectObj == "function") {
		selectObj.click();
	}
}
JS;   header("Content-type: text/javascript; charset=utf-8");$this->flush($v9b207167e5381c47682c6b4f58a623fb);}public function old_json_load_files() {header("Content-type: text/javascript; charset=utf-8");$vc7fd747df51400a95998ed50cb1af062 = substr(getRequest('param0'), 7);$v0596b27a450533ae67fc6635c21bebc1 = (string) getRequest('param1');$v4ed9407630eb1000c0f6b63842defa7d = getRequest('def');$v736007832d2167baaae763fd3a3f3cf1 = getRequest('dir');$v8277e0910d750195b448797616e091ad = trim($v736007832d2167baaae763fd3a3f3cf1, "/.");$v53f0c808573dcdea857102bfbdf251ce = false;if (strpos($v8277e0910d750195b448797616e091ad, "images") === 0) {$v53f0c808573dcdea857102bfbdf251ce = true;}$ve760580cc55e0c3a962b4dfd1473765d = new cifi($vc7fd747df51400a95998ed50cb1af062, $v736007832d2167baaae763fd3a3f3cf1, $v53f0c808573dcdea857102bfbdf251ce);$ve760580cc55e0c3a962b4dfd1473765d->maxFilesPerFolder = false;$v45b963397aa40d4a0063e0d85e4fe7a1 = $ve760580cc55e0c3a962b4dfd1473765d->old_read_files();$v9b207167e5381c47682c6b4f58a623fb = <<<JS
cifi_images_arr_{$vc7fd747df51400a95998ed50cb1af062} = Array();
cifi_images_arr_{$vc7fd747df51400a95998ed50cb1af062}[0] = "";

JS;   for($v865c0c0b4ab0e063e5caa3387c1a8741 = 0;$v865c0c0b4ab0e063e5caa3387c1a8741 < sizeof($v45b963397aa40d4a0063e0d85e4fe7a1);$v865c0c0b4ab0e063e5caa3387c1a8741++) {$v8c7dd922ad47494fc02c388e12c00eac = $v45b963397aa40d4a0063e0d85e4fe7a1[$v865c0c0b4ab0e063e5caa3387c1a8741];$v8c7dd922ad47494fc02c388e12c00eac = iconv("CP1251", "UTF-8//IGNORE", $v8c7dd922ad47494fc02c388e12c00eac);$v4a8a08f09d37b73795649038408b5f33 = $v865c0c0b4ab0e063e5caa3387c1a8741 + 1;$v9b207167e5381c47682c6b4f58a623fb .= <<<JS
cifi_images_arr_{$vc7fd747df51400a95998ed50cb1af062}[$v4a8a08f09d37b73795649038408b5f33] = "{$v8c7dd922ad47494fc02c388e12c00eac}";

JS;   }$v9b207167e5381c47682c6b4f58a623fb .= <<<JS
file_cifi_generate('{$vc7fd747df51400a95998ed50cb1af062}', cifi_images_arr_{$vc7fd747df51400a95998ed50cb1af062}, '{$v4ed9407630eb1000c0f6b63842defa7d}', '{$v736007832d2167baaae763fd3a3f3cf1}');

var selectObj = document.getElementById('cifi_select_{$vc7fd747df51400a95998ed50cb1af062}');
if(selectObj) {
	if(typeof selectObj == "function") {
		selectObj.click();
	}
}
JS;   header("Content-type: text/javascript; charset=utf-8");$this->flush($v9b207167e5381c47682c6b4f58a623fb);}public function json_mini_browser() {$v736007832d2167baaae763fd3a3f3cf1 = getRequest('dir');$vf6396dc21d306e53108617868371a7cc = getRequest ('reload_dirname');if (strlen(getRequest ('upload_file'))) {if (strlen (getRequest ("watermark"))) {umiImageFile::setWatermarkOn ();}$v8c7dd922ad47494fc02c388e12c00eac = umiImageFile::upload("pics", "pic", $v736007832d2167baaae763fd3a3f3cf1.'/'.base64_decode($vf6396dc21d306e53108617868371a7cc));if(is_object($v8c7dd922ad47494fc02c388e12c00eac)) {if($v8c7dd922ad47494fc02c388e12c00eac->getIsBroken() == false) {$this->flush ("<script type=\"text/javascript\">parent.cifi_load_images ('".$vf6396dc21d306e53108617868371a7cc."');</script>", 'text/html');}else {$this->flush ("<script type=\"text/javascript\">alert ('" . getLabel('error-upload-broken') . ");</script>", 'text/html');}}else {$this->flush ("<script type=\"text/javascript\">alert ('" . getLabel('error-upload-error') . "');</script>", 'text/html');}}elseif (strlen(getRequest('crate_dir'))) {$v954eef6d6eac59aca304b6d7abb4fb3e = getRequest ('dirname');$v2d5ec04ac614a2ce7db2e49fce18670c = $v736007832d2167baaae763fd3a3f3cf1;$v6046e73c04f0b0aade5513f5e373fc38 = base64_decode ($vf6396dc21d306e53108617868371a7cc);$v954eef6d6eac59aca304b6d7abb4fb3e = translit::convert ($v954eef6d6eac59aca304b6d7abb4fb3e);if (substr ($v2d5ec04ac614a2ce7db2e49fce18670c, strlen($v2d5ec04ac614a2ce7db2e49fce18670c)-1) == "/") $v2d5ec04ac614a2ce7db2e49fce18670c = substr ($v2d5ec04ac614a2ce7db2e49fce18670c, 0, strlen ($v2d5ec04ac614a2ce7db2e49fce18670c)-1);$v2d5ec04ac614a2ce7db2e49fce18670c = $v2d5ec04ac614a2ce7db2e49fce18670c.'/'.$v6046e73c04f0b0aade5513f5e373fc38;if (is_writable ($v2d5ec04ac614a2ce7db2e49fce18670c)) {umask (0000);if (mkdir ($v2d5ec04ac614a2ce7db2e49fce18670c.'/'.$v954eef6d6eac59aca304b6d7abb4fb3e, 0777)) {$this->flush ("<script type=\"text/javascript\">parent.cifi_load_images ('".$vf6396dc21d306e53108617868371a7cc."');</script>", 'text/html');}else {$this->flush ("<script type=\"text/javascript\">alert ('" . getLabel('error-upload-directory-create') . "');</script>", 'text/html');}}else {$this->flush ("<script type=\"text/javascript\">alert ('" . getLabel('error-upload-directory-perms') . "');</script>", 'text/html');}}}public function get_editable_region() {$v59a814aa020a1b32c4674a5887a35022 = getRequest('param0');$v46b9e6004c49d9cc040029c197cab278 = getRequest('param1');$v23f1965fed119e884f1e62d5ffe76ee3 = (bool) getRequest('is_object');$v5891da2d64975cae48d175d1e001f5da = umiObjectsCollection::getInstance();$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();$v9ce5de356e0bd3ea65ee167fd50db874 = ($v23f1965fed119e884f1e62d5ffe76ee3) ? $v5891da2d64975cae48d175d1e001f5da->getObject($v59a814aa020a1b32c4674a5887a35022) : $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v59a814aa020a1b32c4674a5887a35022);$ve9ffb1d6bce8eb08699ccfbf4b76b565 = false;$permissions = permissionsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $permissions->getUserId();if($v8e44f0089b076e18a718eb9ca3d94674 != 14) {if($v23f1965fed119e884f1e62d5ffe76ee3) {$ve9ffb1d6bce8eb08699ccfbf4b76b565 = !($v9ce5de356e0bd3ea65ee167fd50db874->getOwnerId() == $v8e44f0089b076e18a718eb9ca3d94674);if($ve9ffb1d6bce8eb08699ccfbf4b76b565) {$va8cfde6331bd59eb2ac96f8911c4b666 = selector::get('object')->id($v59a814aa020a1b32c4674a5887a35022);$v22884db148f0ffb0d830ba431102b0b5 = $va8cfde6331bd59eb2ac96f8911c4b666->getModule();$vea9f6aca279138c58f705c8d4cb4b8ce = $va8cfde6331bd59eb2ac96f8911c4b666->getMethod();if($v22884db148f0ffb0d830ba431102b0b5 && $vea9f6aca279138c58f705c8d4cb4b8ce) {$ve9ffb1d6bce8eb08699ccfbf4b76b565 = !$permissions->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);}}}else {list($v4b43b0aee35624cd95b910189b3dc231, $vf1290186a5d0b1ceab27f4e77c0c5d68) = $permissions->isAllowedObject($v8e44f0089b076e18a718eb9ca3d94674, $v59a814aa020a1b32c4674a5887a35022);if(!$vf1290186a5d0b1ceab27f4e77c0c5d68) $ve9ffb1d6bce8eb08699ccfbf4b76b565 = true;}}if($ve9ffb1d6bce8eb08699ccfbf4b76b565) {throw new publicAdminException(getLabel('error-no-permissions'));}$result = false;if ($v9ce5de356e0bd3ea65ee167fd50db874) {switch($v46b9e6004c49d9cc040029c197cab278) {case "name":      $result = array('name' => $v9ce5de356e0bd3ea65ee167fd50db874->name);break;default:      $vd82f268d5a82fc66260ad083d1a2e5b4 = (!$v23f1965fed119e884f1e62d5ffe76ee3)? $v9ce5de356e0bd3ea65ee167fd50db874->getObject() : $v9ce5de356e0bd3ea65ee167fd50db874;$v23a5b8ab834cb5140fa6665622eb6417 = $vd82f268d5a82fc66260ad083d1a2e5b4->getPropByName($v46b9e6004c49d9cc040029c197cab278);if (!$v23a5b8ab834cb5140fa6665622eb6417 instanceof umiObjectProperty) {throw new publicAdminException(getLabel('error-property-not-exists'));}$result = array('property' => $v23a5b8ab834cb5140fa6665622eb6417);translatorWrapper::get($vd82f268d5a82fc66260ad083d1a2e5b4->getPropByName($v46b9e6004c49d9cc040029c197cab278));umiObjectPropertyWrapper::$showEmptyFields = true;}}if (!is_array($result)) {throw new publicAdminException(getLabel('error-entity-not-exists'));}$this->setData($result);return $this->doData();}public function save_editable_region() {$v26aabb51ef95b9eaf9b45952dbeb5ffa = getRequest('param0');$vf2828b93bb0f93033bcbeefd412506b4 = getRequest('param1');$v9a0364b9e99bb480dd25e1f0284c8555 = getRequest('data');$v737cc1a52200219e6987fd70dc48172f = (bool) getRequest('is_object');if (is_array($v9a0364b9e99bb480dd25e1f0284c8555) && count($v9a0364b9e99bb480dd25e1f0284c8555) == 1) {$v9a0364b9e99bb480dd25e1f0284c8555 = $v9a0364b9e99bb480dd25e1f0284c8555[0];}else if(is_array($v9a0364b9e99bb480dd25e1f0284c8555) && isset($v9a0364b9e99bb480dd25e1f0284c8555[0])) {$v3d801aa532c1cec3ee82d87a99fdf63f = array();foreach($v9a0364b9e99bb480dd25e1f0284c8555 as $v447b7147e84be512208dcc0995d67ebc) {$v3d801aa532c1cec3ee82d87a99fdf63f[] = $v447b7147e84be512208dcc0995d67ebc[0];}$v9a0364b9e99bb480dd25e1f0284c8555 = $v3d801aa532c1cec3ee82d87a99fdf63f;}$v9ce5de356e0bd3ea65ee167fd50db874 = ($v737cc1a52200219e6987fd70dc48172f) ? umiObjectsCollection::getInstance()->getObject($v26aabb51ef95b9eaf9b45952dbeb5ffa) : umiHierarchy::getInstance()->getElement($v26aabb51ef95b9eaf9b45952dbeb5ffa);$ve9ffb1d6bce8eb08699ccfbf4b76b565 = false;$permissions = permissionsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $permissions->getUserId();if($v8e44f0089b076e18a718eb9ca3d94674 != 14) {if($v737cc1a52200219e6987fd70dc48172f) {$ve9ffb1d6bce8eb08699ccfbf4b76b565 = !($v9ce5de356e0bd3ea65ee167fd50db874->getOwnerId() == $v8e44f0089b076e18a718eb9ca3d94674);if($ve9ffb1d6bce8eb08699ccfbf4b76b565) {$va8cfde6331bd59eb2ac96f8911c4b666 = selector::get('object')->id($v26aabb51ef95b9eaf9b45952dbeb5ffa);$v22884db148f0ffb0d830ba431102b0b5 = $va8cfde6331bd59eb2ac96f8911c4b666->getModule();$vea9f6aca279138c58f705c8d4cb4b8ce = $va8cfde6331bd59eb2ac96f8911c4b666->getMethod();if($v22884db148f0ffb0d830ba431102b0b5 && $vea9f6aca279138c58f705c8d4cb4b8ce) {$ve9ffb1d6bce8eb08699ccfbf4b76b565 = !$permissions->isAllowedMethod($v8e44f0089b076e18a718eb9ca3d94674, $v22884db148f0ffb0d830ba431102b0b5, $vea9f6aca279138c58f705c8d4cb4b8ce);}}}else {list($v4b43b0aee35624cd95b910189b3dc231, $vf1290186a5d0b1ceab27f4e77c0c5d68) = $permissions->isAllowedObject($v8e44f0089b076e18a718eb9ca3d94674, $v26aabb51ef95b9eaf9b45952dbeb5ffa);if(!$vf1290186a5d0b1ceab27f4e77c0c5d68) $ve9ffb1d6bce8eb08699ccfbf4b76b565 = true;}}if($ve9ffb1d6bce8eb08699ccfbf4b76b565) {throw new publicAdminException(getLabel('error-no-permissions'));}if($v9ce5de356e0bd3ea65ee167fd50db874 instanceof iUmiHierarchyElement) {$v821e7e537d184629175f2179b1588f2a = backupModel::getInstance();$v821e7e537d184629175f2179b1588f2a->addLogMessage($v9ce5de356e0bd3ea65ee167fd50db874->getId());}if($v737cc1a52200219e6987fd70dc48172f && $vf2828b93bb0f93033bcbeefd412506b4 == 'is_activated') {$permissions = permissionsCollection::getInstance();$v8e44f0089b076e18a718eb9ca3d94674 = $permissions->getUserId();$v92ad7554e2e0d208f33729db6d54b59b = $permissions->getGuestId();if($v26aabb51ef95b9eaf9b45952dbeb5ffa == SV_USER_ID) {throw new publicAdminException(getLabel('error-users-swtich-activity-sv'));}if($v26aabb51ef95b9eaf9b45952dbeb5ffa == $v92ad7554e2e0d208f33729db6d54b59b) {throw new publicAdminException(getLabel('error-users-swtich-activity-guest'));}if($v26aabb51ef95b9eaf9b45952dbeb5ffa == $v8e44f0089b076e18a718eb9ca3d94674) {throw new publicAdminException(getLabel('error-users-swtich-activity-self'));}}$v6502ab91a5e6c9cba48c8e80e8a02cbd = "";if ($v9ce5de356e0bd3ea65ee167fd50db874) {$v77fef9afd770da5b920e83a66f981f47 = umiObjectProperty::$IGNORE_FILTER_INPUT_STRING;umiObjectProperty::$IGNORE_FILTER_INPUT_STRING = true;$vd82f268d5a82fc66260ad083d1a2e5b4 = (!$v737cc1a52200219e6987fd70dc48172f)? $v9ce5de356e0bd3ea65ee167fd50db874->getObject() : $v9ce5de356e0bd3ea65ee167fd50db874;$v0382b9fd9ef50b6a335f35e0aaaebf99 = null;try  {if($vf2828b93bb0f93033bcbeefd412506b4 == 'name') {if (is_string($v9a0364b9e99bb480dd25e1f0284c8555) && strlen($v9a0364b9e99bb480dd25e1f0284c8555)) {$v0382b9fd9ef50b6a335f35e0aaaebf99 = $v9ce5de356e0bd3ea65ee167fd50db874->name;$v9ce5de356e0bd3ea65ee167fd50db874->name = $v9a0364b9e99bb480dd25e1f0284c8555;if($v9ce5de356e0bd3ea65ee167fd50db874 instanceof iUmiHierarchyElement) {$v9ce5de356e0bd3ea65ee167fd50db874->h1 = $v9a0364b9e99bb480dd25e1f0284c8555;}}$result = array('name' => $v9a0364b9e99bb480dd25e1f0284c8555);}else {$v1a8db4c996d8ed8289da5f957879ab94 = $vd82f268d5a82fc66260ad083d1a2e5b4->getPropByName($vf2828b93bb0f93033bcbeefd412506b4);if($v1a8db4c996d8ed8289da5f957879ab94->getDataType() == 'date') {$v5fc732311905cb27e82d67f4f6511f7f = new umiDate();$v5fc732311905cb27e82d67f4f6511f7f->setDateByString($v9a0364b9e99bb480dd25e1f0284c8555);$v9a0364b9e99bb480dd25e1f0284c8555 = $v5fc732311905cb27e82d67f4f6511f7f;}$v0382b9fd9ef50b6a335f35e0aaaebf99 = $v9ce5de356e0bd3ea65ee167fd50db874->getValue($vf2828b93bb0f93033bcbeefd412506b4);$v9ce5de356e0bd3ea65ee167fd50db874->setValue($vf2828b93bb0f93033bcbeefd412506b4, $v9a0364b9e99bb480dd25e1f0284c8555);if($v9ce5de356e0bd3ea65ee167fd50db874 instanceof iUmiHierarchyElement && $vf2828b93bb0f93033bcbeefd412506b4 == 'h1') {$v9ce5de356e0bd3ea65ee167fd50db874->name = $v9a0364b9e99bb480dd25e1f0284c8555;}$result = array('property' => $v1a8db4c996d8ed8289da5f957879ab94);translatorWrapper::get($v1a8db4c996d8ed8289da5f957879ab94);umiObjectPropertyWrapper::$showEmptyFields = true;}}catch (fieldRestrictionException $ve1671797c52e15f763380b45e841ec32) {throw new publicAdminException($ve1671797c52e15f763380b45e841ec32->getMessage());}$v9ce5de356e0bd3ea65ee167fd50db874->commit();umiObjectProperty::$IGNORE_FILTER_INPUT_STRING = $v77fef9afd770da5b920e83a66f981f47;$vd82f268d5a82fc66260ad083d1a2e5b4->update();$v9ce5de356e0bd3ea65ee167fd50db874->update();if($v9ce5de356e0bd3ea65ee167fd50db874 instanceof umiEntinty) {$v9ce5de356e0bd3ea65ee167fd50db874->commit();}$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("systemModifyPropertyValue");$v4119639092e62c55ea8be348e4d9260d->addRef("entity", $v9ce5de356e0bd3ea65ee167fd50db874);$v4119639092e62c55ea8be348e4d9260d->setParam("property", $vf2828b93bb0f93033bcbeefd412506b4);$v4119639092e62c55ea8be348e4d9260d->setParam("oldValue", $v0382b9fd9ef50b6a335f35e0aaaebf99);$v4119639092e62c55ea8be348e4d9260d->setParam("newValue", $v9a0364b9e99bb480dd25e1f0284c8555);$v4119639092e62c55ea8be348e4d9260d->setMode("after");$v4119639092e62c55ea8be348e4d9260d->call();$this->setData($result);return $this->doData();}}public function json_uf() {$v736007832d2167baaae763fd3a3f3cf1 = getRequest('dir');$vb2145aac704ce76dbe1ac7adac535b23 = getRequest('var');if($vb2145aac704ce76dbe1ac7adac535b23) {$v8c7dd922ad47494fc02c388e12c00eac = umiImageFile::upload("pics", $vb2145aac704ce76dbe1ac7adac535b23, $v736007832d2167baaae763fd3a3f3cf1);if(is_object($v8c7dd922ad47494fc02c388e12c00eac)) {if($v8c7dd922ad47494fc02c388e12c00eac->getIsBroken() == false) {header("Content-type: text/xml; charset=utf-8");echo file_get_contents("ufs://" . $v8c7dd922ad47494fc02c388e12c00eac->getFilePath());exit();}}}header("Content-type: text/xml; charset=utf-8");echo file_get_contents("ufs://" . $v736007832d2167baaae763fd3a3f3cf1);exit();}public function filterString($vb45cffe084dd3d20d928bee85e7b0f21) {return str_replace("\"", "\\\"", str_replace("'", "\'", $vb45cffe084dd3d20d928bee85e7b0f21));}public function load_tree_node() {$this->setDataType("list");$this->setActionType("view");$v8be74552df93e31bbdd6b36ed74bdb6a = new selector('pages');selectorHelper::detectFilters($v8be74552df93e31bbdd6b36ed74bdb6a);$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v8be74552df93e31bbdd6b36ed74bdb6a->result, "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc, $v8be74552df93e31bbdd6b36ed74bdb6a->length);return $this->doData();}public function tree_set_activity() {$v6a7f245843454cf4f28ad7c5e2572aa2 = getRequest('element');if(!is_array($v6a7f245843454cf4f28ad7c5e2572aa2)) {$v6a7f245843454cf4f28ad7c5e2572aa2 = Array($v6a7f245843454cf4f28ad7c5e2572aa2);}$vc76a5e84e4bdee527e274ea30c680d79 = getRequest('active');if (!is_null($vc76a5e84e4bdee527e274ea30c680d79)) {foreach($v6a7f245843454cf4f28ad7c5e2572aa2 as $v7552cd149af7495ee7d8225974e50f80) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->expectElement($v7552cd149af7495ee7d8225974e50f80, false, true);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$vc76a5e84e4bdee527e274ea30c680d79 = intval($vc76a5e84e4bdee527e274ea30c680d79) > 0 ? true : false;$v21ffce5b8a6cc8cc6a41448dd69623c9 = Array(       "element" => $v8e2dcfd7e7e24b1ca76c1193f645902b,       "activity" => $vc76a5e84e4bdee527e274ea30c680d79      );$this->switchActivity($v21ffce5b8a6cc8cc6a41448dd69623c9);}else {throw new publicAdminException(getLabel('error-expect-element'));}}$this->setDataType("list");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v6a7f245843454cf4f28ad7c5e2572aa2, "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}else {throw new publicAdminException(getLabel('error-expect-action'));}}public function tree_move_element() {$v8e2dcfd7e7e24b1ca76c1193f645902b =  $this->expectElement("element");$vbfa030fe63bacd523dd70a76cfaed98a = (int) getRequest("rel");$vad5f82e879a9c5d6b5b442eb37e50551 = getRequest('domain');$v6f7271d2b14630f80718ba10635b034e = (int) getRequest('as-sibling');$v2862c7667bfa3eb6b4c6fa1de2bd8826 = getRequest('before');if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$vc02811e4c4fdd0b3549131ca8a2c74d1 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();$v21ffce5b8a6cc8cc6a41448dd69623c9 = array(     "element" => $v8e2dcfd7e7e24b1ca76c1193f645902b,     "parent-id" => $vbfa030fe63bacd523dd70a76cfaed98a,     "domain" => $vad5f82e879a9c5d6b5b442eb37e50551,     "as-sibling" => $v6f7271d2b14630f80718ba10635b034e,     "before-id" => $v2862c7667bfa3eb6b4c6fa1de2bd8826    );$this->moveElement($v21ffce5b8a6cc8cc6a41448dd69623c9);}else {throw new publicAdminException(getLabel('error-expect-element'));}$this->setDataType("list");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData(array($v8e2dcfd7e7e24b1ca76c1193f645902b->getId(), $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId(), $vc02811e4c4fdd0b3549131ca8a2c74d1), "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function tree_delete_element() {$v6a7f245843454cf4f28ad7c5e2572aa2 = getRequest('element');if(!is_array($v6a7f245843454cf4f28ad7c5e2572aa2)) {$v6a7f245843454cf4f28ad7c5e2572aa2 = Array($v6a7f245843454cf4f28ad7c5e2572aa2);}$v952915df58ec9bb4591e820dc1f3b9c8 = Array();foreach($v6a7f245843454cf4f28ad7c5e2572aa2 as $v7552cd149af7495ee7d8225974e50f80) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->expectElement($v7552cd149af7495ee7d8225974e50f80, false, true, true);if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$v7057e8409c7c531a1a6e9ac3df4ed549 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getId();$v952915df58ec9bb4591e820dc1f3b9c8[] = $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId();$v161c9aaa4fe035e7b2f465bc59f3ab45 = new umiEventPoint("content_del_element");$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("before");$v161c9aaa4fe035e7b2f465bc59f3ab45->setParam("element_id", $v7057e8409c7c531a1a6e9ac3df4ed549);$v161c9aaa4fe035e7b2f465bc59f3ab45->addRef("answer", $v4ad0c7da90b1585531ed14d10ae57987);$this->setEventPoint($v161c9aaa4fe035e7b2f465bc59f3ab45);$v21ffce5b8a6cc8cc6a41448dd69623c9 = Array(      "element" => $v8e2dcfd7e7e24b1ca76c1193f645902b     );$this->deleteElement($v21ffce5b8a6cc8cc6a41448dd69623c9);$v161c9aaa4fe035e7b2f465bc59f3ab45->setMode("after");$this->setEventPoint($v161c9aaa4fe035e7b2f465bc59f3ab45);}else {throw new publicAdminException(getLabel('error-expect-element'));}}$v952915df58ec9bb4591e820dc1f3b9c8 = array_unique($v952915df58ec9bb4591e820dc1f3b9c8);$this->setDataType("list");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v952915df58ec9bb4591e820dc1f3b9c8, "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function tree_copy_element() {$v8e2dcfd7e7e24b1ca76c1193f645902b =  $this->expectElement("element");$vfab9b630c6e62a5683e75b3072f935b1 = (bool) getRequest('clone_mode');$v287349d5bcc67de9950e5257e92e2277 = (bool) getRequest('copy_all');$v777ccf80e4e83a9e7cdddd6ebc1edff7 = false;if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$v7057e8409c7c531a1a6e9ac3df4ed549 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getId();$v6be379826b20cc58475f636e33f4606b = umiHierarchy::getInstance()->getParent($v7057e8409c7c531a1a6e9ac3df4ed549);if((defined("DB_DRIVER") && DB_DRIVER != "xml") || (!defined("DB_DRIVER"))) {mysql_query("START TRANSACTION");}if ($vfab9b630c6e62a5683e75b3072f935b1) {$va7eb1dd61c4492eb83873abe40b5ee95 = true;if(defined("CURRENT_VERSION_LINE") && CURRENT_VERSION_LINE == "free") {$v27d4ed1517de0332d56073976b5611d6 = umiHierarchy::getInstance()->getElementsCount("content");$vf8fd0c88f22095d75867e82d488e7f15 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getModule();if ($v27d4ed1517de0332d56073976b5611d6 >= 10 && $vf8fd0c88f22095d75867e82d488e7f15 == "content") {$va7eb1dd61c4492eb83873abe40b5ee95 = false;throw new publicAdminException(getLabel('error-free-max-pages'));}}if ($va7eb1dd61c4492eb83873abe40b5ee95) {$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("systemCloneElement");$v4119639092e62c55ea8be348e4d9260d->setParam("elementId", $v7057e8409c7c531a1a6e9ac3df4ed549);$v4119639092e62c55ea8be348e4d9260d->setParam("parentId", $v6be379826b20cc58475f636e33f4606b);$v4119639092e62c55ea8be348e4d9260d->setMode("before");$v4119639092e62c55ea8be348e4d9260d->call();$v777ccf80e4e83a9e7cdddd6ebc1edff7 = umiHierarchy::getInstance()->cloneElement($v7057e8409c7c531a1a6e9ac3df4ed549, $v6be379826b20cc58475f636e33f4606b, $v287349d5bcc67de9950e5257e92e2277);$v4119639092e62c55ea8be348e4d9260d->setParam("newElementId", $v777ccf80e4e83a9e7cdddd6ebc1edff7);$v4119639092e62c55ea8be348e4d9260d->setMode("after");$v4119639092e62c55ea8be348e4d9260d->call();}}else {$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint("systemVirtualCopyElement");$v4119639092e62c55ea8be348e4d9260d->setParam("elementId", $v7057e8409c7c531a1a6e9ac3df4ed549);$v4119639092e62c55ea8be348e4d9260d->setParam("parentId", $v6be379826b20cc58475f636e33f4606b);$v4119639092e62c55ea8be348e4d9260d->setMode("before");$v4119639092e62c55ea8be348e4d9260d->call();$v777ccf80e4e83a9e7cdddd6ebc1edff7 = umiHierarchy::getInstance()->copyElement($v7057e8409c7c531a1a6e9ac3df4ed549, $v6be379826b20cc58475f636e33f4606b, $v287349d5bcc67de9950e5257e92e2277);$v4119639092e62c55ea8be348e4d9260d->setParam("newElementId", $v7057e8409c7c531a1a6e9ac3df4ed549);$v4119639092e62c55ea8be348e4d9260d->setMode("after");$v4119639092e62c55ea8be348e4d9260d->call();}if ($v777ccf80e4e83a9e7cdddd6ebc1edff7) {$this->setDataType("list");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData(array($v777ccf80e4e83a9e7cdddd6ebc1edff7), "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc);if((defined("DB_DRIVER") && DB_DRIVER != "xml") || (!defined("DB_DRIVER"))) {mysql_query("COMMIT");}return $this->doData();}else {throw new publicAdminException(getLabel('error-copy-element'));}}else {throw new publicAdminException(getLabel('error-expect-element'));}}public function tree_unlock_page() {$va6eb4816205178e88dad66a16a19ff45 = getRequest("param0");$this->unlockPage($va6eb4816205178e88dad66a16a19ff45);$result = "<"."?xml version=\"1.0\" encoding=\"utf-8\"?"."> \n";$result.= "<is_unlocked>true</is_unlocked> \n";header("Content-type: text/xml; charset=utf-8");$this->flush($result);}public function json_unlock_page() {$this->tree_unlock_page();}public function move_to_lang() {$vf585b7f018bb4ced15a03683a733e50b = (int) getRequest('lang-id');$v6a7f245843454cf4f28ad7c5e2572aa2 = getRequest('element');if(!is_array($v6a7f245843454cf4f28ad7c5e2572aa2)) {$v6a7f245843454cf4f28ad7c5e2572aa2 = Array($v6a7f245843454cf4f28ad7c5e2572aa2);}if (!is_null($vf585b7f018bb4ced15a03683a733e50b)) {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();foreach($v6a7f245843454cf4f28ad7c5e2572aa2 as $v7552cd149af7495ee7d8225974e50f80) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->expectElement($v7552cd149af7495ee7d8225974e50f80, false, true);if($v8e2dcfd7e7e24b1ca76c1193f645902b->getLangId() != $vf585b7f018bb4ced15a03683a733e50b || true) {$vbf4e450fde0ab94a476b942a53cfd5b1 = $vb81ca7c0ccaa77e7aa91936ab0070695->cloneElement($v8e2dcfd7e7e24b1ca76c1193f645902b->getId(), 0, true);$v419f96b8efb1854d0ac97a8e55ce9095 = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($vbf4e450fde0ab94a476b942a53cfd5b1);if($v419f96b8efb1854d0ac97a8e55ce9095 instanceof umiHierarchyElement) {$v419f96b8efb1854d0ac97a8e55ce9095->setLangId($vf585b7f018bb4ced15a03683a733e50b);$v419f96b8efb1854d0ac97a8e55ce9095->commit();$vadce578d04ed03c31f6ac59451fcf8e4 = $vb81ca7c0ccaa77e7aa91936ab0070695->getChilds($vbf4e450fde0ab94a476b942a53cfd5b1);self::changeChildsLang($vadce578d04ed03c31f6ac59451fcf8e4, $vf585b7f018bb4ced15a03683a733e50b);}}}}$this->setDataType("list");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData(array(), "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}protected function changeChildsLang($vadce578d04ed03c31f6ac59451fcf8e4, $vf585b7f018bb4ced15a03683a733e50b) {$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();foreach($vadce578d04ed03c31f6ac59451fcf8e4 as $v7552cd149af7495ee7d8225974e50f80 => $vfc1ffe8d09ab27b76cfc18050b7edbe9) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v7552cd149af7495ee7d8225974e50f80);if($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof umiHierarchyElement) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setLangId($vf585b7f018bb4ced15a03683a733e50b);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();if(is_array($vfc1ffe8d09ab27b76cfc18050b7edbe9) && sizeof($vfc1ffe8d09ab27b76cfc18050b7edbe9))  {self::changeChildsLang($vfc1ffe8d09ab27b76cfc18050b7edbe9, $vf585b7f018bb4ced15a03683a733e50b);}}}}};?>

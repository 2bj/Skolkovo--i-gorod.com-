<?php
 class umiHierarchyTypesCollection extends singleton implements iSingleton, iUmiHierarchyTypesCollection {private $types;protected function __construct() {$this->loadTypes();}public static function getInstance() {return parent::getInstance(__CLASS__);}public function getType($v94757cae63fd3e398c0811a976dd6bbe) {if($this->isExists($v94757cae63fd3e398c0811a976dd6bbe)) {return $this->types[$v94757cae63fd3e398c0811a976dd6bbe];}else {return false;}}public function getTypeByName($vb068931cc450442b63f5b3d276ea4297, $vabf77184f55403d75b9d51d79162a7ca = false) {if($vb068931cc450442b63f5b3d276ea4297 == 'content' and $vabf77184f55403d75b9d51d79162a7ca == 'page') $vabf77184f55403d75b9d51d79162a7ca = false;foreach($this->types as $v599dcce2998a6b40b1e38e8c6006cb0a) {if($v599dcce2998a6b40b1e38e8c6006cb0a->getName() == $vb068931cc450442b63f5b3d276ea4297 && !$vabf77184f55403d75b9d51d79162a7ca) return $v599dcce2998a6b40b1e38e8c6006cb0a;if($v599dcce2998a6b40b1e38e8c6006cb0a->getName() == $vb068931cc450442b63f5b3d276ea4297 && $v599dcce2998a6b40b1e38e8c6006cb0a->getExt() == $vabf77184f55403d75b9d51d79162a7ca && $vabf77184f55403d75b9d51d79162a7ca) return $v599dcce2998a6b40b1e38e8c6006cb0a;}return false;}public function addType($vb068931cc450442b63f5b3d276ea4297, $vd5d3db1765287eef77d7927cc956f50a, $vabf77184f55403d75b9d51d79162a7ca = "") {$this->disableCache();cacheFrontend::getInstance()->flush();if($vb946c44d711ade3b061653732977d043  = $this->getTypeByName($vb068931cc450442b63f5b3d276ea4297, $vabf77184f55403d75b9d51d79162a7ca)) {$vb946c44d711ade3b061653732977d043->setTitle($vd5d3db1765287eef77d7927cc956f50a);return $vb946c44d711ade3b061653732977d043->getId();}$v32409b63878fa9d5541998646b533159 = mysql_real_escape_string($vb068931cc450442b63f5b3d276ea4297);$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms3_hierarchy_types (name) VALUES('{$v32409b63878fa9d5541998646b533159}')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$v94757cae63fd3e398c0811a976dd6bbe = mysql_insert_id();$v599dcce2998a6b40b1e38e8c6006cb0a = new umiHierarchyType($v94757cae63fd3e398c0811a976dd6bbe);$v599dcce2998a6b40b1e38e8c6006cb0a->setName($vb068931cc450442b63f5b3d276ea4297);$v599dcce2998a6b40b1e38e8c6006cb0a->setTitle($vd5d3db1765287eef77d7927cc956f50a);$v599dcce2998a6b40b1e38e8c6006cb0a->setExt($vabf77184f55403d75b9d51d79162a7ca);$v599dcce2998a6b40b1e38e8c6006cb0a->commit();$this->types[$v94757cae63fd3e398c0811a976dd6bbe] = $v599dcce2998a6b40b1e38e8c6006cb0a;return $v94757cae63fd3e398c0811a976dd6bbe;}public function delType($v94757cae63fd3e398c0811a976dd6bbe) {$this->disableCache();cacheFrontend::getInstance()->flush();if($this->isExists($v94757cae63fd3e398c0811a976dd6bbe)) {unset($this->types[$v94757cae63fd3e398c0811a976dd6bbe]);$v94757cae63fd3e398c0811a976dd6bbe = (int) $v94757cae63fd3e398c0811a976dd6bbe;$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms3_hierarchy_types WHERE id = '{$v94757cae63fd3e398c0811a976dd6bbe}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);return true;}else {return false;}}public function isExists($v5f694956811487225d15e973ca38fbab) {if($v5f694956811487225d15e973ca38fbab === false) return false;return (bool) array_key_exists($v5f694956811487225d15e973ca38fbab, $this->types);}private function loadTypes() {$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();$vda80b9ab86c2d00b85de0cf003cb3e6e = $vb99eb979e6f6efabc396f777b503f7e7->loadData('hierarchy_types');if(!is_array($vda80b9ab86c2d00b85de0cf003cb3e6e)) {$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT SQL_CACHE `id`, `name`, `title`, `ext` FROM `cms3_hierarchy_types` ORDER BY `name`, `ext`";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$vda80b9ab86c2d00b85de0cf003cb3e6e = array();while(list($vb80bb7740288fda1f201890375a60c8f) = $vf1965a857bc285d26fe22023aa5ab50d = mysql_fetch_row($result)) {$vda80b9ab86c2d00b85de0cf003cb3e6e[$vb80bb7740288fda1f201890375a60c8f] = $vf1965a857bc285d26fe22023aa5ab50d;}$vb99eb979e6f6efabc396f777b503f7e7->saveData('hierarchy_types', $vda80b9ab86c2d00b85de0cf003cb3e6e, 3600);}foreach($vda80b9ab86c2d00b85de0cf003cb3e6e as $vb80bb7740288fda1f201890375a60c8f => $vf1965a857bc285d26fe22023aa5ab50d) {$v599dcce2998a6b40b1e38e8c6006cb0a = $vb99eb979e6f6efabc396f777b503f7e7->load($vb80bb7740288fda1f201890375a60c8f, 'element_type');if($v599dcce2998a6b40b1e38e8c6006cb0a instanceof iUmiHierarchyType == false) {try {$v599dcce2998a6b40b1e38e8c6006cb0a = new umiHierarchyType($vb80bb7740288fda1f201890375a60c8f, $vf1965a857bc285d26fe22023aa5ab50d);}catch (privateException $ve1671797c52e15f763380b45e841ec32) {continue;}$vb99eb979e6f6efabc396f777b503f7e7->save($v599dcce2998a6b40b1e38e8c6006cb0a, 'element_type');}$this->types[$vb80bb7740288fda1f201890375a60c8f] = $v599dcce2998a6b40b1e38e8c6006cb0a;}return true;}public function getTypesList() {return $this->types;}}?>
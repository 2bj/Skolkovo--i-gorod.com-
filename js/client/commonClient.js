function getCurrSelection(){if(document.selection){return document.selection}else{return window.getSelection()}}function getRange(a){if(!a){a=getSelection()}if(typeof a!="undefined"){return a.getRangeAt(0)}else{return window.document.createRange()}}function hasParent(b,a){if(!b){return false}if(b.id==a){return true}else{if(b.parentNode){return hasParent(b.parentNode,a)}else{return false}}}function trim(b){var a=b.replace(/^\s+/,"");return a.replace(/\s+$/,"")}function gen_popup(d,b,a,c){if(!c){c=""}win=window.open("","_blank","width="+(b)+",height="+(a)+",titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no");win.document.write("<html><head><title>"+c+"</title></head><body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0><table style='height: 100%' cellspacing='0' cellpadding='0' border='0'><tr><td valgin='middle'>");win.document.write('<script>document.title = "'+c+'";\r\nfunction _CloseOnEsc(e) {if(e){ event = e;} if (event.keyCode == 27) { window.close(); return; }} document.onkeydown = _CloseOnEsc;<\/script>');win.document.write('<img src="'+d+'" onclick="javascript: window.close();" style="cursor: pointer;" />');win.document.write("</td></tr></table></body></html>");win.document.close();return false}function getPageSizes(){var a,e;if(window.innerHeight&&window.scrollMaxY){a=document.body.scrollWidth;e=window.innerHeight+window.scrollMaxY}else{if(document.body.scrollHeight>document.body.offsetHeight){a=document.body.scrollWidth;e=document.body.scrollHeight}else{a=document.body.offsetWidth;e=document.body.offsetHeight}}var b,c;if(self.innerHeight){b=self.innerWidth;c=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){b=document.documentElement.clientWidth;c=document.documentElement.clientHeight}else{if(document.body){b=document.body.clientWidth;c=document.body.clientHeight}}}if(e<c){iPageHeight=c}else{iPageHeight=e}if(a<b){iPageWidth=b}else{iPageWidth=a}var d=new Array(iPageWidth,iPageHeight,b,c);return d}function setCookie(a,b){document.cookie=a+"="+escape(b)+"; path=/"}function getCookie(c){c=c.replace(/\./g,"_");var d=0;var a=0;var b=0;var e=document.cookie;while(d<=e.length){a=d;b=a+c.length;if(e.substring(a,b)==c){a=b+1;b=document.cookie.indexOf(";",a);if(b<a){b=document.cookie.length}return document.cookie.substring(a,b);break}d++}return""}function catalog_addToCompare(h,k,b,f){var d=0,e;while(e=getCookie("cc_"+h+"_"+(++d))){if(e==k){catalog_renderCompare(h);return true}}setCookie("cc_"+h+"_"+(d),k);setCookie("cc_"+h+"_id_"+k,d);catalog_renderCompare(h);var l=b.parentNode;l.removeChild(b);var g=document.createElement("div");g.innerHTML="<span style='font-size: 10px;'>Добавлено к&nbsp;сравнению</span><br />";var j;if(j=document.getElementById("catalogEarseCompareLink")){var a="/catalog/compare/"+f+"/";var c="javascript: showCompareWindow('"+a+"', '"+h+"'); return false;";g.innerHTML+='(<a href="'+a+'" onclick="'+c+"\" style='font-size: 10px;'><u>Сравнить</u></a>)"}l.appendChild(g)}function catalog_delCompare(e,d){var b=0,a,c=0;a=getCookie("cc_"+e+"_id_"+d);setCookie("cc_"+e+"_"+(a),-1);catalog_renderCompare(e);return false}function catalog_renderCompare(c){var a;if(a=document.getElementById("catalogCompareBlockDiv")){var b="/catalog/compare_block_render/"+c+"/";execInternalScript(b)}else{window.location.reload()}}function catalog_compareCallback(b){var a=document.getElementById("catalogCompareBlockDiv");a.innerHTML=b}function catalog_earseCompare(c){var b=0;while(va=getCookie("cc_"+c+"_"+(++b))){setCookie("cc_"+c+"_"+b,"");if(pobj=document.getElementById("catalogCompareBlockDiv")){var a="/catalog/compare_block_render/"+c+"/";execInternalScript(a)}else{window.location.reload()}}}function eshop_addToCart(b){var a="/eshop/json_add_to_cart/"+b+"/";execInternalScript(a);var c;if(c=document.getElementById("addToCart_txt_"+b)){c.innerHTML='Добавлено в&nbsp;корзину<br /><a href="/eshop/my_cart/">(В&nbsp;корзину)</a>'}}function execInternalScript(b){var a=document.createElement("script");a.src=b;var c=document.body.firstChild;do{if(c.nodeType==1){c.appendChild(a);break}}while(c=c.nextSibling)}function catalog_refreshBasket(b){var a=document.getElementById("eshop_basket");if(!a){return false}a.innerHTML=b}function eshop_cart_numchange(c){var b=c.id;var a="/eshop/json_update_cart/"+b+"/"+c.value;execInternalScript(a)}function callback_cartUpdate(d){var c,e,f,b;for(i=0;i<orders.length;i++){b=orders[i];if(!d[b]){if(f=document.getElementById("orderitem_"+b)){f.parentNode.removeChild(f)}if(f=document.getElementById("orderitem_quant_"+b)){f.parentNode.removeChild(f)}continue}c=d[b][0];e=d[b][1];if(f=document.getElementById("eshop_price_"+b)){f.innerHTML=e}if(f=document.getElementById(b)){f.value=c}}if(f=document.getElementById("eshop_total_price")){f.innerHTML=d.total}if(f=document.getElementById("eshop_order_price")){f.innerHTML=d.order_total}if(f=document.getElementById("eshop_credit_link")){if(d.credit_allowed){f.style.display=""}else{f.style.display="none"}}var a="/eshop/basket_refresh/";execInternalScript(a)}function eshop_cart_removeRow(b){var a="/eshop/json_basket_del/"+b+"/";execInternalScript(a)}function eshop_cart_save(){var a=document.forms.eshop_cart_form;a.submit();return false}function eshop_cart_post(){var a=document.forms.eshop_cart_form;a.action="/eshop/order_do/";a.submit();return false}function showCompareWindow(b,g){var e=600,a=700;var d=0,c;while(c=getCookie("cc_"+g+"_"+(++d))){}var f=window.open(b,"_blank","width="+(e)+",height="+(a)+",titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes");return false}function eshop_cart_credit(){var a=document.forms.eshop_cart_form;a.action="/eshop/credit_prepare/";a.submit();return false}function eshop_cart_numchange_prepare(c){var b=c;var a=function(){eshop_cart_numchange(b)};if(window.timeout){clearTimeout(window.timeout)}window.timeout=setTimeout(a,500)}function eshop_cart_cardnumchange(b){var a="/eshop/json_update_dcard/"+b.value+"/";execInternalScript(a)}function callback_cardnumUpdate(a){var b;if(b=document.getElementById("eshop_dcard_discount")){b.innerHTML=a+"%"}}function eshop_cart_cardnumchange_prepare(c){var b=c;var a=function(){eshop_cart_cardnumchange(b)};if(window.timeout1){clearTimeout(window.timeout1)}window.timeout=setTimeout(a,500)}var rep=new Array();function init_link_stat(){if(!qedit_allowed){return true}var a=document.getElementsByTagName("a");var b;var c="http://"+window.location.host;for(b=0;b<a.length;b++){var d=a.item(b);var e=d.href;e=e.replace(c,"");callStatGrabber(c,e,d)}}function statRespond(a,g,j,e){var d=rep[a];var h=d[2];if(!j||j==0){return false}var c=document.createElement("div");c.style.zIndex=1000;c.style.position="absolute";c.style.border="#000 1px solid";c.style.fontSize="9px";c.style.color="#000";c.style.padding="2px";c.style.backgroundColor="#FFF";c.style.cursor="default";var f=getAbsoluteLocation(h);c.style.left=f.x+parseInt(h.offsetWidth)-(parseInt(h.offsetHeight));c.style.top=f.y+parseInt(h.offsetHeight)/2;c.className="semiOpacity";c.innerHTML=e+"% ("+j+")";var b=chooseRandomPlacer();b.appendChild(c)}function callStatGrabber(b,e,c){var a=rep.length;rep[a]=new Array(b,e,c);var d="/statResponder.php?host="+b+"&href="+window.location.href+"&lnk="+e+"&eventId="+a;attachScript(d)}function attachScript(c){var b=chooseRandomPlacer();var a=document.createElement("script");a.src=c;b.appendChild(a)}function getAbsoluteLocation(d,e){if(!e){e=false}var b=0,a=0;if(!d){return false}var c=d.offsetParent;while(c){b+=c.offsetLeft;a+=c.offsetTop;if(e){if(!this.isIframeChild(c)){break}}c=c.offsetParent}if(this.iframe_pos){b+=this.iframe_pos.x+2;a+=this.iframe_pos.y+2}return{x:b+d.offsetLeft,y:a+d.offsetTop}}function chooseRandomPlacer(){var a=document.body.firstChild;do{if(a.nodeType==1){return a;break}}while(a=a.nextSibling);return false}var last_src="";function cms_vote_postDo(b,a,d){var e=document.getElementsByName(b);var c="";if(e){c=e[e.length-1]}if(typeof(c)!=="object"){return false}iObj=c.elements[a];if(typeof(iObj)==="undefined"){return false}res=false;for(i=0;i<iObj.length;i++){if(iObj[i].checked){res=iObj[i].value}}if(res){sc=document.createElement("script");sc.src="/vote/post/"+res+"/?m="+new Date().getTime();oTemplate=c.elements.system_template;if((oTemplate instanceof Object)&&(oTemplate.value.length)){sc.src=sc.src+"&template="+oTemplate.value}c.appendChild(sc)}else{if(d){alert(d)}}}function rateElement(a,b){lLib.getInstance().makeRequest("/vote/json_rate/"+a+"/"+b+"/",function(){})}function users_check_reg_form(){users_login=document.getElementById("users_login");users_password=document.getElementById("users_password");users_password_check=document.getElementById("users_password_check");users_email=document.getElementById("users_email");if(!users_login||!users_password||!users_password_check||!users_email){alert("Неправильно сформирована форма.");return false}if(users_login.value==""){alert('Необходимо заполнить поле "Логин"');users_login.focus();return false}if(users_password.value==""){alert('Необходимо заполнить поле "Пароль"');users_password.focus();return false}if(users_password.value!=users_password_check.value){alert("Пароли не совпадают.");users_password_check.focus();return false}if(users_email.value==""){alert('Необходимо заполнить поле "E-mail"');users_email.focus();return false}return true}function eshop_subscribe_check(){fname=document.getElementById("fname");lname=document.getElementById("lname");mname=document.getElementById("mname");email=document.getElementById("email");if(fname.value==""){alert('Необходимо заполнить поле "Имя"');fname.focus();return false}if(lname.value==""){alert('Необходимо заполнить поле "Фамилия"');lname.focus();return false}if(mname.value==""){alert('Необходимо заполнить поле "Отчество"');mname.focus();return false}if(email.value==""){alert('Необходимо заполнить поле "E-mail"');email.focus();return false}return true}var Mozilla=(navigator.appName.indexOf("Netscape")!=-1);function forum_check_reg_form(){forum_login=document.getElementById("forum_login");forum_password=document.getElementById("forum_password");forum_password_check=document.getElementById("forum_password_check");forum_email=document.getElementById("forum_email");if(!forum_login||!forum_password||!forum_password_check||!forum_email){alert("Неправильно сформирована форма.");return false}if(forum_login.value==""){alert('Необходимо заполнить поле "Логин"');return false}if(forum_password.value==""){alert('Необходимо заполнить поле "Пароль"');return false}if(forum_password.value!=forum_password_check.value){alert("Пароли не совпадают.");return false}if(forum_email.value==""){alert('Необходимо заполнить поле "E-mail"');return false}return true}function forum_check_form(a){if(!a){return false}if(a.captcha){if(md5(a.captcha.value)!=getCookie("captcha1")){alert("Неправильный код.");return false}}if(a.nickname){vlogin=a.nickname.value}else{vlogin=""}if(a.title){vtitle=a.title.value}else{vtitle=""}if(a.body){vbody=a.body.value}else{vbody=""}if(vlogin.length==0){alert("Введите имя.");return false}if(vtitle.length==0){alert("Введите заголовок.");return false}bd=vbody.replace(/[ \t\r\n]*/g,"");if(bd.length==0){alert("Введите текст сообщения");return false}return true}function forum_quote(b){var a="";mess_obj=document.getElementById("mess_"+b);if(!mess_obj){return false}body_obj=document.getElementById("message");if(!body_obj){return false}if(is_ie){sel=getCurrSelection();range=sel.createRange();sel_str=range.text}else{sel=getCurrSelection();if(sel.rangeCount){range=getRange(sel);sel_str=range}else{sel_str=""}}if(!is_ie){qmess=mess_obj.textContent}else{qmess=mess_obj.outerText}if(sel_str&&typeof sel_str!="undefined"&&qmess){parentObj=range.commonAncestorContainer;if(is_ie){if(qmess.replace(sel_str,"")!=qmess){qmess=sel_str}}else{parentObj=range.commonAncestorContainer;if(hasParent(parentObj,"mess_"+b)){qmess=range}}}res="";real_id=mess_obj.id.substr(5,mess_obj.id.length-5);author_obj=document.getElementById("author_"+real_id);if(author_obj){a=(!Mozilla)?author_obj.innerText:author_obj.textContent;a="[b]"+trim(a)+"[/b]\r\n"}else{a=""}if(qmess){if(body_obj.value.length==0){body_obj.value+="[QUOTE]"+a+qmess+"[/QUOTE]\r\n"}else{body_obj.value+="\r\n[QUOTE]"+a+qmess+"[/QUOTE]\r\n"}}document.getElementById("message").focus();return false}function forum_toAuthor(a){if(is_ie){res=a.innerText}else{res=a.textContent}res=trim(res);res="[b]"+res+"[/b]\r\n";document.getElementById("message").value+=res;window.location="#add";document.getElementById("message").focus();return false}function forum_insert_smile(c,b){if(!c){return}var c=c.firstChild;if(!c){return}var a=c.alt;if(!a){return false}var c=document.getElementById("message");if(!c){c=document.getElementById("forum_body")}if(!c){c=document.getElementById(b)}if(!c){return false}c.value+="[smile:"+a+"] ";c.focus();return true}var lMouseX=0;var lMouseY=0;var lMouseOffsetX=0;var lMouseOffsetY=0;var lMouseObjectId=null;var Mozilla=(navigator.appName.indexOf("Netscape")!=-1);var lMouseHandler_default=function(){};var lMouseHandler=lMouseHandler_default;function mH(a){if(Mozilla){lMouseX=a.pageX;lMouseY=a.pageY}else{lMouseX=event.x;lMouseY=event.y}iMouseX=lMouseX;iMouseY=lMouseY;lMouseHandler()}function set_mouse(){if(Mozilla){}var a=(typeof document.onmousemove=="function")?document.onmousemove:function(){};document.onmousemove=function(b){a(b);mH(b)}}set_mouse();var Mozilla=(navigator.appName.indexOf("Netscape")!=-1);function quickEdit(){var b=(typeof window.onload=="function")?window.onload:function(){};var a=this;window.onload=function(){b();a.init()}}quickEdit.instance=null;quickEdit.getInstance=function(){if(!quickEdit.instance){quickEdit.instance=new quickEdit()}return quickEdit.instance};quickEdit.prototype.placer=null;quickEdit.prototype.containerObj=null;quickEdit.prototype.is_allowed=true;quickEdit.prototype.is_loaded=false;quickEdit.prototype.init=function(){this.placer=lLib.createVoidContainer();this.placer.style.zIndex="10000000";this.draw()};quickEdit.prototype.draw=function(){var c=this.placer;var j="";this.hide();c.style.width="510px";c.style.backgroundColor="#FFF";c.style.padding="1px";c.style.position="absolute";var f=document.createElement("div");f.style.backgroundColor="#FFF";f.style.border="#959A9F 1px solid";f.style.padding="1px";c.appendChild(f);var e=document.createElement("div");e.style.height="15px";e.style.width="100%";e.style.backgroundColor="#EEEFF0";e.style.textAlign="right";f.appendChild(e);var a=document.createElement("div");a.style.cursor="pointer";a.style.fontFamily="Tahoma";a.style.fontSize="11px";a.style["float"]="right";a.style.color="#FFF";a.style.fontWeight="bold";a.style.backgroundColor="#959A9F";a.style.width="15px";a.style.height="15px";a.style.textAlign="center";a.style.cssFloat="right";a.style.styleFloat="right";a.innerHTML="X";var h=this;a.onclick=function(){h.hide()};e.appendChild(a);var d=document.createElement("div");d.style.marginLeft="24px";d.style.marginRight="25px";d.style.marginTop="15px";d.style.marginBottom="15px";f.appendChild(d);var b=document.createElement("div");b.style.margin="0px";b.style.padding="0px";b.style.border="0";b.style.textAlign="left";d.appendChild(b);this.containerObj=b;var g=function(){h.placeCentered()};window.onscroll=g;window.onresize=g;this.placeCentered()};quickEdit.prototype.placeCentered=function(){var d=this.placer;var c=getPageSizes();var b=(c[2]-d.offsetWidth)/2;var a=(c[3]-d.offsetHeight)/2;d.style.left=b+"px";if(document.documentElement&&document.documentElement.scrollTop){d.style.top=a+document.documentElement.scrollTop+"px"}else{d.style.top=a+document.body.scrollTop+"px"}};quickEdit.prototype.show=function(){if(!this.is_loaded){return false}if(this.is_allowed){this.placer.style.display="";this.placer.style.border="red 0px solid";this.placeCentered();return true}else{return false}};quickEdit.prototype.hide=function(){if(!this.placer){return false}this.placer.style.display="none";return true};quickEdit.prototype.__onLoad=function(g){var a=this.containerObj;var e='<span style="font-family: Tahoma, Helvetica, Sans-Serif; font-size: 11px; font-weight: bold; color: #000; text-align: left;">Что Вы хотите отредактировать?</span><br /><br />\r\n';var d,h=g.links.length;for(d=0;d<h;d++){var c=g.links[d][0];var k="/"+pre_lang+g.links[d][1];var b=g.links[d][2];var j="/"+pre_lang+g.links[d][3];e+='<span style="font-family: Tahoma, Helvetica, Sans-Serif; font-size: 11px; font-weight: bold; color: #000;">&#187; </span><a href="'+k+'" style="font-family: Tahoma, Helvetica, Sans-Serif; font-size: 11px; color: #138ECC; font-weight: bold; text-decoration: underline;">'+c+'</a> <a href="'+j+'" style="font-family: Tahoma, Helvetica, Sans-Serif; font-size: 11px; color: #138ECC; text-decoration: underline;">('+b+")</a></span><br />\r\n"}e+='<br /><span style="font-family: Tahoma, Helvetica, Sans-Serif; font-size: 11px; font-weight: bold; color: #000;">&#187; </span><a href="/'+pre_lang+'/admin/" style="font-family: Tahoma, Helvetica, Sans-Serif; font-size: 11px; color: #138ECC; font-weight: bold; text-decoration: underline;">Перейти в администрирование</a> </span><br />\r\n';var f=document.createElement("div");f.innerHTML=e;a.appendChild(f);this.is_loaded=true};quickEdit.getInstance();var Mozilla=(navigator.appName.indexOf("Netscape")!=-1);function qPanel(){var b=(typeof window.onload=="function")?window.onload:function(){};var a=this;window.onload=function(){b();a.init()}}qPanel.instance=null;qPanel.getInstance=function(){if(!qPanel.instance){qPanel.instance=new qPanel()}return qPanel.instance};qPanel.prototype.placer=null;qPanel.prototype.qedit=null;qPanel.prototype.user_info=null;qPanel.prototype.qmodules=null;qPanel.prototype.is_allowed=true;qPanel.prototype.is_loaded=false;qPanel.prototype.resize_img=null;qPanel.prototype.resize_ref=null;qPanel.prototype.controls=null;qPanel.prototype.minimized=false;qPanel.prototype.pre_lang="";qPanel.prototype.init=function(){this.placer=lLib.createVoidContainer();this.placer.id="umiQuickPanel";var b=this;var a=function(c){b.__onLoad(c);quickEdit.getInstance().__onLoad(c)};lLib.getInstance().makeRequest("/admin/content/json_get_editable_blocks/?",a)};qPanel.prototype.__onLoad=function(g){this.ticketsAllowed=g.ticketsAllowed;var k=this.user_info;this.draw();if(k){oUserName=document.createElement("a");oUserName.href=this.pre_lang+"/users/settings/";oUserName.title=g.user_groups;oUserName.style.fontWeight="normal";oUserName.style.color="#1A72BC";oUserName.style.fontFamily="Verdana, Helvetica, Arial, sans-serif";oUserName.style.fontSize="11px";oUserName.style.textDecoration="underline";oUserName.innerHTML+=g.user_login;k.appendChild(oUserName);this.show()}var c=this.qmodules;if(c){var l=new Option(qPanelLang.gotoModule,"#");c.options.add(l);var e,h=g.modules.length;for(e=0;e<h;e++){var d=g.modules[e][0];var a=g.modules[e][1];var j=new Option(d,"/"+pre_lang+a);c.options.add(j)}}var b=this.qedit;if(b){var f=new Option(qPanelLang.whatEdit,"#");b.options.add(f);var e,h=g.links.length;for(e=0;e<h;e++){var d=g.links[e][0];var a=g.links[e][1];var j=new Option(d,"/"+pre_lang+a);b.options.add(j)}}this.is_loaded=true;bMinimized=(getCookie("qpanel_minimized")==1);this.show(bMinimized)};qPanel.prototype.draw=function(){this.hide();var h=this.placer;h.style.styleFloat="right";h.style.cssFloat="right";h.style.backgroundColor="#F0F2F4";h.style.borderBottom="1px solid #ADADAD";h.style.borderLeft="5px solid #FE9807";h.style.position="absolute";h.style.display="none";h.style.overflow="visible";h.style.zIndex="200";h.style.color="#464646";h.style.fontFamily="Verdana, Helvetica, Arial, sans-serif";h.style.fontWeight="normal";h.style.fontSize="12px";h.style.textAlign="left";var z=document.createElement("div");z.style.marginLeft="7px";var A=document.createElement("div");h.appendChild(A);var n=document.createElement("img");n.src="/images/cms/qpanel_user.gif";n.style.border="0px";n.style.marginTop="2px";n.align="absmiddle";var u=z.appendChild(n);var m=document.createElement("span");m.style.marginLeft="10px";m.style.whiteSpace="nowrap";this.user_info=m;z.appendChild(m);var d=document.createElement("span");d.innerHTML="";d.style.marginLeft="5px";z.appendChild(d);var f=document.createElement("a");f.href="/"+pre_lang+"/users/logout/";f.style.color="#1A72BC";f.style.fontFamily="Verdana, Helvetica, Arial, sans-serif";f.style.fontSize="11px";f.style.fontWeight="normal";f.style.textDecoration="underline";f.style.marginLeft="4px";f.style.marginRight="4px";f.innerHTML=qPanelLang.quit;z.appendChild(f);var w=document.createElement("span");w.innerHTML="";z.appendChild(w);var q=document.createElement("img");q.src="/images/cms/qpanel_vline.gif";q.style.width="1px";q.style.height="14px";q.style.border="0px";q.style.marginLeft="10px";q.style.marginRight="10px";q.align="absmiddle";z.appendChild(q);var g=document.createElement("select");g.onchange=function(){window.location=this.options[this.selectedIndex].value;return true};g.style.padding="0px";g.style.margin="0px";g.style.color="#464646";g.style.fontFamily="Verdana, Helvetica, Arial, sans-serif";g.style.fontSize="11px";g.style.fontWeight="bold";g.style.border="1px solid #7F9DB9 ";g.style.width="160px";z.appendChild(g);this.qedit=g;var s=q.cloneNode(true);z.appendChild(s);var c=document.createElement("select");c.onchange=function(){window.location=this.options[this.selectedIndex].value;return true};c.style.padding="0px";c.style.margin="0px";c.style.color="#464646";c.style.fontFamily="Verdana, Helvetica, Arial, sans-serif";c.style.fontSize="11px";c.style.fontWeight="bold";c.style.border="1px solid #7F9DB9 ";c.style.width="135px";z.appendChild(c);this.qmodules=c;var r=q.cloneNode(true);z.appendChild(r);oAdminSpan=document.createElement("span");oAdminSpan.style.whiteSpace="nowrap";var p=n.cloneNode(true);p.src="/images/cms/qpanel_conf.gif";oAdminSpan.appendChild(p);var B=f.cloneNode(true);B.innerHTML=qPanelLang.administration;B.href="/"+pre_lang+"/admin/";oAdminSpan.appendChild(B);z.appendChild(oAdminSpan);var o=q.cloneNode(true);z.appendChild(o);var k=document.createElement("img");k.src="/images/cms/qpanel_referers.gif";k.style.border="0px";k.style.marginTop="2px";k.align="absmiddle";var u=z.appendChild(k);oAdminSpan=document.createElement("span");oAdminSpan.style.whiteSpace="nowrap";var B=f.cloneNode(true);B.innerHTML=qPanelLang.statictics;B.href="#";B.onclick=function(){floatReferers.getInstance().loadLinks();return false};oAdminSpan.appendChild(B);z.appendChild(oAdminSpan);umiTickets.getInstance().ticketsAllowed=this.ticketsAllowed;if(this.ticketsAllowed){var o=q.cloneNode(true);z.appendChild(o);var y=document.createElement("img");y.src="/images/cms/qpanel_ticket.gif";y.style.border="0px";y.style.marginTop="2px";y.align="absmiddle";var u=z.appendChild(y);oAdminSpan=document.createElement("span");oAdminSpan.style.whiteSpace="nowrap";var B=f.cloneNode(true);B.innerHTML=qPanelLang.createnew;B.href="#";B.onclick=function(){alert(qPanelLang.createnewalert);umiTickets.getInstance().beginCreatingTicket();return false};oAdminSpan.appendChild(B);z.appendChild(oAdminSpan)}if(typeof(editableRegions)!=="undefined"){var l=q.cloneNode(true);z.appendChild(l);var j=document.createElement("input");j.setAttribute("type","checkbox");j.setAttribute("id","umi_edtmode");if(Mozilla){j.style.position="relative";j.style.top="2px"}j.id="umi_edtmode";j.onclick=function(){if(this.checked){editableRegions.getInstance().highlight()}else{editableRegions.getInstance().unhighlight()}};z.appendChild(j);var a=document.createElement("label");a.setAttribute("for","umi_edtmode");a.htmlFor="umi_edtmode";a.innerHTML=qPanelLang.edit;a.style.fontFamily="Verdana, Helvetica, Arial, sans-serif";a.style.fontSize="11px";a.style.color="#1a72bc";a.style.fontWeight="bold";a.style.textDecoration="underline";a.style.marginLeft="4px";a.style.marginRight="4px";a.style.cursor="pointer";z.appendChild(a);if(editable){j.setAttribute("checked",true);j.checked=true;editableRegions.getInstance().highlight()}}var x=document.createElement("span");x.style.whiteSpace="nowrap";var v=n.cloneNode(true);v.src="/images/cms/qpanel_uarrow.gif";this.resize_img=v;x.appendChild(v);var b=f.cloneNode(true);b.innerHTML=qPanelLang.hide;this.resize_ref=b;b.href="#";var e=this;b.onclick=function(){e.show(!e.minimized);return false};x.appendChild(b);A.appendChild(x);A.style.styleFloat="right";A.style.cssFloat="right";this.controls=z;h.appendChild(z)};qPanel.prototype.show=function(d){if(!this.is_loaded){return false}this.hide();var d=(d?d:false);var b=this.placer;if(this.is_allowed){var e=this.resize_img;var a=this.resize_ref;var c=this.controls;b.style.top="0px";b.style.right="0px";if(e&&a&&c){if(d){b.style.left="";b.style.width="130px";b.style.paddingTop="0px";b.style.paddingBottom="0px";e.src="/images/cms/qpanel_darrow.gif";a.innerHTML=qPanelLang.uncollapse;c.style.display="none";setCookie("qpanel_minimized",1);this.minimized=true}else{b.style.width="";b.style.left="0px";b.style.paddingTop="7px";b.style.paddingBottom="7px";e.src="/images/cms/qpanel_uarrow.gif";a.innerHTML=qPanelLang.collapse;c.style.display="block";setCookie("qpanel_minimized",0);this.minimized=false}}this.placer.style.display="block";this.placer.style.overflow="visible";return true}else{return false}};qPanel.prototype.hide=function(){this.placer.style.display="none";this.placer.style.overflow="hidden";return true};qPanel.getInstance();var Mozilla=(navigator.appName.indexOf("Netscape")!=-1);var Mozilla=(navigator.appName.indexOf("Netscape")!=-1);function umiTicket(a,e,c,d,g,f,b,h,j){this.id=a;this.userId=e;this.userLogin=c;this.userFIO=d;this.x=parseInt(g);this.y=parseInt(f);this.width=parseInt(b);this.height=parseInt(h);this.message=j}umiTicket.prototype.id=null;umiTicket.prototype.userId=null;umiTicket.prototype.userLogin=null;umiTicket.prototype.userFIO=null;umiTicket.prototype.x=null;umiTicket.prototype.y=null;umiTicket.prototype.width=null;umiTicket.prototype.height=null;umiTicket.prototype.message=null;umiTicket.prototype.renderTicket=function(){var c=this.width-this.x;var a=this.height-this.y;var g=this.containerDiv=document.createElement("div");g.style.zIndex=new String(110+((this.id)?this.id:0));g.style.position="absolute";g.style.left=(-5+c+this.x)+"px";g.style.top=(-5+a+this.y)+"px";g.style.border="#000 1px solid";g.style.backgroundColor="#FFFFE1";g.style.padding="5px";g.style.color="#000";g.style.fontFamily="Verdana";g.style.fontSize="11px";g.style.fontWeight="normal";g.style.textDecoration="none";g.style.letterSpacing="-1px";g.style.margin="0px";g.style.width="auto";g.style.height="auto";g.style.textAlign="left";var f=(this.userFIO)?(this.userFIO+" ("+this.userLogin+")"):(this.userLogin);var d=document.createElement("div");d.style.color="#000";d.style.fontFamily="Verdana";d.style.fontSize="11px";d.style.fontWeight="bold";d.style.textDecoration="none";d.style.letterSpacing="-1px";d.style.margin="0px";d.style.marginBottom="5px";d.style.width="auto";d.style.height="auto";d.style.textAlign="left";d.appendChild(document.createTextNode(f));var j=this.messageDiv=document.createElement("div");j.innerHTML="<div style='font-family: Verdana; font-size: 11px; font-weight: normal; text-align: left; color: #000;'>"+this.message.replace(/\n/g,"<br />")+"</div>";var e=this.settingsDiv=document.createElement("div");e.style.width="150px";e.style.height="auto";e.style.margin="0px";e.style.marginTop="10px";e.style.textAlign="left";var b=this.editLink=document.createElement("a");b.style.color="#138ECC";b.style.fontFamily="Verdana";b.style.fontSize="11px";b.style.fontWeight="normal";b.style.textDecoration="underline";b.style.cursor="pointer";b.style.letterSpacing="-1px";b.style.margin="0px";b.style.marginLeft="0px";b.style.marginRight="5px";b.style.textAlign="left";b.appendChild(document.createTextNode("Редактировать"));var h=this.delLink=document.createElement("a");h.style.color="#138ECC";h.style.fontFamily="Verdana";h.style.fontSize="11px";h.style.fontWeight="normal";h.style.textDecoration="underline";h.style.cursor="pointer";h.style.letterSpacing="-1px";h.style.margin="0px";h.style.marginLeft="0px";h.style.marginRight="5px";h.style.textAlign="left";h.appendChild(document.createTextNode("Удалить заметку"));e.appendChild(h);g.appendChild(d);g.appendChild(j);g.appendChild(e);document.body.appendChild(g);var k=this.ghostDiv=document.createElement("div");k.style.width="1px";k.style.height="1px";k.style.border="red 1px dashed";k.style.position="absolute";k.style.left=this.x+"px";k.style.top=this.y+"px";k.style.width=c+"px";k.style.height=a+"px";k.style.backgroundColor="#DDD";k.style.zIndex=new String(110+((this.id)?this.id:0));this.setAlpha(k,30);document.body.appendChild(k);this.setAlpha(g,15);this.attachEvents()};umiTicket.prototype.attachEvents=function(){var a=this;this.editLink.onclick=this.messageDiv.onclick=function(){if(!a.txtMode){a.switchMode()}};this.delLink.onclick=function(){umiTickets.getInstance().removeTicket(a.id)};this.containerDiv.onmouseover=function(){a.setAlpha(this,100)};this.containerDiv.onmouseout=function(){if(!a.txtMode){a.setAlpha(this,15)}}};umiTicket.prototype.switchMode=function(){var d=this.messageDiv.firstChild;var b=d.offsetWidth,a=d.offsetHeight;d.parentNode.removeChild(d);var e=document.createElement("textarea");e.style.backgroundColor="#FFFFE1";e.style.padding="0px";e.style.color="#000";e.style.fontFamily="Verdana";e.style.fontSize="11px";e.style.fontWeight="normal";e.style.textDecoration="none";e.style.letterSpacing="-1px";e.style.margin="0px";e.style.width=b+"px";e.style.height=a+"px";e.style.border="0px";e.value=this.message;this.messageDiv.appendChild(e);e.focus();e.select();this.txtMode=true;this.setAlpha(this.containerDiv,100);var c=this;e.onblur=function(){c.txtMode=false;c.message=this.value;var g=c.containerDiv;g.parentNode.removeChild(g);var g=c.ghostDiv;g.parentNode.removeChild(g);c.renderTicket();var f=function(h){};lLib.getInstance().makeRequest("/content/json_update_ticket/?ticket_id="+c.id+"&message="+c.message.replace(/\n/g,"\\n"),f)}};umiTicket.prototype.setAlpha=function(b,a){if(Mozilla){b.style.MozOpacity=a/100}else{b.style.filter="alpha(opacity = "+a+")"}b.style.opacity=a/100};var Mozilla=(navigator.appName.indexOf("Netscape")!=-1);function umiTickets(){var b=(typeof window.onload=="function")?window.onload:function(){};var a=this;window.onload=function(){b();a.init()}}umiTickets.self=null;umiTickets.getInstance=function(){if(!umiTickets.self){umiTickets.self=new umiTickets()}return umiTickets.self};umiTickets.prototype.tickets=new Array();umiTickets.prototype.userId=null;umiTickets.prototype.userLogin=null;umiTickets.prototype.userFIO=null;umiTickets.prototype.is_loaded=false;umiTickets.prototype.ox=0;umiTickets.prototype.oy=0;umiTickets.prototype.tmpx=0;umiTickets.prototype.tmpy=0;umiTickets.prototype.ticketsAllowed=false;umiTickets.prototype.createTicket=function(b,d,c,a){if(!this.is_loaded){return false}this.addTicket(false,this.userId,this.userLogin,this.userFIO,b,d,c,a,new String("Новая заметка"))};umiTickets.prototype.addTicket=function(b,e,c,d,h,g,a,k,m){if(!b){b=0}var f=this.tickets[b]=new umiTicket(b,e,c,d,h,g,a,k,m);f.renderTicket();if(b==0){var j=this;var l=function(n){j.tickets[n.ticketId]=j.tickets[0];f.id=n.ticketId};lLib.getInstance().makeRequest("/content/json_add_ticket/?x="+h+"&y="+g+"&width="+a+"&height="+k+"&z=123",l)}};umiTickets.prototype.removeTicket=function(e,a){var d;if(d=this.tickets[e]){var c=d.containerDiv;if(c){c.parentNode.removeChild(c)}var c=d.ghostDiv;if(c){c.parentNode.removeChild(c)}this.tickets[e]=undefined;var b=function(f){};if(!a){lLib.getInstance().makeRequest("/content/json_del_ticket/?ticket_id="+e,b)}return true}else{return false}};umiTickets.prototype.init=function(){var b=this;var a=function(c){b.__onLoad(c)};lLib.getInstance().makeRequest("/content/json_get_tickets/?",a)};umiTickets.prototype.__onLoad=function(b){var d,a=b.tickets.length;this.userId=b.userId;this.userLogin=b.userLogin;this.userFIO=b.userFIO;for(d=0;d<a;d++){var c=b.tickets[d];this.addTicket(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8].replace(/\\n/g,"\n"))}this.is_loaded=true};umiTickets.prototype.handleTicket=function(b,d){this.ox=b;this.oy=d;this.moveHandler=document.onmousemove;this.mouseUpHandler=document.onmouseup;var a=this.ghostDiv=this.createGhost();var c=this;document.onmousemove=function(f){c.moveHandler(f);c.resizeGhost(lMouseX,lMouseY);c.resetAllSelections()};document.onmouseup=function(){c.createTicket(c.ox,c.oy,c.tmpx,c.tmpy);document.onmousemove=c.moveHandler;document.onmouseup=c.mouseUpHandler;a.parentNode.removeChild(a)}};umiTickets.prototype.createGhost=function(){var a=document.createElement("div");a.style.width="1px";a.style.height="1px";a.style.border="red 1px dashed";a.style.position="absolute";a.style.left=this.ox+"px";a.style.top=this.oy+"px";a.style.backgroundColor="#DDD";a.style.zIndex=new String("10010");if(Mozilla){a.style.MozOpacity="0.3"}else{a.style.filter="alpha(opacity = 30)"}document.body.appendChild(a);return a};umiTickets.prototype.resizeGhost=function(b,a){if(!this.ghostDiv){this.createGhost()}this.ghostDiv.style.width=b-this.ox+"px";this.ghostDiv.style.height=a-this.oy+"px";this.tmpx=b;this.tmpy=a};umiTickets.prototype.resetAllSelections=function(){try{document.selection.empty();window.getSelection().removeAllRanges()}catch(a){}};umiTickets.prototype.beginCreatingTicket=function(){if(!this.ticketsAllowed){return false}var a=(typeof document.onmousedown=="function")?document.onmousedown:function(){};document.onmousedown=function(c){var b=Event.pointerX(c);var d=Event.pointerY(c);if(true){if(document.documentElement&&document.documentElement.scrollTop&&document.documentElement.scrollLeft){d+=document.documentElement.scrollTop;b+=document.documentElement.scrollLeft}else{d+=document.body.scrollTop;b+=document.body.scrollLeft}}umiTickets.getInstance().handleTicket(b,d);document.onmousedown=a}};umiTickets.prototype.deleteAll=function(){var a;for(a in this.tickets){var b=a;this.removeTicket(b,true)}};umiTickets.getInstance();var Mozilla=(navigator.appName.indexOf("Netscape")!=-1);function floatReferers(){this.placer=lLib.createVoidContainer()}floatReferers.self=null;floatReferers.getInstance=function(){if(!floatReferers.self){floatReferers.self=new floatReferers()}return floatReferers.self};floatReferers.prototype.is_loaded=false;floatReferers.prototype.links=null;floatReferers.prototype.total=null;floatReferers.prototype.placer=null;floatReferers.prototype.loadLinks=function(){if(this.is_loaded){if(this.placer){this.placer.parentNode.removeChild(this.placer)}this.placer=lLib.createVoidContainer();this.is_loaded=false;return true}var b=this;var a=function(c){b.onLoadLinks(c)};lLib.getInstance().makeRequest("/stat/json_get_referer_pages/?",a)};floatReferers.prototype.onLoadLinks=function(a){this.is_loaded=true;this.links=a.links;this.total=a.total;this.renderLinks()};floatReferers.prototype.renderLinks=function(){var b=0;for(b=0;b<this.links.length;b++){var a=this.links[b];if(a.abs==0){continue}a.rel=Math.round((a.abs/this.total)*100);this.showAllRelatedLinks(a)}};floatReferers.prototype.showAllRelatedLinks=function(b){var a=document.getElementsByTagName("a");var c;var e="http://"+window.location.host;for(c=0;c<a.length;c++){var f=a.item(c);var h=f.href;h=h.replace(e,"");if(h!=b.uri){continue}var d=document.createElement("div");d.style.zIndex=1000;d.style.position="absolute";d.style.border="#000 1px solid";d.style.fontFamily="Verdana";d.style.fontSize="9px";d.style.color="#000";d.style.padding="2px";d.style.backgroundColor="#FFF";d.style.cursor="default";var g=lLib.getAbsoluteLocation(f);d.style.left=g.x+parseInt(f.offsetWidth)-(parseInt(f.offsetHeight))+"px";d.style.top=g.y+parseInt(f.offsetHeight)/2+"px";if(Mozilla){d.style.setProperty("-moz-opacity","0.6","")}else{d.style.filter="alpha(opacity = 60)"}d.innerHTML=b.rel+"% ("+b.abs+")";this.placer.appendChild(d)}};function t(){floatReferers.getInstance().loadLinks()};


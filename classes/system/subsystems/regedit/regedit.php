<?php
class regedit extends singleton implements iRegedit {protected $cacheFilePath, $cache = Array(), $cacheSaved = false;public static function getInstance() {return parent::getInstance(__CLASS__);}public function getKey($vd6fe1d0be6347b8ef2427fa629c04485, $v5809e03a3657bacd238321e736b9e85d = 0) {static $v0fea6a13c52b4d4725368f24b045ca84 = array();$vd6fe1d0be6347b8ef2427fa629c04485 = trim($vd6fe1d0be6347b8ef2427fa629c04485, "/");if(isset($this->cache['keys'][$vd6fe1d0be6347b8ef2427fa629c04485])) {return $this->cache['keys'][$vd6fe1d0be6347b8ef2427fa629c04485];}$vbb90bf734107ea3b2f4c14a5d4bc4f91 = 0;$ve030113b0d5493f188b4b49370f633b3 = array();foreach(split("\/", $vd6fe1d0be6347b8ef2427fa629c04485) as $v3c6e0b8a9c15224a8228b9a98ca1531d) {$v3c6e0b8a9c15224a8228b9a98ca1531d = l_mysql_real_escape_string($v3c6e0b8a9c15224a8228b9a98ca1531d);$ve030113b0d5493f188b4b49370f633b3[] = $v3c6e0b8a9c15224a8228b9a98ca1531d;$vfab0f4eae0e259eb1421e3cc7acca9b1 = implode('/', $ve030113b0d5493f188b4b49370f633b3);if(isset($v0fea6a13c52b4d4725368f24b045ca84[$vfab0f4eae0e259eb1421e3cc7acca9b1])) {$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $v0fea6a13c52b4d4725368f24b045ca84[$vfab0f4eae0e259eb1421e3cc7acca9b1];continue;}$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id FROM cms_reg WHERE rel = '$vbb90bf734107ea3b2f4c14a5d4bc4f91' AND var = '{$v3c6e0b8a9c15224a8228b9a98ca1531d}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);if(mysql_num_rows($result)) {list($vbb90bf734107ea3b2f4c14a5d4bc4f91) = mysql_fetch_row($result);$v0fea6a13c52b4d4725368f24b045ca84[$vfab0f4eae0e259eb1421e3cc7acca9b1] = $vbb90bf734107ea3b2f4c14a5d4bc4f91;}else {return $this->cache['keys'][$vd6fe1d0be6347b8ef2427fa629c04485] = false;}}return $this->cache['keys'][$vd6fe1d0be6347b8ef2427fa629c04485] = (int) $vbb90bf734107ea3b2f4c14a5d4bc4f91;}public function getVal($vd6fe1d0be6347b8ef2427fa629c04485) {$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->getKey($vd6fe1d0be6347b8ef2427fa629c04485);if(isset($this->cache['values'][$vd6fe1d0be6347b8ef2427fa629c04485])) {return $this->cache['values'][$vd6fe1d0be6347b8ef2427fa629c04485];}if($vbb90bf734107ea3b2f4c14a5d4bc4f91) {if(isset($this->cache['values'][$vbb90bf734107ea3b2f4c14a5d4bc4f91])) {return $this->cache['values'][$vbb90bf734107ea3b2f4c14a5d4bc4f91];}$this->cacheSaved = false;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT val FROM cms_reg WHERE id = '{$vbb90bf734107ea3b2f4c14a5d4bc4f91}'";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);list($v2063c1608d6e0baf80249c42e2be5804) = mysql_fetch_row($result);return $this->cache['values'][$vbb90bf734107ea3b2f4c14a5d4bc4f91] = $v2063c1608d6e0baf80249c42e2be5804;}else {return $this->cache['values'][$vd6fe1d0be6347b8ef2427fa629c04485] = false;}}public function setVar($vd6fe1d0be6347b8ef2427fa629c04485, $v2063c1608d6e0baf80249c42e2be5804) {return $this->setVal($vd6fe1d0be6347b8ef2427fa629c04485, $v2063c1608d6e0baf80249c42e2be5804);}public function setVal($vd6fe1d0be6347b8ef2427fa629c04485, $v2063c1608d6e0baf80249c42e2be5804) {$this->resetCache();$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->getKey($vd6fe1d0be6347b8ef2427fa629c04485);if($vbb90bf734107ea3b2f4c14a5d4bc4f91 == false) {$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->createKey($vd6fe1d0be6347b8ef2427fa629c04485);}$v2063c1608d6e0baf80249c42e2be5804 = l_mysql_real_escape_string($v2063c1608d6e0baf80249c42e2be5804);$vac5c74b64b4b8352ef2f181affb5ac2a = "UPDATE cms_reg SET val = '{$v2063c1608d6e0baf80249c42e2be5804}' WHERE id = '{$vbb90bf734107ea3b2f4c14a5d4bc4f91}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a);$this->resetCache();}public function delVar($vd6fe1d0be6347b8ef2427fa629c04485) {$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->getKey($vd6fe1d0be6347b8ef2427fa629c04485);if($vbb90bf734107ea3b2f4c14a5d4bc4f91) {$vac5c74b64b4b8352ef2f181affb5ac2a = "DELETE FROM cms_reg WHERE rel = '{$vbb90bf734107ea3b2f4c14a5d4bc4f91}' OR id = '{$vbb90bf734107ea3b2f4c14a5d4bc4f91}'";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);$this->resetCache();return true;}else {return false;}}public function getList($vd6fe1d0be6347b8ef2427fa629c04485) {if(isset($this->cache['lists'][$vd6fe1d0be6347b8ef2427fa629c04485])) {return $this->cache['lists'][$vd6fe1d0be6347b8ef2427fa629c04485];}$vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->getKey($vd6fe1d0be6347b8ef2427fa629c04485);if($vd6fe1d0be6347b8ef2427fa629c04485 == "//") {$vbb90bf734107ea3b2f4c14a5d4bc4f91 = 0;}if($vbb90bf734107ea3b2f4c14a5d4bc4f91 || $vd6fe1d0be6347b8ef2427fa629c04485 == "//") {if(isset($this->cache['lists'][$vbb90bf734107ea3b2f4c14a5d4bc4f91])) {return $this->cache['lists'][$vbb90bf734107ea3b2f4c14a5d4bc4f91];}$this->cacheSaved = false;$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT id, var, val FROM cms_reg WHERE rel = '{$vbb90bf734107ea3b2f4c14a5d4bc4f91}' ORDER BY id ASC";$result = l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);$vf09cc7ee3a9a93273f4b80601cafb00c = Array();while(list($vb80bb7740288fda1f201890375a60c8f, $vb2145aac704ce76dbe1ac7adac535b23, $v3a6d0284e743dc4a9b86f97d6dd1a3bf) = mysql_fetch_array($result)) {$vf09cc7ee3a9a93273f4b80601cafb00c[] = Array($vb2145aac704ce76dbe1ac7adac535b23, $v3a6d0284e743dc4a9b86f97d6dd1a3bf);}return $this->cache['lists'][$vbb90bf734107ea3b2f4c14a5d4bc4f91] = $vf09cc7ee3a9a93273f4b80601cafb00c;}else {return $this->cache['lists'][$vd6fe1d0be6347b8ef2427fa629c04485] = false;}}final public static function checkSomething($v0cc175b9c0f1b6a831c399e269772661, $v92eb5ffee6ae2fec3ad71c777531578f) {$vd06146603244a6f9c3a69f88c7e4ac2e = 3600*24*45;if(($_SERVER['HTTP_HOST'] == 'localhost' || $_SERVER['HTTP_HOST'] == 'subdomain.localhost') && $_SERVER['SERVER_ADDR'] == '127.0.0.1') {return true;}if(substr($_SERVER['HTTP_HOST'], strlen($_SERVER['HTTP_HOST']) - 4, 4) == "cvs5") {return true;}foreach($v92eb5ffee6ae2fec3ad71c777531578f as $v0f4153145310ca3a80263d772ccd01d4 => $v0a3d72134fb3d6c024db4c510bc1605b) {$vf1825f6bb156dc954f46bde74ca2f841 = (bool) (substr($v0cc175b9c0f1b6a831c399e269772661, 12, strlen($v0cc175b9c0f1b6a831c399e269772661) - 12) == $v0a3d72134fb3d6c024db4c510bc1605b);if($vf1825f6bb156dc954f46bde74ca2f841 === true) {define("CURRENT_VERSION_LINE", $v0f4153145310ca3a80263d772ccd01d4);if($v0f4153145310ca3a80263d772ccd01d4 == "trial") {$vb16a626598674ad426e4b885017906d7 = filectime(__FILE__);$v95f1cf7766ccd7c57cede3b85f3a5685 = time();if(file_exists(SYS_CACHE_RUNTIME . "trash")) {unlink(SYS_CACHE_RUNTIME . "trash");}if(($v95f1cf7766ccd7c57cede3b85f3a5685 - $vb16a626598674ad426e4b885017906d7) > $vd06146603244a6f9c3a69f88c7e4ac2e){include CURRENT_WORKING_DIR . "/errors/trial_expired.html";exit();}}return true;}}}public function getDaysLeft() {return 45 - floor((time() - filectime(__FILE__)) / 3600*24);}protected function __construct() {$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();$this->cacheFilePath = $v2245023265ae4cf87d02c8b6ba991139->includeParam('system.runtime-cache') . 'registry';$this->loadCache();}public function __destruct() {if(!$this->cacheSaved) {$this->saveCache();}}protected function loadCache() {$vb99eb979e6f6efabc396f777b503f7e7 = cacheFrontend::getInstance();if($vb99eb979e6f6efabc396f777b503f7e7->getIsConnected()) {if($v0fea6a13c52b4d4725368f24b045ca84 = $vb99eb979e6f6efabc396f777b503f7e7->loadSql("registry")) {$this->cache = unserialize($v0fea6a13c52b4d4725368f24b045ca84);$this->cacheSaved = true;return;}}if(file_exists($this->cacheFilePath)) {$v0fea6a13c52b4d4725368f24b045ca84 = unserialize(file_get_contents($this->cacheFilePath));if(is_array($v0fea6a13c52b4d4725368f24b045ca84)) {$this->cacheSaved = true;$this->cache = $v0fea6a13c52b4d4725368f24b045ca84;}}}protected function saveCache() {if(is_array($this->cache)) {if(is_dir(dirname($this->cacheFilePath))) {file_put_contents($this->cacheFilePath, serialize($this->cache));}if(cacheFrontend::getInstance()->getIsConnected()) {cacheFrontend::getInstance()->saveSql("registry", serialize($this->cache));}}$this->cacheSaved = true;}protected function createKey($vd6fe1d0be6347b8ef2427fa629c04485) {$vd6fe1d0be6347b8ef2427fa629c04485 = trim($vd6fe1d0be6347b8ef2427fa629c04485, "/");$vf961aedab905271a350c4e6eb6d7b6b9 = "//";$va722790b49e8eb1f37a1c672326ec501 = 0;foreach(split("\/", $vd6fe1d0be6347b8ef2427fa629c04485) as $v3c6e0b8a9c15224a8228b9a98ca1531d) {$vf961aedab905271a350c4e6eb6d7b6b9 .= $v3c6e0b8a9c15224a8228b9a98ca1531d . "/";if($vbb90bf734107ea3b2f4c14a5d4bc4f91 = $this->getKey($vf961aedab905271a350c4e6eb6d7b6b9)) {$va722790b49e8eb1f37a1c672326ec501 = $vbb90bf734107ea3b2f4c14a5d4bc4f91;}else {$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO cms_reg (rel, var, val) VALUES ('$va722790b49e8eb1f37a1c672326ec501', '{$v3c6e0b8a9c15224a8228b9a98ca1531d}', '')";l_mysql_query($vac5c74b64b4b8352ef2f181affb5ac2a, true);$va722790b49e8eb1f37a1c672326ec501 = $vbb90bf734107ea3b2f4c14a5d4bc4f91 = (int) mysql_insert_id();}}return $vbb90bf734107ea3b2f4c14a5d4bc4f91;}protected function resetCache($v14f802e1fba977727845e8872c1743a7 = false) {if(is_array($v14f802e1fba977727845e8872c1743a7)) {foreach($v14f802e1fba977727845e8872c1743a7 as $v3c6e0b8a9c15224a8228b9a98ca1531d) {if(isset($this->cache[$v3c6e0b8a9c15224a8228b9a98ca1531d])) {unset($this->cache[$v3c6e0b8a9c15224a8228b9a98ca1531d]);}}}else {$this->cache = Array();}$this->saveCache();}};?>
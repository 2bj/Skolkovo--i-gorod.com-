<?php
  abstract class __forum extends baseModuleAdmin {public function lists() {$this->setDataType("list");$this->setActionType("view");if($this->ifNotXmlMode()) return $this->doData();$vaa9f73eea60a006820d0f8768bc8a3fc = 20;$ve1ba980ce14a8c0d7e2779f895ab8695 = getRequest('p');$v7a86c157ee9713c34fbd7a1ee40f0c5a = $ve1ba980ce14a8c0d7e2779f895ab8695 * $vaa9f73eea60a006820d0f8768bc8a3fc;$v8be74552df93e31bbdd6b36ed74bdb6a = new selector('pages');$v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('forum', 'conf');$v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('forum', 'topic');$v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('forum', 'message');$v8be74552df93e31bbdd6b36ed74bdb6a->limit($v7a86c157ee9713c34fbd7a1ee40f0c5a, $vaa9f73eea60a006820d0f8768bc8a3fc);selectorHelper::detectFilters($v8be74552df93e31bbdd6b36ed74bdb6a);$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v8be74552df93e31bbdd6b36ed74bdb6a->result, "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc, $v8be74552df93e31bbdd6b36ed74bdb6a->length);$this->setDataRangeByPerPage($vaa9f73eea60a006820d0f8768bc8a3fc, $ve1ba980ce14a8c0d7e2779f895ab8695);return $this->doData();}public function last_messages() {$this->setDataType("list");$this->setActionType("view");if($this->ifNotXmlMode()) return $this->doData();$vaa9f73eea60a006820d0f8768bc8a3fc = 20;$ve1ba980ce14a8c0d7e2779f895ab8695 = getRequest('p');$v7a86c157ee9713c34fbd7a1ee40f0c5a = $ve1ba980ce14a8c0d7e2779f895ab8695 * $vaa9f73eea60a006820d0f8768bc8a3fc;$v8be74552df93e31bbdd6b36ed74bdb6a = new selector('pages');$v8be74552df93e31bbdd6b36ed74bdb6a->types('hierarchy-type')->name('forum', 'message');$v8be74552df93e31bbdd6b36ed74bdb6a->order('publish_time')->desc();$v8be74552df93e31bbdd6b36ed74bdb6a->limit($v7a86c157ee9713c34fbd7a1ee40f0c5a, $vaa9f73eea60a006820d0f8768bc8a3fc);selectorHelper::detectFilters($v8be74552df93e31bbdd6b36ed74bdb6a);$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v8be74552df93e31bbdd6b36ed74bdb6a->result, "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc, $v8be74552df93e31bbdd6b36ed74bdb6a->length);$this->setDataRangeByPerPage($vaa9f73eea60a006820d0f8768bc8a3fc, $ve1ba980ce14a8c0d7e2779f895ab8695);return $this->doData();}public function add() {$vd0e45878043844ffc41aac437e86b602 = $this->expectElement("param0");$v599dcce2998a6b40b1e38e8c6006cb0a = (string) getRequest("param1");$v15d61712450a686a7f365adf4fef581f = (string) getRequest("param2");$this->setHeaderLabel("header-forum-add-" . $v599dcce2998a6b40b1e38e8c6006cb0a);$ve62e4d22f2d8630f6e44e2b7c3f70ddc = Array( "type" => $v599dcce2998a6b40b1e38e8c6006cb0a,      "parent" => $vd0e45878043844ffc41aac437e86b602,      'type-id' => getRequest('type-id'),      "allowed-element-types" => Array('conf', 'topic', 'message'));if ($v15d61712450a686a7f365adf4fef581f == "do") {$this->saveAddedElementData($ve62e4d22f2d8630f6e44e2b7c3f70ddc);$this->chooseRedirect();}return $this->makeAdminOutputForm("create", "page", $ve62e4d22f2d8630f6e44e2b7c3f70ddc);}public function edit() {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->expectElement("param0");$v15d61712450a686a7f365adf4fef581f = (string)getRequest('param1');$this->setHeaderLabel("header-forum-edit-" . $this->getObjectTypeMethod($v8e2dcfd7e7e24b1ca76c1193f645902b->getObject()));$ve62e4d22f2d8630f6e44e2b7c3f70ddc = Array(    "element" => $v8e2dcfd7e7e24b1ca76c1193f645902b,    "allowed-element-types" => Array('conf', 'topic', 'message')   );if ($v15d61712450a686a7f365adf4fef581f == "do") {$this->saveEditedElementData($ve62e4d22f2d8630f6e44e2b7c3f70ddc);$this->chooseRedirect();}return $this->makeAdminOutputForm("modify", "page", $ve62e4d22f2d8630f6e44e2b7c3f70ddc);}public function del() {$v6a7f245843454cf4f28ad7c5e2572aa2 = getRequest('element');if(!is_array($v6a7f245843454cf4f28ad7c5e2572aa2)) {$v6a7f245843454cf4f28ad7c5e2572aa2 = Array($v6a7f245843454cf4f28ad7c5e2572aa2);}$vb81ca7c0ccaa77e7aa91936ab0070695 = umiHierarchy::getInstance();foreach($v6a7f245843454cf4f28ad7c5e2572aa2 as $v7552cd149af7495ee7d8225974e50f80) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->expectElement($v7552cd149af7495ee7d8225974e50f80, false, true);$v72352a4d26581ef082a6d2243c5a6b88 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getRel();$va4f09cfeea7392a1f6df6a3de5c3bc9e = $vb81ca7c0ccaa77e7aa91936ab0070695->getElement($v72352a4d26581ef082a6d2243c5a6b88);if($va4f09cfeea7392a1f6df6a3de5c3bc9e instanceof umiHierarchyElement) {$vaba7f6dea81a00d871678f551fb80a84 = $va4f09cfeea7392a1f6df6a3de5c3bc9e->getMethod();if($vaba7f6dea81a00d871678f551fb80a84 == "conf") {$v27dddf1ee142872e55822f9330daa72a = $va4f09cfeea7392a1f6df6a3de5c3bc9e->getValue('topics_count');$v3df355943c99b5080b84d1a3df811769 = $va4f09cfeea7392a1f6df6a3de5c3bc9e->getValue('messages_count');$vd53b4c07b42a83218887ffe339ae74d2  = $v8e2dcfd7e7e24b1ca76c1193f645902b->getValue('messages_count');$va4f09cfeea7392a1f6df6a3de5c3bc9e->setValue('topics_count', $v27dddf1ee142872e55822f9330daa72a - 1);$va4f09cfeea7392a1f6df6a3de5c3bc9e->setValue('messages_count', $v3df355943c99b5080b84d1a3df811769 - $vd53b4c07b42a83218887ffe339ae74d2);$va4f09cfeea7392a1f6df6a3de5c3bc9e->commit();}if($vaba7f6dea81a00d871678f551fb80a84 == "topic") {$v3df355943c99b5080b84d1a3df811769 = $va4f09cfeea7392a1f6df6a3de5c3bc9e->getValue('messages_count');if($v3df355943c99b5080b84d1a3df811769 == 1) {$v21ffce5b8a6cc8cc6a41448dd69623c9 = Array(          "element" => $va4f09cfeea7392a1f6df6a3de5c3bc9e,          "allowed-element-types" => Array('conf', 'topic', 'message')         );$this->deleteElement($v21ffce5b8a6cc8cc6a41448dd69623c9);}}}$v21ffce5b8a6cc8cc6a41448dd69623c9 = Array(     "element" => $v8e2dcfd7e7e24b1ca76c1193f645902b,     "allowed-element-types" => Array('conf', 'topic', 'message')    );$this->deleteElement($v21ffce5b8a6cc8cc6a41448dd69623c9);}$this->setDataType("list");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v6a7f245843454cf4f28ad7c5e2572aa2, "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function activity() {$v6a7f245843454cf4f28ad7c5e2572aa2 = getRequest('element');if(!is_array($v6a7f245843454cf4f28ad7c5e2572aa2)) {$v6a7f245843454cf4f28ad7c5e2572aa2 = Array($v6a7f245843454cf4f28ad7c5e2572aa2);}$v4264c638e0098acb172519b0436db099 = getRequest('active');foreach($v6a7f245843454cf4f28ad7c5e2572aa2 as $v7552cd149af7495ee7d8225974e50f80) {$v8e2dcfd7e7e24b1ca76c1193f645902b = $this->expectElement($v7552cd149af7495ee7d8225974e50f80, false, true);$v21ffce5b8a6cc8cc6a41448dd69623c9 = Array(     "element" => $v8e2dcfd7e7e24b1ca76c1193f645902b,     "allowed-element-types" => Array('conf', 'topic', 'message'),     "activity" => $v4264c638e0098acb172519b0436db099    );$this->switchActivity($v21ffce5b8a6cc8cc6a41448dd69623c9);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();}$this->setDataType("list");$this->setActionType("view");$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v6a7f245843454cf4f28ad7c5e2572aa2, "pages");$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function config() {$vb1444fb0c07653567ad325aa25d4e37a = regedit::getInstance();$v21ffce5b8a6cc8cc6a41448dd69623c9 = Array(    'config' => Array(     'int:per_page' => NULL,     'boolean:need_moder' => NULL,     'boolean:allow_guest' => NULL,     'boolean:sort_by_last_message' => NULL    )   );$v54f7fcf46733385a196ee0bcfe1ab2fb = umiObjectTypesCollection::getInstance()->getBaseType('dispatches', "dispatch");if ($v54f7fcf46733385a196ee0bcfe1ab2fb) {$v21ffce5b8a6cc8cc6a41448dd69623c9['config']['weak_guide:dispatch_id'] = Array('type-id' => $v54f7fcf46733385a196ee0bcfe1ab2fb,'value' => NULL);}$v15d61712450a686a7f365adf4fef581f = (string) getRequest('param0');if($v15d61712450a686a7f365adf4fef581f == 'do') {$v21ffce5b8a6cc8cc6a41448dd69623c9 = $this->expectParams($v21ffce5b8a6cc8cc6a41448dd69623c9);$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/forum/per_page', $v21ffce5b8a6cc8cc6a41448dd69623c9['config']['int:per_page']);$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/forum/need_moder', $v21ffce5b8a6cc8cc6a41448dd69623c9['config']['boolean:need_moder']);$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/forum/allow_guest', $v21ffce5b8a6cc8cc6a41448dd69623c9['config']['boolean:allow_guest']);$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/forum/sort_by_last_message', $v21ffce5b8a6cc8cc6a41448dd69623c9['config']['boolean:sort_by_last_message']);if ($v54f7fcf46733385a196ee0bcfe1ab2fb) {$vb1444fb0c07653567ad325aa25d4e37a->setVar('//modules/forum/dispatch_id', $v21ffce5b8a6cc8cc6a41448dd69623c9['config']['weak_guide:dispatch_id']);}$this->chooseRedirect();}$v21ffce5b8a6cc8cc6a41448dd69623c9['config']['int:per_page'] = (int) $vb1444fb0c07653567ad325aa25d4e37a->getVal('//modules/forum/per_page');$v21ffce5b8a6cc8cc6a41448dd69623c9['config']['boolean:need_moder'] = (int) $vb1444fb0c07653567ad325aa25d4e37a->getVal('//modules/forum/need_moder');$v21ffce5b8a6cc8cc6a41448dd69623c9['config']['boolean:allow_guest'] = (int) $vb1444fb0c07653567ad325aa25d4e37a->getVal('//modules/forum/allow_guest');$v21ffce5b8a6cc8cc6a41448dd69623c9['config']['boolean:sort_by_last_message'] = (int) $vb1444fb0c07653567ad325aa25d4e37a->getVal('//modules/forum/sort_by_last_message');if ($v54f7fcf46733385a196ee0bcfe1ab2fb) {$v21ffce5b8a6cc8cc6a41448dd69623c9['config']['weak_guide:dispatch_id']['value'] = (int) $vb1444fb0c07653567ad325aa25d4e37a->getVal('//modules/forum/dispatch_id');}$this->setDataType('settings');$this->setActionType('modify');$v8d777f385d3dfec8815d20f7496026dc = $this->prepareData($v21ffce5b8a6cc8cc6a41448dd69623c9, 'settings');$this->setData($v8d777f385d3dfec8815d20f7496026dc);return $this->doData();}public function getDatasetConfiguration($veca07335a33c5aeb5e1bc7c98b4b9d80 = '') {$v89ab96b2cae2569ced36d70f6866f57d = ($veca07335a33c5aeb5e1bc7c98b4b9d80 == 'last_messages') ? 'last_messages' : 'lists';return array(     'methods' => array(      array('title'=>getLabel('smc-load'), 'forload'=>true,     'module'=>'forum', '#__name'=>$v89ab96b2cae2569ced36d70f6866f57d),      array('title'=>getLabel('smc-delete'),           'module'=>'forum', '#__name'=>'del', 'aliases' => 'tree_delete_element,delete,del'),      array('title'=>getLabel('smc-activity'),    'module'=>'forum', '#__name'=>'activity', 'aliases' => 'tree_set_activity,activity'),      array('title'=>getLabel('smc-copy'), 'module'=>'content', '#__name'=>'tree_copy_element'),      array('title'=>getLabel('smc-move'),       'module'=>'content', '#__name'=>'tree_move_element'),      array('title'=>getLabel('smc-change-template'),        'module'=>'content', '#__name'=>'change_template'),      array('title'=>getLabel('smc-change-lang'),       'module'=>'content', '#__name'=>'move_to_lang')),     'types' => array(      array('common' => 'true', 'id' => 'message')     ),     'stoplist' => array('title', 'h1', 'meta_keywords', 'meta_descriptions', 'menu_pic_ua', 'menu_pic_a', 'header_pic', 'more_params', 'robots_deny', 'is_unindexed', 'store_amounts', 'locktime', 'lockuser', 'rate_voters', 'rate_sum'),     'default' => 'publish_time[156px]|author_id[100px]'    );}};?>